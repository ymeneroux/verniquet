!function(e){function t(t){for(var o,s,a=t[0],c=t[1],u=t[2],d=0,p=[];d<a.length;d++)s=a[d],i[s]&&p.push(i[s][0]),i[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(l&&l(t);p.length;)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(o=!1)}o&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},i={6:0},r=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.swcJsonp=window.swcJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;r.push([309,0]),n()}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(41),i=window;t.swcWindow=i,i.swc=i.swc||i.SkypeWebControl||{},i.swc.shared=i.swc.shared||{},i.swc.scriptLoader=i.swc.scriptLoader||o.ScriptLoader,i.SKYPE=i.SKYPE||{},i.SkypeWebControl=i.swc,i.swc.vendors=i.swc.vendors||{};var r=i.swc;t.swc=r,t.SKYPE=i.SKYPE||{}},,function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(59),s=n(19),a=n(19),c=function(){function e(){}return Object.defineProperty(e,"ECS",{get:function(){return o({},{frameless:""},i.swc.EcsConfig)},set:function(e){i.swc.EcsConfig=e},enumerable:!0,configurable:!0}),e.getPlatformId=function(){return r.PlatformUtils.getPlatformId()},e.getPlatformName=function(){return r.PlatformUtils.getPlatformName()},e.getClientVersion=function(){if(e.CLIENT_VERSION!==e.DEFAULT_CLIENT_VERSION)return e.CLIENT_VERSION;for(var t=e.ECS.version.split("."),n=t.length,o=0;o<4-n;o++)t.splice(t.length-1,0,"0");return e.CLIENT_VERSION=e.getPlatformId()+"/"+t.join("."),e.CLIENT_VERSION},e.getVersion=function(){if(e.VERSION!==e.DEFAULT_VERSION)return e.VERSION;for(var t=e.ECS.version.split("."),n=t.length,o=0;o<4-n;o++)t.splice(t.length-1,0,"0");return e.VERSION=t.join("."),e.VERSION},e.getChatClientInfo=function(){if(this.CHAT_CLIENT_INFO)return this.CHAT_CLIENT_INFO;var t=i.swc.EcsHeaderConfig&&i.swc.EcsHeaderConfig.CountryCode?i.swc.EcsHeaderConfig.CountryCode:"NR";return this.CHAT_CLIENT_INFO="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country="+t+"; clientName=swc; clientVer="+e.getUiVersion(),this.CHAT_CLIENT_INFO},e.getUiVersion=function(){return this.UI_VERSION?this.UI_VERSION:(this.UI_VERSION=e.getClientVersion()+"//swc",this.UI_VERSION)},e.getClientInfo=function(){if(this.SYSTEM_INFO)return this.SYSTEM_INFO;var t=a.UNKNOWN_VERSION;try{t=window.navigator.platform}catch(e){}return this.SYSTEM_INFO=e.getUiVersion()+"os="+s.default.getOsName()+"; osVer="+s.default.getOsVersion()+"; proc="+t+"; deviceType="+s.default.getDeviceType()+"; browser="+s.default.getBrowserName()+"; browserVer="+s.default.getBrowserVersion(),this.SYSTEM_INFO},e.APPNAME="SWC",e.LOCALE="en-us",e.PES_LOCALE="en",e.ORIGIN="SkypeLWC",e.ORIGIN_CALLING="SkypeCalling",e.MSG_MAX_LENGTH=2e3,e.PLATFORM_ID=912,e.BUTTON_MARKER_CLASS=".skype-button",e.CHAT_MARKER_CLASS=".skype-chat",e.RECENTS_MARKER_CLASS=".skype-recents",e.CHAT_FRAME_MARKER_CLASS=".lwc-chat-frame",e.CALL_FRAME_MARKER_CLASS=".swc-call-frame",e.LOGIN_CLIENT_ID="919866",e.LOGIN_PAGE_URL="https://login.skype.com/login",e.LOGIN_THEME="skype-white",e.LOGOUT_PAGE_URL="https://login.skype.com/logout",e.LOGIN_POPUP_URL="https://demoplayground.skype.com/joinlwc?t=",e.LOGIN_POPUP_FEATURES="width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no",e.LOGOUT_POPUP_FEATURES="width=1, height=1, menubar=no, status=no, titlebar=no, toolbar=no",e.TEAMS_URL="https://api.teams.skype.com/",e.TEAMS_AUTH_URL="https://authsvc.teams.microsoft.com/v1.0",e.TEAMS_PROFILE_URL="https://teams.microsoft.com/",e.TEAMS_MIDDLE_TIER_URL="https://teams.microsoft.com/api/mt/amer",e.TEAMS_CSA_URL="https://chatsvcagg.teams.microsoft.com",e.SHAREPOINT_URL="https://microsoft-my.sharepoint.com/",e.AMS_HOST_URL="https://api.asm.skype.com/v1/",e.APS_HOST_URL="https://api.aps.skype.com/v1/",e.CDN_SERVICE_HOST="secure.skypeassets.com",e.OA_URL="https://pro.skype.com/v1/onboarding",e.OA_URL_INT="https://havana-latest.skype.com/v1/onboarding",e.URLP_SERVICE_URL="https://urlp.asm.skype.com",e.ECS_GRAPH_URL="https://skypegraph.skype.com/",e.MS_GRAPH_URL="https://graph.microsoft.com/v1.0/me/",e.MS_APP_CLIENT_ID="b8d5facb-2aee-4653-98cb-4acc8f0d0e97",e.MS_APP_REDIRECT_URL_DEMO="https://latest-swc.cdn.skype.com/demo/connect.html",e.MS_APP_REDIRECT_URL_OUTLOOK="https://latest-swc.cdn.skype.com/demo/msauth.html",e.MS_AUTHORIZE_URL="https://login.microsoftonline.com/common/oauth2/v2.0/authorize",e.ECS_GRAPH_ETAG=null,e.ECS_GRAPH_SERVICE_SETTINGS=null,e.INVITE_HOST_URL_INT="https://latest-join.skype.com/api/v1/",e.INVITE_HOST_URL="https://join.skype.com/api/v1/",e.CHAT_CLIENT_INFO="",e.CHAT_GUEST_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_JOIN_URL="https://latest-join.skype.com/api/v2/conversation",e.SKYPE_CALLER_ID="lwc",e.CONTACTS_HOST_URL="https://edge.skype.com/pcs-df/contacts/v2/",e.CONTACTS_SCD_HOST_URL="https://scd.skype.com/contacts/v3/",e.AGENTS_HOST_URL="https://join.skype.com/",e.AVATAR_SERVICE_URL="https://avatar.skype.com/v1/",e.STRATUS_DOMAIN_HOST_URL="https://profile.skype.com/profile/v1/",e.WX_HOST_URL="https://wx.skype.com/api/v1/scom/",e.USER_OPTIONS_SERVICE={OLD:"https://options.skype.com/",PROD:"https://edge.skype.com/",INT:"https://optionsservice-test-northeurope.cloudapp.net:443/"},e.ECS_CLIENT_NAME="skype",e.ECS_TEAM_NAME="lwc",e.ECS_CLIENT_VERSION="1.00",e.GET_HELP_URL="https://support.skype.com/en/faq/FA34704/what-is-skype-web-control",e.CONCIERGE_BOT_MRI="28:concierge",e.CONCIERGE_BOT_DF_MRI="28:concierge_df",e.BRB_BOT_MRI="28:a62068e3-63e9-4ffc-89a6-14d841e224d2",e.BRB_BOT_MRI_TEAMS="28:5932bde2-77dd-4eb7-a704-d1da88e37485",e.BRB_START_MESSAGE="Sending feedback details...",e.NEW_CHAT_COMPOSER_ID="newChatComposerId",e.DEFAULT_VERSION="0.0.0.0",e.DEFAULT_CLIENT_VERSION=e.getPlatformId()+"/"+e.DEFAULT_VERSION,e.CLIENT_VERSION=e.DEFAULT_CLIENT_VERSION,e.VERSION=e.DEFAULT_VERSION,e.DEFAULT_AVATAR_URI="https://swc.cdn.skype.com/assets/img/defaultAvatar.png",e.MSG_DELETED_CLASSIC_SKYPE="Edited previous message: ",e.UI_VERSION="",e.SYSTEM_INFO="",e.MESSAGE_PROPERTIES={GLOBAL:{ACTIVITY_DATA:"activityData",PINNED:"pinned",PROTOTYPE_SKYPEX:"prototype_skypex"},PER_USER:{EMOTIONS:"emotions",POLL:"poll",TRANSLATIONS:"translations",ACTIVITY_DATA:"activityData",SMS_REPORT:"smsdeliveryreports"}},e.CHAT_SERVICE_COMMANDS={SET_MESSAGE_PROPERTY:"setMessageProperty",REMOVE_MESSAGE_PROPERTY:"removeMessageProperty",REMOVE_ALL_MESSAGES:"removeAllMessage",SET_IS_FAVORITE:"setIsFavorite",SMS_PRICE:"getSmsPrice"},e}();t.Configuration=c},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.compatEvent="compatEvent",e.CreateControl="createControl",e.IncomingCall="incomingCall",e.CallingReady="callingReady",e.RecentsReady="recentsReady",e.InChatCallingReady="inChatCallingReady",e.BotAddedToThread="botAddedToThread",e.RecentDataLoaded="recentDataLoaded",e.StartChat="startChat",e.StartReportProblemChat="startReportProblemChat",e.StartCall="startCall",e.AcceptCall="acceptCall",e.RejectCall="rejectCall",e.UpdateCallingScreen="updateCallingScreen",e.ForceExpandChat="forceExpandChat",e.ToggleExpressionPicker="toggleExpressionPicker",e.HideExpressionPicker="hideExpressionPicker",e.PesConfigInitialized="pesConfigInitialized",e.Ready="ready",e.ChatOpen="chat-open",e.Click="click",e.Fullscreenchange="fullscreenchange",e.UpdateUnreadMessageCounter="updateUnreadMessageCounter",e.InappActivityStarted="inappActivityStarted",e.ClientOpened="clientOpened",e.ClientFocused="clientFocused",e.ChatServiceUnavailable="chatServiceUnavailable",e.RemoveAllMessagesFromUi="removeAllMessagesFromUi",e.RequestEditingMessage="requestEditingMessage",e.OnVisibilityChange="onVisibilityChange",e.OnMessageSent="onMessageSent",e.OnMessageReceived="onMessageReceived",e.onFocused="onFocused",e.OnConversationReady="onConversationReady",e.onControlShow="onControlShow",e.onControlHide="onControlHide",e.onControlClose="onControlClose",e.OnCallStart="onCallStart",e.OnCallConnect="onCallConnect",e.OnCallEnd="onCallEnd",e.CallingLayoutChanged="callingLayoutChanged",e.CallStatusChanged="callStatusChanged",e.DevicesPermissions="devicesPermissions",e.DominantSpeakerChanged="dominantSpeakerChanged",e.EndpointRegistered="endpointRegistered",e.RecentConversationsFetched="recentConversationsFetched",e.UnreadConversationsUpdate="unreadConversationsUpdate",e.UnsupportedFileSelected="unsupportedFileSelected",e.ReceivedNotification="receivedNotification",e.HideNotification="hideNotification",e.OpenRecentList="openRecentList",e.recentsShown="recentsShown",e.recentsHidden="recentsHidden",e.RecentItemSelected="onRecentItemSelected",e.recentsUIReady="recentsUIReady",e.recentItemsLoaded="recentItemsLoaded",e.onMessageExpand="onMessageExpand",e.onMessageCollapse="onMessageCollapse",e.OnConversationDelete="onConversationDelete",e.scrollToBottom="scrollToBottom",e.hideBubbleWindow="hideBubbleWindow",e.errorCode="errorCode",e.contactAdded="contactAdded",e.notificationSettingsChange="notificationSettingsChange",e.invoke={sendMessageToBotResponse:"invoke:sendMessageToBot:response",sendMessageToBot:"invoke:sendMessageToBot",signOut:"invoke:signOut",startCall:"invoke:startCall",stopCall:"invoke:stopCall",setAad:"invoke:setAad",getTokenExpirationTime:"invoke:getTokenExpirationTime",registerMask:"registerMask",unregisterMask:"unregisterMask"},e.cmd={reg:"cmd:register",unreg:"cmd:unregister",exec:"cmd:execute"},e.threadNotificationsProxy={reg:"proxy:threadNotifications:register",unreg:"proxy:threadNotifications:unregister",notify:"proxy:threadNotifications:notify"},e.messagingProxy={disconnect:"proxy:messaging:disconnect",disconnected:"proxy:messaging:disconnected"},e.recentsProxy={options:{request:"proxy:recents:options:request",resolve:"proxy:recents:options:resolve"}},e.conversationProxy={regIsTyping:"proxy:conversation:regIsTyping",resIsTyping:"proxy:conversation:resIsTyping",disableInput:"proxy:conversation:disableInput",expand:"proxy:conversation:expand",connected:"proxy:conversation:connected",focusInput:"proxy:conversation:focusInput",openFilePicker:"proxy:conversation:filepicker",setInputPlaceholder:"proxy:conversation:placeholder",setMessageProperties:"proxy:conversation:setMessageProperties",setInputText:"proxy:conversation:inputtext",toggleEmoticonPicker:"proxy:conversation:emoticonpicker",showConfirmationDialog:"proxy:conversation:showConfirmationDialog",resShowConfirmationDialog:"proxy:conversation:resShowConfirmationDialog",regMessageReceived:"proxy:conversation:regMessageReceived",messageReceived:"proxy:conversation:messageReceived",regUnreadCount:"proxy:conversation:regUnreadCount",unreadCount:"proxy:conversation:unreadCount",setActionBar:"proxy:conversation:setActionBar",resActionBar:"proxy:conversation:resActionBar",regDownload:"proxy:conversation:regDownload",resDownload:"proxy:conversation:resDownload",regAvatar:"proxy:conversation:regAvatar",resAvatar:"proxy:conversation:resAvatar",regTitle:"proxy:conversation:regTitle",resTitle:"proxy:conversation:resTitle",regPresenceStatus:"proxy:conversation:regPresenceStatus",resPresenceStatus:"proxy:conversation:resPresenceStatus",regCollapse:"proxy:conversation:regCollapse",resCollapse:"proxy:conversation:resCollapse",regClose:"proxy:conversation:regClose",resClose:"proxy:conversation:resClose"},e.applicationProxy={setLanguage:"proxy:application:setLanguage"},e.presenceProxy={setStatus:"proxy:presence:setStatus",setStatusResponse:"proxy:presence:setStatus:response",getStatus:"proxy:presence:getStatus",getStatusResponse:"proxy:presence:getStatus:response",getUserStatus:"proxy:presence:getUserStatus",getUserStatusResponse:"proxy:presence:getUserStatus:response",announceUserStatus:"proxy:presence:announceUserStatus",subscribeToUserStatus:"proxy:presence:subscribeToUserStatus",unsubscribeFromUserStatus:"proxy:presence:unsubscribeFromUserStatus",getStatusList:"proxy:presence:getStatusList",getStatusListResponse:"proxy:presence:getStatusList:response"},e.notificationsSettingsProxy={setOption:"proxy:settings:notification:setOption",setOptionResponse:"proxy:settings:notification:setOption:response",readOption:"proxy:settings:notification:readOption",readOptionResponse:"proxy:settings:notification:readOption:response"},e.proxy={resolve:"proxy:resolve",request:"proxy:request"},e.bridge={theme:{request:"bridge:request:theme",return:"bridge:request:return"}},e}();t.ApiEvents=o;var i=function(){function e(){}return e.SELECTED_PARTICIPANTS_CHANGE="selectedParticipants:change",e}();t.ParticipantEvents=i;var r=function(){function e(){}return e.SCROLL_RECOUNT="scroll:recount",e}();t.ScrollEvents=r;var s=function(){function e(){}return e.ITEM_SEND_REQUEST="pes:picker:sendRequest",e.ITEM_CANCEL_REQUEST="pes:picker:cancelRequest",e.OPEN_PICKER="pes:picker:open",e}();t.ExpressionPickerEvents=s;var a=function(){function e(){}return e.SEARCH_START="search:start",e.UPDATE_SEARCH_RESULTS="update:searchResults",e.TOGGLE_RESULTS_COMPONENT="search:toggleResultsComponent",e.SEARCH_CREATE_CONTACTLIST="create:contactlist",e.EMPTY_SEARCH_INPUT="search:emptyInput",e.FOCUS_SEARCH_INPUT="search:FocusInput",e.RESET_PARTICIPANTS_SEARCH_RESULT="search:resetParticipantsResult",e}();t.SearchEvents=a;var c=function(){function e(){}return e.SHOW="campaign:show",e.DISMISS="campaign:dismiss",e}();t.CampaignEvents=c,function(e){e.Ready="services:ready",e.Loaded="services:loaded",e.Init="services:init"}(t.ServicesEvents||(t.ServicesEvents={})),function(e){e.Ready="messaging:ready"}(t.MessagingEvents||(t.MessagingEvents={})),function(e){e.Add="viewport:add",e.Ready="viewport:ready",e.Remove="viewport:remove",e.Update="viewport:update"}(t.ViewportEvents||(t.ViewportEvents={}))},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=n(10),a=n(12),c=n(0),u=n(27),l=function(e){function t(){var t=e.call(this)||this;return t.sessionId="",t.backend=a.MessagingBackend.UNDETERMINED,t.style="",t.translatorEnabled=!1,t.frameless=!1,t.callingReady=!1,t.standaloneCalling=!1,t.largeEmoticonClass=!1,t.isParallelView=!1,t.parentProtocol="n/a",t.bridge(),t}return i(t,e),Object.defineProperty(t,"get",{get:function(){return c.swc.shared.app||(c.swc.shared.app=new t),c.swc.shared.app},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLocale",{get:function(){return u.LocaleInfo.instance.getLocale()},enumerable:!0,configurable:!0}),t.prototype.copy=function(e){e&&Object.getOwnPropertyNames(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);o&&o.writable&&(t[n]=o.value||t[n])})},t.prototype.isTeams=function(){return this.backend===a.MessagingBackend.TEAMS},Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme},set:function(e){e!==this._theme&&(this._theme=e,this.publish("theme",e))},enumerable:!0,configurable:!0}),t.prototype.bridge=function(){var e=this;c.swc.Eventing.registerEvent(r.ApiEvents.bridge.theme.return,function(t){return e.theme=t}),c.swc.Eventing.triggerEvent(r.ApiEvents.bridge.theme.request)},t}(s.default);t.default=l},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(35)),o(n(50)),o(n(51)),o(n(52)),o(n(53)),o(n(54))},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getComposedBlockClassName=function(){var e=this.blockClassName;return this.props.className&&(e+=" "+this.props.className),e},t}(n(3).Component);t.SwcBaseComponent=r},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s,a=n(1),c=n(7);!function(e){e.Small="swcIcon_size_small",e.Medium="swcIcon_size_medium",e.Large="swcIcon_size_large"}(t.SwcIconSize||(t.SwcIconSize={})),function(e){e.SVG="swcIcon_svg",e.CallEnd="swcIcon_callEnd",e.CallRecordDot="swcIcon_callRecordDot",e.CallRecordStroke="swcIcon_callRecordStroke",e.CallStart="swcIcon_callStart",e.Cancel="swcIcon_cancel",e.ChevronDown="swcIcon_chevronDown",e.Clippy="swcIcon_clippy",e.Contact="swcIcon_contact",e.ContactGroupPair="swcIcon_contactGroupPair",e.Contract="swcIcon_contract",e.EmoticonStroke="swcIcon_emoticonStroke",e.Error="swcIcon_error",e.Expand="swcIcon_expand",e.Favourite="swcIcon_favourite",e.File="swcIcon_file",e.IconSkypeForBusiness="swcIcon_iconSkypeForBusiness",e.Landline="swcIcon_landline",e.Left="swcIcon_left",e.LogoMicrosoft="swcIcon_logoMicrosoft",e.Message="swcIcon_message",e.Microphone="swcIcon_microphone",e.MicrophoneOff="swcIcon_microphoneOff",e.More="swcIcon_more",e.MsExcel="swcIcon_msExcel",e.MsOneNote="swcIcon_msOneNote",e.MsPowerPoint="swcIcon_msPowerPoint",e.MsVisio="swcIcon_msVisio",e.MsWord="swcIcon_msWord",e.NotificationOff="swcIcon_notificationOff",e.Ok="swcIcon_ok",e.Picture="swcIcon_picture",e.Pdf="swcIcon_pdf",e.Plus="swcIcon_plus",e.PresenceOnline="swcIcon_presenceOnline",e.PresenceAway="swcIcon_presenceAway",e.PresenceDnd="swcIcon_presenceDnd",e.PresenceBlocked="swcIcon_presenceBlocked",e.RadiobuttonUnselected="swcIcon_radiobuttonUnselected",e.Search="swcIcon_search",e.Send="swcIcon_send",e.Settings="swcIcon_settings",e.Skype="swcIcon_skype",e.StarFilled="swcIcon_starFilled",e.Video="swcIcon_video",e.VideoOff="swcIcon_videoOff"}(s=t.SwcIconType||(t.SwcIconType={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcIcon",t}return i(t,e),t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.size&&(t+=" "+this.props.size),this.props.type&&(t+=" "+this.props.type),t},t.prototype.render=function(){var e=this.props.type===s.SVG?{dangerouslySetInnerHTML:{__html:this.props.content}}:{};return a.createElement("span",r({"aria-hidden":"true",className:this.getComposedBlockClassName()},e))},t}(c.SwcBaseComponent);t.SwcIcon=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=function(){function e(){}return e.throwError=function(e,t,n,i){var r=new Error(function(){if(!n||0===Object.getOwnPropertyNames(n).length)return e+(t?": "+t:"");if("string"==typeof n)return n;var o="";return Object.getOwnPropertyNames(n).forEach(function(e){o+=e+": "+n[e]+";"}),o}());o.swc.Eventing.triggerEvent("errorCode",e);try{o.swc.Telemetry.sendEvent.runtimeError(e,r.message,e+(t?": "+t:""),r.stack,i)}catch(e){}},e.throwHttpErrorCode=function(e,t){e+=1e3,o.swc.Eventing.triggerEvent("errorCode",e)},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var e=this;this.callbacks={},this.subscribe=function(t,n){void 0===e.callbacks[t]&&(e.callbacks[t]=new Array),e.callbacks[t].push(n)},this.unsubscribe=function(t,n){if(void 0!==e.callbacks[t]){var o=e.callbacks[t].indexOf(n);o>-1&&e.callbacks[t].splice(o,1)}},this.publish=function(t,n){void 0!==e.callbacks[t]&&e.callbacks[t].map(function(e){return e}).forEach(function(e){e(n)})}}return e.prototype.dispose=function(){for(var e in this.callbacks)this.callbacks.hasOwnProperty(e)&&(this.callbacks[e]=null);this.callbacks={}},e}();t.default=o},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.SKYPE=100]="SKYPE",e[e.TEAMS=300]="TEAMS"}(t.MessagingBackend||(t.MessagingBackend={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),i=n(2),r=n(12),s=n(32),a=n(66),c=n(43),u={"<":"&lt;",">":"&gt;","&lt;":"<","&gt;":">","&LT;":"<","&GT;":">","&":"&amp;",'"':"&quot;","'":"&apos;","&amp;":"&","&quot;":'"',"&apos;":"'","&#39;":"'","&#96;":"`","&AMP;":"&","&QUOT;":'"',"&APOS;":"'"},l='(?:(?:\\s*title="[^"]+?"\\s*)|(?:\\s*tabindex="-1"\\s*)|(?:\\s*target="_blank"\\s*)){0,3}',d=a.default.multilineRegExp(["(&lt;a ",l,'href="((?:https?://|mailto:)[^"]+?)"',l,"&gt;)","((?:(?!&lt;/a&gt;)[\\s\\S])*)","(&lt;/a&gt;)"],"gi"),p={ALLOWED_TAGS:["span","canvas"],ALLOWED_ATTR:["id","type","data-item-id","class","data-is-animated"]},f={ALLOWED_TAGS:["b","i","s","hr","br","at","ss","h1","h2","h3","h4","h5","h6","span","div","quote","ul","li","ol","em","strong","br","canvas","p","title","description"],ALLOWED_ATTR:["tabindex","title","target","id","type","data-item-id","class","data-is-animated"]},h=function(){function e(){}return Object.defineProperty(e,"anchor",{get:function(){return e._anchor||(e._anchor=document.createElement("a"))},enumerable:!0,configurable:!0}),e.map=function(e){return u[e]},e.modifyLinkAnchorOpening=function(e,t){return e.search(a.default.escapeSpecialChars(t))>-1?e:e.replace(/(<a|&lt;a)/,function(e){return e+" "+t})},e.validateUrl=function(t,n){var o=e.anchor;return o&&e.validateUrlFormat(t)&&e.validateURLProtocol(o,n)},e.validateURLProtocol=function(e,t){return(t||["https:"]).indexOf(e.protocol)>-1&&-1===["javascript:"].indexOf(e.protocol)},e.validateUrlFormat=function(e){return!!e.match(/^(https:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)},e.escapeBrackets=function(e){return e.replace(/([<>])/gi,this.map)},e.unescapeBrackets=function(e){return e.replace(/(&lt;|&gt;)/gi,this.map)},e.unescape=function(e){return e.replace(/(&lt;|&gt;|&amp;|&quot;|&apos;|&#39;|&#96;)/gi,this.map)},e.validateUnescapedLink=function(e){return this.escapeBrackets(e).replace(d,this.validateAnchor)},e.parseTopic=function(t){return t?(t?e.unescape(t):"").replace(/<[^a\/].*?>(.*?)<\/[^a].*?>/gi,"$1").replace(/(<.*?\.{3,})$/,"").trim():t},e.getMessageSanitizedContent=function(e,t){var n={ALLOWED_TAGS:[],ALLOWED_ATTR:[]};return t&&t.noLinks?n=f:t&&t.noFormatting?n=p:(n={ALLOWED_TAGS:f.ALLOWED_TAGS.concat(["a"]),ALLOWED_ATTR:f.ALLOWED_ATTR.concat(["href"])},o.default.get.backend===r.MessagingBackend.TEAMS&&(n.ALLOWED_TAGS.push("img"),n.ALLOWED_ATTR.push("src","style","alt"))),s.default.dompurify.sanitize(e,n)},e.normalizeUrl=function(t){var n=e.anchor;return n.href=t,e.validateUrl(t)&&n.href},e.validateAnchor=function(t,n,o,i,r){var s=e.unescapeBrackets(n),a=e.unescapeBrackets(r);return 0!==o.indexOf("mailto:")&&(s=e.modifyLinkAnchorOpening(s,'target="_blank"')),s=e.modifyLinkAnchorOpening(s,'tabindex="-1"'),(s=e.modifyLinkAnchorOpening(s,'title="'+o+'"'))+i+a},e.webify=function(e){return e.replace(/(\r?\n)|(&lt;br\s?\/&gt;)/gm,"<br/>")},e.attachActionToLinks=function(e,t,n,o){if(1===e.nodeType&&e.matches(t))for(var i=e.querySelectorAll("a"),r=0;r<i.length;r++){var s=i[r];if(s.href.indexOf(n)>1){var a=c.default.getQueryParameter(s.href,n);a&&(s.setAttribute("data-swc-payload",a),s.addEventListener("click",o))}}},e.getSenderIdFromUrl=function(e){if(!e)return e;var t=e.match(/\/(\d+:[^?/]*)/);return t&&t[1]?t[1]:(e.match(/(\d+:[^?/]*)/),e)},e.extractMsgContent=function(e){return 0!==e.indexOf(i.Configuration.MSG_DELETED_CLASSIC_SKYPE)?e:e.slice(i.Configuration.MSG_DELETED_CLASSIC_SKYPE.length,e.length)},e.sanitizeTopic=function(e){return s.default.dompurify.sanitize(e,{ALLOWED_TAGS:f.ALLOWED_TAGS.concat(["img","a"]),ALLOWED_ATTR:f.ALLOWED_ATTR.concat(["src","href"])})},e.getMessagePreviewContent=function(t){return t=e._dropNewLineTag(t),t=e._dropAnchorTag(t),t=e._dropImgTag(t)},e._dropNewLineTag=function(e){return e.replace(/<br\s*\/?>/gm," ")},e._dropAnchorTag=function(e){return e.replace(/<\/*a.*?>/g," ")},e._dropImgTag=function(e){return e.replace(/<img .*?>/g,"")},e}();t.MessageUtils=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(30),i=n(0),r=n(37),s=n(42),a={allowedDomains:["swc.cdn.skype.com","latest-swc.cdn.skype.com"]},c=function(){function e(){}return e.combine=function(e,t){return e.lastIndexOf("/")!==e.length-1&&"/"!==t.substring(0,1)?e+"/"+t:this.getAppPath()+e+t},e.getAbsoluteUrl=function(e,t){var n=this.getCompletePath(e,t),r="css"===t?"css/":"";return e===o.PackageName.SDK_LOADER_CHAT?this.combine(i.swc.EcsConfig.loaderUrl,n):e===o.PackageName.CONNECT?this.combine(i.swc.EcsConfig.loaderUrl,n):this.combine(r,n)},e.getCompletePath=function(e,t){var n="";switch(i.swc.EcsConfig.environment){case"df":case"ppe":case"prod":n=".min"}return""+e+n+"."+t},e.setQueryParameters=function(e,t){return e+"?"+this.buildQueryParameters(t)},e.buildQueryParameters=function(e){var t=[];return Object.keys(e).forEach(function(n){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}),t.join("&")},e.getHost=function(){try{var e=window.location.hostname;return!e&&e.length>0?e:("file:"===window.location.protocol.toLowerCase()&&(e="local"),e)}catch(e){return null}},e.getVendorPath=function(){return e.getCDNPath()+"/vendors"},e.getConnectPagePath=function(){return e.getAppPath()+"connect.html"},e.getAppPath=function(){var t=r.getBranchParentFolder(i.swc.EcsConfig.version);return e.getCDNPath()+"/"+t+"/"+i.swc.EcsConfig.version+"/"},e.getCDNPath=function(){var t=i.swc.EcsConfig.domain;return e.validateUriOrDie(t,a),t},e.validateUriOrDie=function(e,t){if(!s.UrlValidator.instance.validate(e,t))throw new Error("Invalid URI!")},e.appendQueryParam=function(e,t,n){return e+(-1===e.indexOf("?")?"?":"&")+encodeURIComponent(t)+"="+encodeURIComponent(n)},e}();t.UrlHelper=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.guid={generate:function(){var e=new Uint16Array(8);(window.crypto||window.msCrypto).getRandomValues(e);var t=0,n=function(){return(4369|e[t++]).toString(16)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},isGuid:function(e){return/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/.test(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e){var t=this;this._isCanceled=!1,this._status=o.Pending,this.cancel=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isCanceled||(t._isCanceled=!0,e[0]=e[0]||{},e[0].isCanceled=!0,t._status=o.Rejected,t._reject.apply(t._promise,e))},this._promise=new Promise(function(n,i){t._resolve=n,t._reject=i,e&&(e.then(function(e){t._isCanceled||(t._status=o.Resolved,n(e))},function(e){t._status=o.Rejected,i(e)}),e.catch(function(e){t._status=o.Rejected,t._isCanceled?i({isCanceled:!0}):i(e)}))})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCanceled",{get:function(){return this._isCanceled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),e.prototype.resolve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._status!==o.Resolved&&(this._status=o.Resolved,this._resolve.apply(this._promise,e))},e.prototype.cancelQuitely=function(){this.status===o.Pending&&(this.promise.then(function(){},function(){}),this.cancel())},e}();t.CancelablePromise=i,function(e){e[e.Pending=0]="Pending",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(o=t.PromiseStatus||(t.PromiseStatus={}))},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(1),a=n(0),c=n(39),u=n(7),l=n(8);!function(e){e.Online="online",e.Busy="busy",e.Away="away"}(r=t.PresenceStatusUI||(t.PresenceStatusUI={})),function(e){e.SuperSmall="swcAvatar_size_superSmall",e.Small="swcAvatar_size_small",e.Medium="swcAvatar_size_medium",e.MediumLarge="swcAvatar_size_mediumLarge",e.Large="swcAvatar_size_large",e.SuperLarge="swcAvatar_size_superLarge"}(t.SwcAvatarSize||(t.SwcAvatarSize={}));var d=/teams.microsoft.com/,p=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="swcAvatar",n.state=t.avatarUrl?{bgColor:"transparent",showBlock:!!t.showBlock,presenceStatus:t.presenceStatus,initials:void 0}:{initials:t.title?c.getInitials(t.title):"",bgColor:t.title?c.getBackgroundColor(t.title):"transparent",showBlock:!!t.showBlock,presenceStatus:t.presenceStatus},n}return i(t,e),t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.size&&(t+=" "+this.props.size),t},t.prototype.componentDidUpdate=function(e){this.props.title!==e.title&&this.props.title&&this.setState({initials:c.getInitials(this.props.title),bgColor:c.getBackgroundColor(this.props.title)}),this.props.showBlock!==e.showBlock&&this.setState({showBlock:!!this.props.showBlock}),this.props.presenceStatus!==e.presenceStatus&&this.props.presenceStatus&&this.setState({presenceStatus:this.props.presenceStatus})},t.prototype.render=function(){var e,t=function(e,t){if(e)return l.SwcIconType.PresenceBlocked;switch(t){case r.Away:return l.SwcIconType.PresenceAway;case r.Busy:return l.SwcIconType.PresenceDnd;case r.Online:return l.SwcIconType.PresenceOnline;default:return null}}(this.state.showBlock,this.state.presenceStatus),n=this.props.avatarUrl&&"avatar NA"!==this.props.avatarUrl;return s.createElement("div",{className:this.getComposedBlockClassName(),"aria-label":a.swc.services.i18n.fetch("aria_avatar_label",{title:this.props.title}),style:{"background-color":n?"transparent":this.state.bgColor},onClick:this.props.onClick,"aria-hidden":!1===this.props.accessible?"true":void 0},n?(e=this.props.avatarUrl,d.test(e)?s.createElement("img",{crossOrigin:"use-credentials",src:e,className:"swcAvatar__img"}):s.createElement("img",{src:e,className:"swcAvatar__img"})):s.createElement("span",{className:"swcAvatar__initials","aria-hidden":"true"},this.state.initials),!!t&&s.createElement(l.SwcIcon,{className:"swcAvatar__presence",type:t}))},t}(u.SwcBaseComponent);t.SwcAvatar=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i,r,s=n(0),a=n(22),c=n(16),u={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"};!function(e){e.Desktop="Desktop",e.Mobile="Mobile",e.Tablet="Tablet"}(o=t.DeviceType||(t.DeviceType={})),function(e){e.MSIE="MSIE",e.CHROME="Chrome",e.FIREFOX="Firefox",e.SAFARI="Safari",e.EDGE="Edge",e.ELECTRON="Electron",e.SKYPE_SHELL="SkypeShell",e.PHANTOMJS="PhantomJS",e.UNKNOWN="Unknown"}(i=t.BrowserVendor||(t.BrowserVendor={})),function(e){e.WINDOWS="Windows",e.MACOSX="Mac OS X",e.WINDOWS_PHONE="Windows Phone",e.WINDOWS_RT="Windows RT",e.IOS="iOS",e.ANDROID="Android",e.LINUX="Linux",e.UNKNOWN="Unknown"}(r=t.OperatingSystem||(t.OperatingSystem={})),t.UNKNOWN_VERSION="U";var l=function(){function e(){}return e.getDeviceType=function(){return window.navigator.userAgent.match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?o.Mobile:window.navigator.userAgent.match(/tablet|ipad/i)?o.Tablet:o.Desktop},e.getUserAgent=function(){return a.default.getWindow().navigator.userAgent},e.userAgentContainsString=function(e){return this.getUserAgent().indexOf(e)>-1},e.isChrome=function(){return this.userAgentContainsString(i.CHROME)&&!this.userAgentContainsString(i.EDGE)},e.isIe=function(){return this.userAgentContainsString("Trident")},e.isEdge=function(){return this.userAgentContainsString(i.EDGE)},e.isOpera=function(){return this.userAgentContainsString("OPR/")},e.testSupporedList=function(t){if(!t)return!1;t.constructor!==Array&&"string"==typeof t&&(t=[t]);for(var n=e.getBrowserName().toLocaleLowerCase(),o=0;o<t.length;o++)if(t[o].toLowerCase().indexOf(n)>-1)return!0;return!1},e.getBrowserName=function(){return this.isOpera()?i.UNKNOWN:this.userAgentContainsString(i.PHANTOMJS)?i.PHANTOMJS:this.isEdge()?i.EDGE:this.userAgentContainsString(i.ELECTRON)?i.ELECTRON:this.userAgentContainsString(i.CHROME)?i.CHROME:this.userAgentContainsString(i.FIREFOX)?i.FIREFOX:this.userAgentContainsString(i.SAFARI)?i.SAFARI:this.userAgentContainsString(i.SKYPE_SHELL)?i.SKYPE_SHELL:this.isIe()?i.MSIE:i.UNKNOWN},e.getBrowserVersion=function(){var e,n,o,r,s,a=this;return this.isIe()?(r=a.getUserAgent(),(s=r.match(new RegExp(i.MSIE+" ([\\d,.]+)")))?s[1]:(o=r.match(new RegExp("rv:([\\d,.]+)")))?o[1]:void 0):((e=this.getBrowserName())===i.SAFARI&&(e="Version"),(n=a.getUserAgent().match(new RegExp(e+"/([\\d,.]+)")))?n[1]:t.UNKNOWN_VERSION)},e.getScreenInfo=function(){var e=a.default.getWindow(),t=a.default.getWindow().navigator;return{width:a.default.getWindow().screen&&a.default.getWindow().screen.width||0,height:a.default.getWindow().screen&&a.default.getWindow().screen.height||0,pixelRatio:a.default.getWindow().devicePixelRatio||0,colorDepth:a.default.getWindow().screen&&a.default.getWindow().screen.colorDepth||0,isTouchEnabled:Object.prototype.hasOwnProperty.call(e,"ontouchstart")||t.MaxTouchPoints>0}},e.getOsName=function(){var e=this.getUserAgent();return e.match(/windows\sphone\s\d+\.\d+/i)?r.WINDOWS_PHONE:e.match(/ arm;/i)?r.WINDOWS_RT:e.match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?r.IOS:e.match(/android/i)?r.ANDROID:e.match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?r.LINUX:e.match(/(macintosh|mac os x)/i)?r.MACOSX:e.match(/(windows|win32)/i)?r.WINDOWS:r.UNKNOWN},e.getOsVersion=function(e){var n=this;void 0===e&&(e=!1);var o;return this.getOsName()===r.WINDOWS?function(e){var o=n.getUserAgent().match(new RegExp("Windows NT ([\\d,.]+)"));if(o){if(e)return o[1];if(u[o[1]])return u[o[1]]}return t.UNKNOWN_VERSION}(e):this.getOsName()===r.MACOSX&&(o=n.getUserAgent().match(new RegExp(r.MACOSX+" ([\\d,_,.]+)")))?o[1].replace(/_/g,"."):t.UNKNOWN_VERSION},e.getDeviceId=function(){var e=s.swc.services.localStorage,t=e.getItem("swc-deviceId");return t||(t=c.guid.generate(),e.setItem("swc-deviceId",t)),t},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NA="n/a"},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.getWindow=function(){return window},e.getDocument=function(){return window.document},e.getParentWithClass=function(e,t){for(;e&&!this.hasClass(e,t);)e=e.parentNode;return e},e.isInViewport=function(e,t){return t=t||this.getWindow(),e.bottom>0&&e.right>0&&e.top<t.innerHeight&&e.left<t.innerWidth},e.readDataset=function(e,t,n){return e.dataset?e.dataset[t]:e.getAttribute("data-"+n)},e.writeDataset=function(e,t,n,o){e.dataset?e.dataset[t]=o:e.setAttribute("data-"+n,o)},e.hasClass=function(e,t){if(e.classList)return e.classList.contains(t);for(var n=0,o=e.className?e.className.split(" "):[];n<o.length;n++){if(o[n]===t)return!0}return!1},e}();t.default=o},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n(0),r=n(9),s=n(61),a=n(117),c=500;t.default=function(e,t,n,o){return 0,new Promise(function(i,r){var s=function(a){u(e,t.timeout,n,o).then(function(e){e.callCount=a,i(e)}).catch(function(e){0===e.status&&a<t.retryCount?setTimeout(function(){s(a+1)},c):r(e)})};s(1)})};var u=function(t,n,c,u){var d=Date.now(),p=u?u.method:null,f=function(e){var n=Date.now()-d;return e.ok||(a.reportServiceFault(t,e,n),r.default.throwHttpErrorCode(e.status,e.statusText)),i.swc.Telemetry.sendEvent.serviceQos(t,c+"",n,e,p),Promise.resolve(e)},h=function(e){var n=Date.now()-d;return a.reportServiceFault(t,e,n),i.swc.Telemetry.sendEvent.serviceQos(t,c+"",n,e,p),Promise.reject(e)};return s.get().onceOnline().then(function(){var t=e(c,u),i=new o.CancelablePromise(t);return l(i,n).then(f,h)},function(e){return Promise.reject(e)})},l=function(e,t){var n=setTimeout(function(){n=null,e.cancel({ok:!1,status:0,statusText:"Timeout"})},t),o=function(){n&&clearTimeout(n)};return e.promise.then(o,o),e.promise}}).call(this,n(70))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SignedOut=0]="SignedOut",e[e.SigningIn=1]="SigningIn",e[e.SignedIn=2]="SignedIn",e[e.SigningOut=3]="SigningOut"}(t.SigninState||(t.SigninState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(18);t.SwcAvatar=o.SwcAvatar,t.SwcAvatarSize=o.SwcAvatarSize;var i=n(75);t.SwcRecentAvatar=i.SwcRecentAvatar;var r=n(33);t.SwcPersonAvatar=r.SwcPersonAvatar;var s=n(76);t.SwcConversationAvatar=s.SwcConversationAvatar},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),s=n(0),a=function(e){function t(){return e.call(this)||this}return i(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t)},enumerable:!0,configurable:!0}),t.prototype.getLocale=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=null),t?(this.locale=t,this._locale):e?(this.locale=e,this._locale):this._locale?this._locale:s.swc.SDK&&s.swc.SDK.locale?(this.locale=s.swc.SDK.locale,this._locale):document.documentElement.lang?document.documentElement.lang.toLowerCase():window.navigator.languages&&0!==window.navigator.languages.length?window.navigator.languages[0].toLowerCase():navigator.language.toLowerCase()},Object.defineProperty(t.prototype,"locale",{set:function(e){e&&this._locale!==e.toLowerCase()&&(this._locale=e.toLowerCase(),this.publish("locale",this._locale))},enumerable:!0,configurable:!0}),t}(r.default);t.LocaleInfo=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=n(0),r=n(74),s=function(){function e(){this.requests={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.async=function(e,t,n){var r=this;return this.requests[t]=this.requests[t]||new Promise(function(s,a){var c=n&&setTimeout(a,n),u=function(n){n&&n.refId&&n.refId===t&&(c&&clearTimeout(c),i.swc.Eventing.unregisterEvent(o.ApiEvents.proxy.resolve,u),s(r.create(e,n)))};i.swc.Eventing.registerEvent(o.ApiEvents.proxy.resolve,u)}),i.swc.Eventing.triggerEvent(o.ApiEvents.proxy.request,t),this.requests[t]},e.prototype.create=function(e,t){return new e(t)},e}();t.ProxyFactory=s;var a=function(){return function(e){var t=this;this.data={},this.callCount=0,this.exec=function(e,t){return i.swc.Eventing.triggerEvent(e,t)},this.reg=function(e,t){return i.swc.Eventing.registerEvent(e,t)},this.unreg=function(e,t){return i.swc.Eventing.unregisterEvent(e,t)},this.createCID=function(){return r.hashCode((t.callCount++).toString()+t.refId)},this.refId=e.refId,this.data=e,this.init()}}();t.Proxy=a;var c=function(){function e(){var e=this;this.connections={},this.answer=function(t){var n=e.connections[t];n&&i.swc.Eventing.triggerEvent(o.ApiEvents.proxy.resolve,Object.assign(n,{refId:t}))},i.swc.Eventing.registerEvent(o.ApiEvents.proxy.request,this.answer)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t,n){this.connections[e]||(this.connections[e]=t||{},n&&n(),this.answer(e))},e.prototype.disconnect=function(e){delete this.connections[e]},e}();t.ProxyConnector=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.GUEST=100]="GUEST",e[e.SKYPE=200]="SKYPE",e[e.DL_TOKEN=300]="DL_TOKEN",e[e.TEAMS=400]="TEAMS"}(t.IdentityType||(t.IdentityType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.SDK_LOADER_CHAT="sdk-loader",e.SDK_CORE="sdk-core",e.ASSETS="assets-bundle",e.BUILDER="builder-bundle",e.BUILDER_CORE="builder-core",e.CALLING="calling-bundle",e.CALLING_STANDALONE="callingStandalone-bundle",e.SERVICES="services-bundle",e.CHAT_BUNDLE="chat-bundle",e.RECENTS_BUNDLE="recents-bundle",e.UICOMPONENT_BUNDLE="uicomponent-bundle",e.TELEMETRY_BUNDLE="telemetry-bundle",e.CONNECT="connect",e.HOST_CHAT_PAGE="host-chat",e.HOST_BING_PAGE="host-button",e.HOST_BUILDER_PAGE="host-builder",e.STYLE_BUILDER="swc-builder",e.STYLE_SDK="swc-sdk",e.STYLE_CHAT_SKYPE="swc-chat",e.STYLE_RECENTS_SKYPE="swc-recents",e.STYLE_CHAT_BING="swc-bing",e.STYLE_CHAT_THEME_DARK="swc-dark",e.STYLE_CALLING="swc-calling",e}();t.PackageName=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(34),i=n(6),r=n(9),s=function(){function e(){}return e.strip=function(e){var t=e.match(this.idRegExp);return t?t[2]:e},e.detectConversationType=function(e){if(!e)return i.ConversationType.UNDEFINED;if(this.typeMapppings[e])return this.typeMapppings[e];var t,n=e.match(this.idRegExp);if(n&&(t=this.getTypeByPrefix(n[1])),t)return this.typeMapppings[e]=t,t;if(0===e.indexOf("https://join.skype.com/"))return this.typeMapppings[e]=i.ConversationType.JOIN,i.ConversationType.JOIN;if(/^(28:)?[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.test(e))return this.typeMapppings[e]=i.ConversationType.AGENT,i.ConversationType.AGENT;if(/^(19:)?[\S]+[@]([\S].)?[\S]*thread\.skype/i.test(e))return this.typeMapppings[e]=i.ConversationType.GROUP,i.ConversationType.GROUP;return/(?:00|\+)?(^[^a-z][^A-Z])(\d+$)/i.test(e.replace(/\s+|[()\-\+]/gi,""))?(this.typeMapppings[e]=i.ConversationType.PHONE,i.ConversationType.PHONE):(this.typeMapppings[e]=i.ConversationType.PERSON,i.ConversationType.PERSON)},e.getSdkModeFromId=function(e){switch(this.detectConversationType(e)){case i.ConversationType.PERSON:return o.SDKMode.PERSON;case i.ConversationType.AGENT:return o.SDKMode.BOT;case i.ConversationType.JOIN:return o.SDKMode.JOIN_URL;case i.ConversationType.PHONE:return o.SDKMode.PHONE;case i.ConversationType.GROUP:return o.SDKMode.THREAD}return o.SDKMode.UNDEFINED},e.toFullIdentifier=function(e){var t=this.getPrefixForId(e);return 0===e.indexOf(t+":")?e:t?t+":"+e:e},e.addPrefix=function(e,t){return 0===t.indexOf(e+this.SPLITTER)?t:0===t.indexOf(this.SPLITTER)?e+t:e+this.SPLITTER+t},e.getNormalizeId=function(e){return e.match(this.idRegExp)?e.replace(/\d{1,2}:/,""):e},e.isEqual=function(e,t){return this.toFullIdentifier(e).toLowerCase()===this.toFullIdentifier(t).toLowerCase()},e.getPrefixForId=function(e){if(this.hasAlreadyPrefix(e))return"";var t=this.getSdkModeFromId(e);switch(t){case o.SDKMode.PERSON:return"8";case o.SDKMode.BOT:return"28";case o.SDKMode.THREAD:return"19";case o.SDKMode.PHONE:return"4";default:r.default.throwError(10502,"Unable to define conversation prefix",{id:e,sdkMode:t})}return""},e.getTypeByPrefix=function(e){if(!e)return i.ConversationType.UNDEFINED;switch(e.indexOf(":")>-1&&(e=e.replace(":","")),e){case"4":return i.ConversationType.PHONE;case"8":return i.ConversationType.PERSON;case"19":return i.ConversationType.GROUP;case"28":return i.ConversationType.AGENT;default:return i.ConversationType.UNDEFINED}},e.hasAlreadyPrefix=function(e){var t=/^\d+:/.exec(e);return!!t&&!!t[0]},e.SPLITTER=":",e.idRegExp=/(\d{1,2}:)([\S]*)/,e.typeMapppings={},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=function(){function e(){}return Object.defineProperty(e,"dompurify",{get:function(){return o.swcWindow.DOMPurify},enumerable:!0,configurable:!0}),e}();t.default=i},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),a=n(44),c=n(7),u=n(18),l=n(48),d=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="",n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n._onBlockedUpdate=function(e){n.setState({showBlock:e})},n._onPresenceUpdate=function(e){var t;switch(e){case a.PresenceStatus.Online:t=u.PresenceStatusUI.Online;break;case a.PresenceStatus.Busy:case a.PresenceStatus.OnThePhone:t=u.PresenceStatusUI.Busy;break;case a.PresenceStatus.Away:case a.PresenceStatus.Idle:case a.PresenceStatus.OutToLunch:case a.PresenceStatus.BeRightBack:t=u.PresenceStatusUI.Away}n.setState({presenceStatus:t})},n.state={title:"",size:t.size,avatarUrl:"",showBlock:!1,presenceStatus:null},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this.props.person;this._onTopicUpdate(e.displayName||e.id),e.subscribe("displayName",this._onTopicUpdate),this.props.isPstn||(this._onBlockedUpdate(e.isBlocked),e.subscribe("isBlocked",this._onBlockedUpdate),this.props.customAvatar?this._onAvatarUpdate(this.props.customAvatar):(e.avatarData&&this._onAvatarUpdate(e.avatarData),e.subscribe("avatarData",this._onAvatarUpdate)),this.props.showPresence&&(this._onPresenceUpdate(e.presenceStatus),e.subscribe("presenceStatus",this._onPresenceUpdate)))},t.prototype.componentWillReceiveProps=function(e){this.setState({size:e.size})},t.prototype.componentWillUnmount=function(){var e=this.props.person;e.unsubscribe("avatarData",this._onAvatarUpdate),e.unsubscribe("displayName",this._onTopicUpdate),e.unsubscribe("isBlocked",this._onBlockedUpdate),e.unsubscribe("presenceStatus",this._onPresenceUpdate)},t.prototype.render=function(){return this.props.isPstn?s.createElement(l.SwcPstnAvatar,r({className:this.getComposedBlockClassName()},this.state,{accessible:this.props.accessible})):s.createElement(u.SwcAvatar,r({className:this.getComposedBlockClassName()},this.state,{onClick:this.props.onClick,accessible:this.props.accessible}))},t}(c.SwcBaseComponent);t.SwcPersonAvatar=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.PERSON=1]="PERSON",e[e.THREAD=2]="THREAD",e[e.BOT=3]="BOT",e[e.JOIN_URL=4]="JOIN_URL",e[e.PHONE=5]="PHONE"}(t.SDKMode||(t.SDKMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Skype=8]="Skype",e[e.Agent=28]="Agent",e[e.Pstn=4]="Pstn",e[e.MSA=1]="MSA",e[e.Undefined=0]="Undefined"}(t.ContactType||(t.ContactType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.HideChatWindow="bs:hChat",e.OpenChatWindow="bs:oChat",e.ShowChatWindow="bs:sChat",e.CollapseChatWindow="bs:chat:collapse",e.ExpandChatWindow="bs:chat:expand",e.LoadChatData="bs:sChat:run",e.StartActivation="bs:sChat:startActivation",e.StopActivation="bs:sChat:stopActivation",e.UpdateConversation="swc:chat:update",e.MessageSent="lwc:mSent",e.DockIframe="bs:calling:iframe:dock",e.IframeDocked="bs:calling:iframe:docked",e.UndockIframe="bs:calling:iframe:undock",e.IframeUndocked="bs:calling:iframe:undocked",e.IframeDragging="bs:calling:iframe:drag:dragging",e.IframeDragStart="bs:calling:iframe:drag:start",e.IframeDragStop="bs:calling:iframe:drag:stop",e.TriggerAPI="bs:api:trigger",e.OpenRecentsWindow="swc:recents:open"}(t.ActionNames||(t.ActionNames={}))},function(e,t,n){"use strict";function o(e){return 0===e.indexOf("fb-")||0===e.indexOf("pr-")}Object.defineProperty(t,"__esModule",{value:!0}),t.isFeatureBranch=o,t.getBranchParentFolder=function(e){return o(e)?"fb":"v"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SKYPE_TOKEN_KEY="skype|token",t.SKYPE_REGTOKEN_KEY="skype|registrationtoken",t.SKYPE_ENDPOINT_ID_KEY="skype|epid",t.SKYPE_ENDPOINT_KEY="skype|endpoint",t.SKYPE_HAS_HISTORY_KEY="skype|hasHistory",t.SKYPE_GRAPH_ACCESS_TOKEN_KEY="skype|graphAccessToken",t.SKYPE_ENDPOINT_OWNER_KEY="skype|endpointowner",t.SWC_SFB_DISMISSED_KEY="swc-sfb-dismissed"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(40),i=n(14),r="returnDefaultImage=false",s="returnDefaultImage=true",a="?returnDefaultImage",c="?auth_key=",u=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(29, 29, 29)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)","rgb(238, 17, 17)"];t.loadAvatarUri=function(e,t,n){e&&(e.indexOf(c)<0&&(e=e.indexOf(a)<0?function(e){var t=e.split("?")[0],n=e.split("?")[1],o=function(e){return e.indexOf("/profile/avatar")>-1||e.indexOf("/public")>-1}(e);return n?(e=t+"?"+n,e+=o?"&"+r:""):e+=o?"?"+r:"",e}(e):e.replace(s,r)),o.default.preloadImage(e,t,n))},t.getBackgroundColor=function(e){for(var t=0,n=(e&&e.length||0)-1;n>=0;n--){var o=e.charCodeAt(n),i=n%8;t^=(o<<i)+(o>>8-i)}return u[t%u.length]},t.getInitials=function(e){var t="",n=(e=function(e){return i.MessageUtils.getMessageSanitizedContent(e).replace(/\s+/gi," ").trim()}(e)).split(" ");return n.length>1?(t+=n[0][0]?n[0][0]:"",t+=n[1][0]?n[1][0]:""):n.length&&(t+=n[0][0]?n[0][0]:"",t+=n[0][1]?n[0][1]:""),t.toUpperCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),i=n(0),r={caseFirst:"upper"},s=function(){function e(){}return e.mapSearchProfileInfo=function(e){return e&&e.results?e.results.map(function(e){var t=e.nodeProfileData.skypeId,n={skypeid:-1===t.indexOf("8:")?"8:"+t:t,name:e.nodeProfileData.name,avatar:e.nodeProfileData.avatarUrl,type:o.ContactType.Skype,contactType:e.nodeProfileData.contactType,annotation:e.nodeAnnotation,jobTitle:e.nodeProfileData.jobTitle,department:e.nodeProfileData.department,location:e.nodeProfileData.location};return e.nodeConnectionData&&(n.distance=e.nodeConnectionData.distance,n.mutualFriendCount=e.nodeConnectionData.mutualFriendCount),n}):[]},e.getWrappedIdWithMri=function(e){var t=/^\d+:/.exec(e.id);if(t&&t[0])return e.id;var n=e.isAgent?/^28:/:/^8:/;return(e.isAgent?"28:":"8:")+e.id.replace(n,"")},e.sortByName=function(e,t){var n=e.person.displayName.localeCompare(t.person.displayName,void 0,r);return 0===n?e.person.id.localeCompare(t.person.id):n},e.getSortedByRelevance=function(t){var n=t.filter(function(e){return e.rawPerson.mutualFriendCount}).sort(function(e,t){return t.rawPerson.mutualFriendCount-e.rawPerson.mutualFriendCount}),o=t.filter(function(e){return!e.rawPerson.mutualFriendCount}).sort(e.sortByName);return n.concat(o)},e.preloadImage=function(e,t,n){if(e.indexOf("data:image/jpeg;base64")>-1)t&&"function"==typeof t&&t(e);else{if(-1!==e.indexOf("https://teams.microsoft.com")){var o=i.swc.services.avatarService;if(o.getAvatarData&&t&&"function"==typeof t)return void o.getAvatarData(e).then(function(e){t(e)})}var r=new Image,s=encodeURI(decodeURI(e));r.onload=function(){t&&"function"==typeof t&&t(s)},r.onerror=function(e){n&&"function"==typeof n&&n()},r.src=s}},e.replaceAvatarPath=function(e){return e.indexOf("data:image/jpeg;base64")>-1?e:e=(e=e.replace("URL@","")).indexOf("/views/avatar_fullsize")<0?e+"/views/avatar_fullsize":e},e.resolveConversationAvatar=function(t,n){return n?t?e.replaceAvatarPath(n):n:""},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(22),i=n(15),r=function(){function e(){}return e.addScript=function(t,n,r,s){var a=n?i.UrlHelper.getAbsoluteUrl(t,"js"):t;if(-1===e.loaded.indexOf(a)){var c=e.progress;if(c[a])return r&&-1===c[a].success.indexOf(r)&&c[a].success.push(r),void(s&&-1===c[a].failure.indexOf(s)&&c[a].failure.push(s));c[a]={success:[],failure:[]},r&&c[a].success.push(r),s&&c[a].failure.push(s);var u=o.default.getDocument(),l=u.createElement("script");l.crossOrigin="anonymous",l.type="text/javascript",l.src=a,r&&(l.onload=function(){e.progress[a].success.forEach(function(e){try{e()}catch(e){}}),delete e.progress[a],e.loaded.push(a)}),s&&(l.onerror=function(){e.progress[a].failure.forEach(function(e){try{e()}catch(e){}}),delete e.progress[a]}),u.getElementsByTagName("body")[0].appendChild(l)}else r&&r()},e.loaded=[],e.progress={},e}();t.ScriptLoader=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={allowedProtocols:["https:"]},i=function(){function e(){this.probe=document.createElement("a")}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},e.prototype.validate=function(e,t){if(!e)return!1;var n=Object.assign(o,t||{}),i=function(e,t){if(!t)return!0;for(var n,o=0,i=t;o<i.length;o++){if(n=i[o]===e)break}return n};this.probe.href=e;var r=i(this.probe.protocol,n.allowedProtocols)&&i(this.probe.hostname,n.allowedDomains)&&i(this.probe.port,n.allowedPorts);return this.probe.href="",r},e}();t.UrlValidator=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.getQueryParameters=function(){var e=window.location.search.substring(1);return this.extractQueryParameters(e)},e.extractQuery=function(e){var t="";return e.indexOf("?")>-1&&(t=e.split("?")[1]),t},e.getQueryParameter=function(e,t){var n=this.extractQuery(e);return n?this.extractQueryParameters(n)[t]:null},e.extractQueryParameters=function(e){var t={};return e.split("&").forEach(function(e){var n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])||""}),t},e.extractProtocol=function(e){var t=null;return e.indexOf("://")>-1&&(t=e.split("://")[0]),t},e.extractHostname=function(e){return(e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]},e.extractPath=function(e){var t="";e.indexOf("//")>-1&&(e=e.split("//")[1]);var n=e.indexOf("/");return n>-1&&(t=e.substring(n)),t=t.split("?")[0]},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Online="Online",e.Busy="Busy",e.Offline="Offline",e.Undefined="Undefined",e.OnThePhone="OnThePhone",e.Away="Away",e.Idle="Idle",e.OutToLunch="OutToLunch",e.BeRightBack="BeRightBack",e.DoNotDisturb="DoNotDisturb"}(t.PresenceStatus||(t.PresenceStatus={}))},,,function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(0),a=n(7),c=n(18),u=n(33),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="",t}return i(t,e),t.prototype.render=function(){var e=s.swc.services.persons.getPerson(this.props.personId);return r.createElement(u.SwcPersonAvatar,{person:e,className:this.getComposedBlockClassName(),size:c.SwcAvatarSize.Medium,isPstn:this.props.isPstn,customAvatar:this.props.customAvatar,showPresence:this.props.showPresence,onClick:this.props.onClick,accessible:this.props.accessible})},t}(a.SwcBaseComponent);t.SwcPersonIdAvatar=l},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(0),a=n(39),c=n(7),u=n(8),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcAvatar",t}return i(t,e),t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.size&&(t+=" "+this.props.size),t},t.prototype.render=function(){var e={"background-color":a.getBackgroundColor(this.props.title)||"transparent"};return r.createElement("div",{className:this.getComposedBlockClassName(),style:e,"aria-hidden":!1===this.props.accessible?"true":void 0,"aria-label":s.swc.services.i18n.fetch("aria_avatar_label",{title:this.props.title})},r.createElement("span",{className:"swcAvatar__initials"},r.createElement(u.SwcIcon,{type:u.SwcIconType.Landline})))},t}(c.SwcBaseComponent);t.SwcPstnAvatar=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="px",i="all 0.5s ease";function r(e,t){var n=e.style;n.top=t.top+o,n.left=t.left+o,n.width=t.width+o,n.height=t.height+o}function s(e){return window.getComputedStyle(e)}t.transport=function(e,t,n,o,s,a){var c=e.getBoundingClientRect(),u=function(e){return t.appendChild(e)};a||u(e),e.style.transition=i,r(e,c),setTimeout(function(){return r(e,n)},0),setTimeout(function(){s(),e.style.transition=null,a&&u(e)},o)},t.setRectStyle=r,t.resetRectStyle=function(e){var t=e.style;t.width=t.height=t.top=t.bottom=t.right=t.left=null},t.isInDom=function(e){if(e)for(;e.parentNode;)if((e=e.parentNode)===document.documentElement)return!0;return!1},t.innerSize=function(e){var t=s(e);return{width:e.offsetWidth-parseInt(t.paddingLeft,10)-parseInt(t.paddingRight,10),height:e.offsetHeight-parseInt(t.paddingTop,10)-parseInt(t.paddingBottom,10)}},t.setStyle=function(e,t){e.setAttribute("style",t)},t.style=s,t.copyStyle=function(e,t,n){for(var o=s(t),i=e.style,r=0,a=n;r<a.length;r++){var c=a[r];i[c]=o[c]}},t.isInIframe=function(){try{return window.self!==window.top}catch(e){return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.unknown=0]="unknown",e[e.card=1]="card",e[e.carousel=2]="carousel",e[e.signin=3]="signin",e[e.receipt=4]="receipt",e[e.multiline=5]="multiline",e[e.adaptive=6]="adaptive"}(t.SwiftCardType||(t.SwiftCardType={})),function(e){e[e.unknown=0]="unknown",e[e.hero=1]="hero",e[e.thumb=2]="thumb",e[e.receipt=3]="receipt",e[e.signin=4]="signin",e[e.video=5]="video",e[e.audio=6]="audio",e[e.animation=7]="animation",e[e.actionImage=8]="actionImage",e[e.flex=9]="flex",e[e.adaptive=10]="adaptive"}(t.SwiftCardContentType||(t.SwiftCardContentType={})),function(e){e[e.unknown=0]="unknown",e[e.unsupported=1]="unsupported",e[e.openUrl=2]="openUrl",e[e.imBack=3]="imBack",e[e.signin=4]="signin",e[e.call=5]="call",e[e.showImage=6]="showImage",e[e.payment=7]="payment",e[e.postBack=8]="postBack"}(t.SwiftCardActionType||(t.SwiftCardActionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UserMessage="UserMessage",e.SwiftCard="SwiftCard",e.SystemMessage="SystemMessage",e.Unsupported="Unsupported",e.SkypeLogo="SkypeLogo",e.Welcome="Welcome",e.Translate="Translate",e.LwcImage="LwcImage",e.LwcFile="LwcFile",e.UnreadSplitter="UnreadSplitter"}(t.MessageType||(t.MessageType={})),function(e){e.CallEnd="CallEndMsg",e.MissedCall="MissedCallMsg",e.MissedGroupCall="MissedGroupCallMsg",e.Call="CallMsg",e.Custom="CustomMsg",e.MeLeftGroup="MeLeftGroupConversation"}(t.CustomMessageType||(t.CustomMessageType={})),function(e){e[e.Incoming=0]="Incoming",e[e.Outgoing=1]="Outgoing"}(t.Direction||(t.Direction={})),function(e){e[e.Pending=0]="Pending",e[e.Sent=1]="Sent",e[e.Failed=2]="Failed"}(t.DeliveryStatus||(t.DeliveryStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.addMember="addMember",e.changeTopic="changeTopic",e.changePicture="changePicture",e.kickMember="kickMember",e.editMsg="editMsg",e.callP2P="callP2P",e.sendText="sendText",e.sendSms="sendSms",e.sendFileP2P="sendFileP2P",e.sendContacts="sendContacts",e.sendVideoMsg="sendVideoMsg",e.sendMediaMsg="sendMediaMsg",e.changeModerated="changeModerated"}(t.ParticipantCapabilities||(t.ParticipantCapabilities={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UNDEFINED="",e.PERSON="person",e.PHONE="phone",e.AGENT="agent",e.JOIN="join",e.GROUP="group"}(t.ConversationType||(t.ConversationType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Admin="Admin",e.User="User"}(t.ParticipantRole||(t.ParticipantRole={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="NFKD",i={"ª":"a","º":"o","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","ā":"a","ă":"a","ą":"a","ć":"c","ĉ":"c","ċ":"c","č":"c","ď":"d","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","ĥ":"h","ĩ":"i","ī":"i","ĭ":"i","į":"i","ĳ":"ij","ĵ":"j","ķ":"k","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l·","ń":"n","ņ":"n","ň":"n","ŉ":"ʼn","ō":"o","ŏ":"o","ő":"o","ŕ":"r","ŗ":"r","ř":"r","ś":"s","ŝ":"s","ş":"s","š":"s","ţ":"t","ť":"t","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","ŵ":"w","ŷ":"y","ź":"z","ż":"z","ž":"z","ſ":"s","ơ":"o","ư":"u","ǆ":"dz","ǈ":"Lj","ǉ":"lj","ǋ":"Nj","ǌ":"nj","ǎ":"a","ǐ":"i","ǒ":"o","ǔ":"u","ǖ":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǟ":"a","ǡ":"a","ǧ":"g","ǩ":"k","ǫ":"o","ǭ":"o","ǰ":"j","ǳ":"dz","ǵ":"g","ǹ":"n","ǻ":"a","ȁ":"a","ȃ":"a","ȅ":"e","ȇ":"e","ȉ":"i","ȋ":"i","ȍ":"o","ȏ":"o","ȑ":"r","ȓ":"r","ȕ":"u","ȗ":"u","ș":"s","ț":"t","ȟ":"h","ȧ":"a","ȩ":"e","ȫ":"o","ȭ":"o","ȯ":"o","ȱ":"o","ȳ":"y","ʰ":"h","ʲ":"j","ʳ":"r","ʷ":"w","ʸ":"y","ˡ":"l","ˢ":"s","ˣ":"x"};function r(e,t){var n=e.substring(0,t).search(/\S+$/),o=e.substring(t).search(/\s/);return-1===n&&(n=t),-1===o?o=e.length:o+=t,{start:n,end:o}}t.toBoolean=function(e){return e?"true"===e.toLowerCase():null},t.wordAt=function(e,t){var n=r(e,t);return e.substring(n.start,n.end)},t.inject=function(e,t,n,o){return void 0===o&&(o=n),e.substr(0,n)+t+e.substr(o,e.length)},t.wordBoundariesAt=r,t.b64DecodeUnicode=function(e){return decodeURIComponent(Array.prototype.map.call(atob(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},t.normalizeString=function(e){if(e=e.toLowerCase(),String.prototype.normalize)return e.normalize(o).replace(/[\u0300-\u036f]/g,"");var t=parseInt("0xD800",16),n=parseInt("0xDBFF",16),r=0,s="",a="",c=void 0;if(!e)return e;for(;r<e.length;)s+=e.charAt(r),((c=e.charCodeAt(r))<t||c>n)&&(a+=i.hasOwnProperty(s)?i[s]:s,s=""),r++;return a},t.startsWith=function(e,t){return 0===e.indexOf(t)},t.endsWith=function(e,t){return e.lastIndexOf(t)===e.length-t.length}},,,,function(e,t,n){"use strict";var o,i,r;Object.defineProperty(t,"__esModule",{value:!0}),window.swc=window.swc||{},function(e){e[e.iwapp=927]="iwapp",e[e.todo=927]="todo",e[e.wac=928]="wac",e[e.powerbi=930]="powerbi",e[e.sharepoint=931]="sharepoint",e[e.adminportal=932]="adminportal",e[e.yammer=933]="yammer",e[e.dynamics365=934]="dynamics365",e[e.dynamicsnav=934]="dynamicsnav"}(o||(o={})),function(e){e[e.outlook=915]="outlook",e[e.interviews=916]="interviews",e[e.bing=917]="bing",e[e.msn=918]="msn",e[e.azureportal=919]="azureportal",e[e.onedrive=920]="onedrive",e[e.scom=921]="scom",e[e.office=927]="office",e[e.word=928]="word",e[e.excel=929]="excel",e[e.powerpoint=930]="powerpoint",e[e.sharepoint=931]="sharepoint",e[e.adminportal=932]="adminportal",e[e.yammer=933]="yammer",e[e.dynamics=934]="dynamics",e[e["office default"]=935]="office default"}(i=t.NameMapping||(t.NameMapping={})),function(e){e[e["outlook.live.com"]=915]="outlook.live.com",e[e["outlook-sdf.live.com"]=915]="outlook-sdf.live.com",e[e["interviews.skype.com"]=916]="interviews.skype.com",e[e["interviews-df.skype.com"]=916]="interviews-df.skype.com",e[e["interviews-int.skype.com"]=916]="interviews-int.skype.com",e[e["www.bing.com"]=917]="www.bing.com",e[e["www.staging-bing-int.com"]=917]="www.staging-bing-int.com",e[e["www.bing-int.com"]=917]="www.bing-int.com",e[e["www.msn.com"]=918]="www.msn.com",e[e["int.msn.com"]=918]="int.msn.com",e[e["int1.msn.com"]=918]="int1.msn.com",e[e["wtskype2.azurewebsites.net"]=919]="wtskype2.azurewebsites.net",e[e["azuresupportextension-ms.hosting.portal.azure.net"]=919]="azuresupportextension-ms.hosting.portal.azure.net",e[e["portal.azure.com"]=919]="portal.azure.com",e[e["rc.portal.azure.com"]=919]="rc.portal.azure.com",e[e["ms.portal.azure.com"]=919]="ms.portal.azure.com",e[e["onedrive.live.com"]=920]="onedrive.live.com",e[e["www.skype.com"]=921]="www.skype.com",e[e["www.office.com"]=927]="www.office.com",e[e["microsoft-my.sharepoint.com"]=931]="microsoft-my.sharepoint.com",e[e["www.onedrive.com"]=920]="www.onedrive.com",e[e["word.office.com"]=928]="word.office.com",e[e["word.live.com"]=928]="word.live.com",e[e["excell.office.com"]=929]="excell.office.com",e[e["excell.live.com"]=929]="excell.live.com",e[e["powerpoint.office.com"]=930]="powerpoint.office.com",e[e["powerpoint.live.com"]=930]="powerpoint.live.com",e[e["sharepoint.office.com"]=931]="sharepoint.office.com",e[e["adminportal.office.com"]=932]="adminportal.office.com",e[e["www.yammer.com"]=933]="www.yammer.com",e[e["dynamics.office.com"]=934]="dynamics.office.com",e[e[".office.com"]=935]=".office.com"}(r||(r={}));var s=function(){function e(){}return e.getPlatformId=function(e){if(void 0===e&&(e=null),this._platformId)return this._platformId;if(swc.SDK&&swc.SDK.platformId&&swc.SDK.platformId>0)return this._platformId=swc.SDK.platformId,this._platformId;var t=-1;return e&&(t=this.getPlatformIdByAttribute(e)),t<=0&&(t=this.getPlatformIdByDomain()),t>0?t:912},e.getPlatformIdByAttribute=function(e){if(e){e=e.trim().toLowerCase();var t=parseInt(e,10);return t&&t>0?t:this.getPlatformIdForOffice(e)}return-1},e.getPlatformName=function(){var e=this.getPlatformId();return i[e]?i[e]:"other"},e.getPlatformIdForOffice=function(e){return o[e]||935},e.getPlatformIdByDomain=function(){var t=e.getHost();if(r.hasOwnProperty(t))return r[t];for(var n in r)if("."===n.charAt(0)&&t.indexOf(n)>0)return r[n];return-1},e.getHost=function(){try{var e=window.location.hostname;return!e&&e.length>0?e:("file:"===window.location.protocol.toLowerCase()&&(e="local"),e)}catch(e){return null}},e}();t.PlatformUtils=s},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),s=n(2),a=n(168),c=n(169),u=n(25),l=n(17),d=n(10),p=n(29),f=n(12),h=n(34),g=n(170),v=n(38),m=n(0),y=n(145),_=n(15),S=n(118),w=n(116),C=n(171),E=n(172);n(173);var b,T="Please disable your popup blocker as it affects sign in/out process. Repeat the operation again after disabling the blocker.",P=2e4;!function(e){e.SpacesApi="https://api.spaces.skype.com",e.Sharepoint="https://microsoft-my.sharepoint.com",e.Presence="https://presence.teams.microsoft.com",e.AggregationApi="https://chatsvcagg.teams.microsoft.com"}(b=t.AadAudience||(t.AadAudience={}));var O=function(){function e(e,t){var n=this;this.tokenProvider=e,this.regionGtmsProvider=t,this.tokenProviderCallback=function(){return Promise.all([n.tokenProvider(),n.regionGtmsProvider()]).then(function(e){var t=e[0],o=e[1];return{tokens:{skypeToken:t,expiresIn:n.getExiresIn(t)},regionGtms:o}})}}return e.prototype.getExiresIn=function(e){return(new y.TokenParser).getTokenData(e).exp-Math.floor(Date.now()/1e3)},e}(),A=function(e){function t(n,o,i,d,g){var v=e.call(this)||this;v.outerTokenProvider=n,v.tokenType=d,v._signOutContext=new E.default,v._reloginContext=new a.default(!1),v._tokenParser=new y.TokenParser,v._userIdentityType=p.IdentityType.UNDETERMINED,v._failedSilentLoginCount=0,v.isSilentLoginEnabled=!0,v.login=function(e){if(v._externalLogin&&"function"==typeof v._externalLogin)return v._externalLogin(),void v.sendSignedInTelemetry("","externalLogin");var t=s.Configuration.LOGIN_PAGE_URL;if(t+="?client_id="+s.Configuration.LOGIN_CLIENT_ID,t+="&redirect_uri="+encodeURI(_.UrlHelper.getConnectPagePath()),t+="&lang="+s.Configuration.LOCALE,t+="&response_type=token",v._getTokenPromise&&v._getTokenPromise.status===l.PromiseStatus.Pending){var n=v.showLoginPopup.bind(v,t,e);v._getTokenPromise.promise.then(null,n)}else v.showLoginPopup(t,e)},v.logout=function(e){if(v.outerTokenProvider)return Promise.resolve();if(v._signOutContext.signoutPromise)return v._signOutContext.signoutPromise;if(v.state===u.SigninState.SigningOut)return Promise.resolve();if(v.prelogoutActions.length>0){var t=v._logout.bind(v,e);return v._signOutContext.signoutPromise=v.execPrelogoutAction(v.prelogoutActions.pop()).then(t,t),v._signOutContext.signoutPromise}return v._signOutContext.signoutPromise=v._logout(e),v._signOutContext.signoutPromise},v._logout=function(e){if(v.state===u.SigninState.SigningOut)return Promise.resolve();var t=Date.now();v._reloginContext.canRelogin||v._reloginContext.setContext(v.activeConversationSdkMode===h.SDKMode.BOT,function(){return v.getGuestToken()});var n=s.Configuration.LOGOUT_PAGE_URL;n+="?",n+="&client_id="+s.Configuration.LOGIN_CLIENT_ID,n+="&redirect_uri="+_.UrlHelper.getConnectPagePath(),n+="&redirect=true",n+="&response_type=token";var o=window.open(n,"_blank",s.Configuration.LOGOUT_POPUP_FEATURES),i=null===o||void 0===o;return i&&v._userIdentityType===p.IdentityType.SKYPE?(v.sendSignedOutTelemetry(e,t,!0),alert(T),Promise.resolve()):(!i&&window.focus&&o.focus(),v.state=u.SigninState.SigningOut,v.state=u.SigninState.SignedOut,v.reset(),v.sendSignedOutTelemetry(e,t),v._lastAuthSource=c.AuthSource.UserLogout,r.default.get.meId="",Promise.resolve())},v.execPrelogoutAction=function(e){var t=function(){if(v.prelogoutActions.length>0){var e=v.prelogoutActions.pop();return v.execPrelogoutAction(e)}return Promise.resolve()};e&&"function"==typeof e||t();var n=e();return n&&"function"==typeof n.then?n.then(t.bind(v),t.bind(v)):t()},v.getGuestToken=function(){if(v._guestUserPromise)return v._guestUserPromise;var e=Date.now();return v._guestUserPromise=C.getGuestToken("Guest").then(function(t){return v._userIdentityType=p.IdentityType.GUEST,v.setTokenDataToCache(t.SkypeToken,86400,!0),v.sendSignedInTelemetry(t.SkypeToken,"guest",e),v._signOutContext.reset(),t},function(t){v.sendSignedInTelemetry(void 0,"guest",e,t.message),v.clearUserDataFromCache(),v._guestUserPromise=null}),v._guestUserPromise},v.showLoginPopup=function(e,t){var n,o,i=Date.now(),r=v.state===u.SigninState.SignedOut,a=function(e){var s=/(?:access_token=)([\S]*)(?:&)(?:expires_in=)([\d*]*)/g.exec(e.data);if(s&&(n=s[1],o=s[2]),s||(n=e.data.token,o=Date.now()+864e5+""),!n)return v.state=u.SigninState.SignedOut,void window.removeEventListener("message",a);v._failedSilentLoginCount=0,r&&(v.currentUsername=n?v._tokenParser.retrieveMeName(n):"",v.setTokenDataToCache(n,parseInt(o,10),!1),v.publish("resurrect",!0),v._signOutContext.reset()),r?t&&t(n):(v._reloginContext.setContext(!0,function(){return v._userIdentityType=p.IdentityType.SKYPE,v.setTokenDataToCache(n,parseInt(o,10),!1),v.sendSignedInTelemetry(n,"popup",i),t&&t(n),Promise.resolve()}),v._signOutContext.reset(),v._signOutContext.isRelogin=!0,v.logout()),v._lastAuthSource=c.AuthSource.Popup,window.removeEventListener("message",a)};window.addEventListener("message",a,!1);var l=window.open(e,"_blank",s.Configuration.LOGIN_POPUP_FEATURES);l&&window.focus&&l.focus()},v.aadTokens={},v.aad=function(e){if(!v.outerTokenProvider)return Promise.reject("outerTokenProvider is not defined");e||(e=b.SpacesApi);var t=function(e){return v.outerTokenProvider(e).then(function(e){return-1===e.indexOf("Bearer")?"Bearer "+e:e})};return v.aadTokens[e]||(v.aadTokens[e]=t(e)),v.aadTokens[e].then(function(n){return function(e){var t=v._tokenParser.getTokenData(e),n=Date.now()+1e4;return t&&1e3*t.exp>n}(n)?n:(v.aadTokens[e]=t(e),v.aadTokens[e])})};var m=!r.default.get.frameless&&window!==window.top&&!!window.parent,S=!d||d!==w.TokenType.Aad,P=!S&&m;return v.isSilentLoginEnabled=S,v._onceSingedInPromise=new l.CancelablePromise,v._state=u.SigninState.SignedOut,P||(v.getSkypeToken=n||v._getSkypeToken),v._externalLogin=i,r.default.get.backend=d&&"aad"===d?f.MessagingBackend.TEAMS:f.MessagingBackend.SKYPE,P&&g&&(v.teamsRemoteTokenExchange=new O(g.skypetokenProvider,g.regionGtmsProvider),v.getSkypeToken=function(){return v._getSkypeTokenFromAad()}),v.outerTokenProvider?S?(v.clearUserDataFromCache(),v._getInfoFromExternalToken()):v._getSkypeTokenFromAad():o&&(v.clearUserDataFromCache(),v.setTokenDataToCache(o.skypeToken,o.expiresAt,o.isGuest),S?(v._userIdentityType=t._getUserIdentityType(o),v._lastAuthSource=c.AuthSource.WX):(v.teamsTokenPromise=Promise.resolve(o.skypeToken),v.currentUsername=v._tokenParser.retrieveMeName(o.skypeToken),v.state=u.SigninState.SignedIn,v._lastAuthSource=c.AuthSource.AAD,v._userIdentityType=p.IdentityType.SKYPE)),v.prelogoutActions=[],v}return i(t,e),t._getUserIdentityType=function(e){return e.isGuest?p.IdentityType.GUEST:"aad"===e.tokenType?p.IdentityType.TEAMS:p.IdentityType.SKYPE},t.prototype._getInfoFromExternalToken=function(){var e=this;r.default.get.backend=f.MessagingBackend.SKYPE,this.outerTokenProvider().then(function(t){e.currentUsername=t?e._tokenParser.retrieveMeName(t):"";var n=e._userId.indexOf("guest:")>-1;e.state=t?u.SigninState.SignedIn:u.SigninState.SignedOut,e._lastAuthSource=n?c.AuthSource.Guest:c.AuthSource.External,e._userIdentityType=n?p.IdentityType.GUEST:p.IdentityType.SKYPE,e.sendSignedInTelemetry(t,"external",Date.now())},function(){e.state=u.SigninState.SignedOut,e._lastAuthSource=c.AuthSource.External,e.sendSignedInTelemetry(null,"external",Date.now())})},t.prototype._getSkypeToken=function(){var e=this;if(r.default.get.backend=f.MessagingBackend.SKYPE,this._getTokenPromise&&this._getTokenPromise.status===l.PromiseStatus.Pending)return this._getTokenPromise.promise;this._lastAuthSource=c.AuthSource.UNDEFINED;var t=this.getTokenDataFromCache();if(t&&t.isGuest&&r.default.get.isSkypeOnly&&(t=null),r.default.get.isGuestOnlyMode&&t&&!t.isGuest&&(this.clearUserDataFromCache(),t=null),this._signedIn||!t||t.isGuest||(t=null),t)return this.currentUsername=this._tokenParser.retrieveMeName(t.token),this._userIdentityType=t.isGuest?p.IdentityType.GUEST:p.IdentityType.SKYPE,void 0===this._signedIn&&(this.sendSignedInTelemetry(t.token,"cache",Date.now()),this.callExternalHandler(this.externalSuccessCallback)),this._lastAuthSource=c.AuthSource.Cache,this.state=u.SigninState.SignedIn,Promise.resolve(t.token);this.state=u.SigninState.SigningIn,this.clearUserDataFromCache();var n=new Promise(function(t,n){var o=e;function i(e){o.activeConversationSdkMode===h.SDKMode.BOT?(o.state!==u.SigninState.SignedIn&&(o.state=u.SigninState.SigningIn),o.getGuestToken().then(function(e){o.currentUsername=o._tokenParser.retrieveMeName(e.SkypeToken),o.state=u.SigninState.SignedIn,t(e.SkypeToken),o.callExternalHandler(o.externalSuccessCallback),o._lastAuthSource=c.AuthSource.Guest}).catch(function(e){o.clearUserDataFromCache(),o.callExternalHandler(o.externalFailureCallback,o.formatError(e)),o._guestTokenRetryInterval||(o._guestTokenRetryInterval=new S.FixedTimeout(i.bind(o),P)),o._guestTokenRetryInterval.start()})):(o.state=u.SigninState.SignedOut,n(),o.callExternalHandler(o.externalFailureCallback,o.formatError(e)))}e.state!==u.SigninState.SignedIn&&(e.state=u.SigninState.SigningIn),r.default.get.isGuestOnlyMode?i():e.silentLogin().then(function(e){this.state=u.SigninState.SignedIn,this.currentUsername=this._tokenParser.retrieveMeName(e),t(e),this.callExternalHandler(this.externalSuccessCallback),this._lastAuthSource=c.AuthSource.SilentLogin}.bind(e),function(e){return r.default.get.isSkypeOnly?(o.state=u.SigninState.SignedOut,o.callExternalHandler(o.externalFailureCallback),n()):i(e)}.bind(e))});return this._getTokenPromise=new l.CancelablePromise(n),this._getTokenPromise.promise},t.prototype.onceSignedIn=function(){return this.getSkypeToken().then(null,function(){}),this._onceSingedInPromise.promise},t.prototype.getLastAuthSource=function(){return this._lastAuthSource},Object.defineProperty(t.prototype,"lastAuthSource",{get:function(){return this._lastAuthSource},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){if(e===u.SigninState.SignedIn&&(this._lastSignedInTimestamp=Date.now()),e!==this._state){this._state=e,this._signedIn=this._state===u.SigninState.SignedIn,this.publish("state",e),this.publish("isSignedIn",this._signedIn);var t=this._onceSingedInPromise.status===l.PromiseStatus.Pending;this._signedIn&&t?this._onceSingedInPromise.resolve():this._state!==u.SigninState.SignedOut||t||(this._onceSingedInPromise=new l.CancelablePromise)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userIdentityType",{get:function(){return this._userIdentityType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUsername",{set:function(e){this._userId=e,r.default.get.meId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUserName",{get:function(){return this._userId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSignedIn",{get:function(){return this._signedIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reloginContext",{get:function(){return this._reloginContext},enumerable:!0,configurable:!0}),t.prototype.checkAuthFailuresCount=function(e){e>=3&&this.clearUserDataFromCache()},t.prototype.setExternalCallbacks=function(e,t){this.externalSuccessCallback=e,this.externalFailureCallback=t,this._state===u.SigninState.SignedIn&&this.callExternalHandler(this.externalSuccessCallback)},t.prototype.getTokenExpirationTime=function(){var e=this.getTokenDataFromCache();return e&&e.expiresAt},t.prototype.sendSignedInTelemetry=function(e,t,n,o){this.currentUsername=e?this._tokenParser.retrieveMeName(e):"",m.swc.Telemetry.sendEvent.signIn(e?200:500,t,n?Date.now()-n:-1,o)},t.prototype.sendSignedOutTelemetry=function(e,t,n){m.swc.Telemetry.sendEvent.signOut(n?500:200,e,t?Date.now()-t:-1,n?"Popup is blocked":void 0)},t.prototype.getRegistrationToken=function(){var e,t=m.swc.services.sessionStorage.getItem(v.SKYPE_REGTOKEN_KEY);if(t)try{e=JSON.parse(t)}catch(e){}return e},t.prototype.getTokenDataFromCache=function(){if(!this._tokenData)try{this._tokenData=JSON.parse(m.swc.services.sessionStorage.getItem(v.SKYPE_TOKEN_KEY))}catch(e){return this.clearUserDataFromCache(),null}return this._tokenData&&(this._tokenData=this.isTokenValid(this._tokenData)?this._tokenData:null),this._tokenData},t.prototype.isTokenValid=function(e){var t=this.getRegistrationToken();return!(t&&!t.value&&t.failureCount>=3)&&(!(e.expiresAt<Date.now())&&(this._userIdentityType===p.IdentityType.SKYPE&&this.activeConversationSdkMode===h.SDKMode.PERSON&&e.isGuest?(this._tokenData=null,this.clearUserDataFromCache(),!1):!(this._userIdentityType===p.IdentityType.GUEST&&this.activeConversationSdkMode===h.SDKMode.BOT&&!e.isGuest)||(this._tokenData=null,this.clearUserDataFromCache(),!1)))},t.prototype.setTokenDataToCache=function(e,t,n){var o=this,i=0;t&&(i=Date.now()+1e3*t,this._tokenRenovationTimeout&&this._tokenRenovationTimeout.reset(),this._tokenRenovationTimeout=new S.FixedTimeout(function(){r.default.get.backend===f.MessagingBackend.TEAMS?(o.teamsTokenPromise=null,o._getSkypeTokenFromAad()):n?o.getGuestToken():o.silentLogin()},1e3*Math.abs(t-60)),this._tokenRenovationTimeout.start()),m.swc.services.sessionStorage.setItem(v.SKYPE_TOKEN_KEY,JSON.stringify({token:e,expiresAt:i,isGuest:n}))},t.prototype.clearUserDataFromCache=function(){this._tokenData=null,m.swc.services.sessionStorage.removeItem(v.SKYPE_TOKEN_KEY),m.swc.services.sessionStorage.removeItem(v.SKYPE_REGTOKEN_KEY),m.swc.services.sessionStorage.removeItem(v.SKYPE_ENDPOINT_ID_KEY),m.swc.services.sessionStorage.removeItem(v.SKYPE_HAS_HISTORY_KEY)},t.prototype.silentLogin=function(){var e=this;if(!this.isSilentLoginEnabled)return Promise.reject("Silent login is disabled");if(this._silentLoginPromise)return this._silentLoginPromise;var t=Date.now();return this._silentLoginPromise=new Promise(function(n,o){var i={client_id:s.Configuration.LOGIN_CLIENT_ID,env:"live",callback:function(i){var r,s=function(o){e.sendSignedInTelemetry(o,"silent",t),e._silentLoginPromise=null,n(o)};try{r=JSON.parse(i.data)}catch(e){r=i.data?i.data:i}r.error?(r.error,"invalid_grant"===r.error&&e.clearUserDataFromCache(),e._failedSilentLoginCount<1&&e.sendSignedInTelemetry(void 0,"silent",t,r.error),e._failedSilentLoginCount++,e._silentLoginPromise=null,o(r.error)):r.token?(e.setTokenDataToCache(r.token,r.expires_in,!1),s(r.token)):r.skypetoken&&(e.setTokenDataToCache(r.skypetoken,r.expires_in,!1),s(r.skypetoken)),o(new Error("Neither token nor skypeToken in the response"))}};m.SKYPE.login.Silent.init(i).load()}),this._silentLoginPromise},t.prototype.callExternalHandler=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e&&"function"==typeof e)try{e.apply(null,[].slice.call(arguments,1))}catch(e){}},t.prototype.formatError=function(e){var t;return e instanceof Error?t=Object.create(e):"string"==typeof e?t=new Error(e):(t=new Error("Unknown: please check *data* property for more info")).data=e,t.name="SWCApi:signin:"+t.name,t},t.prototype.reset=function(){this.clearUserDataFromCache(),this._signOutContext.reset(),this._guestUserPromise=null,this._silentLoginPromise=null,this._signedIn=!1,this._tokenData=null,this.currentUsername="",this._getTokenPromise&&this._getTokenPromise.status===l.PromiseStatus.Pending&&this._getTokenPromise.cancel(),this._getTokenPromise=null,this._aad=null,this._tokenRenovationTimeout&&(this._tokenRenovationTimeout.reset(),this._tokenRenovationTimeout=null)},t.prototype.isAadSupported=function(){return!!this.outerTokenProvider&&this.tokenType===w.TokenType.Aad},t.prototype.setTeamsUrls=function(e){e&&(s.Configuration.CHAT_HOST_URL=e.chatService+"/v1/",s.Configuration.CHAT_GUEST_HOST_URL=e.chatService+"/v1/",s.Configuration.AMS_HOST_URL=e.ams+"/v1/",s.Configuration.AVATAR_SERVICE_URL=e.mtImageService,s.Configuration.TEAMS_MIDDLE_TIER_URL=e.middleTier)},t.prototype._signInWithAadSkypetokens=function(e,t){void 0===t&&(t=!1),this.setTeamsUrls(e.regionGtms),r.default.get.backend=f.MessagingBackend.TEAMS,this.setTokenDataToCache(e.tokens.skypeToken,e.tokens.expiresIn,t),this.currentUsername=this._tokenParser.retrieveMeName(e.tokens.skypeToken),this.state=e.tokens.skypeToken?u.SigninState.SignedIn:u.SigninState.SignedOut,this._lastAuthSource=c.AuthSource.AAD,this._userIdentityType=p.IdentityType.SKYPE,this.sendSignedInTelemetry(e.tokens.skypeToken,"aad",Date.now())},t.prototype._getSkypeTokenFromAad=function(){var e=this;return this.teamsTokenPromise?this.teamsTokenPromise:this.teamsRemoteTokenExchange?(this.teamsTokenPromise=this.teamsRemoteTokenExchange.tokenProviderCallback().then(function(t){return e._signInWithAadSkypetokens(t),t.tokens.skypeToken}),this.teamsTokenPromise):(this.teamsTokenPromise=new Promise(function(t,n){var o=function(t){e.clearUserDataFromCache(),e.state=u.SigninState.SignedOut,e.sendSignedInTelemetry(null,"aad",Date.now()),n()};e.outerTokenProvider(b.SpacesApi).then(function(n){-1===n.indexOf("Bearer")&&(n="Bearer "+n),g.default.exchangeForSkypeToken(n).then(function(n){n.json?n.json().then(function(n){n.tokens?(e.setTeamsUrls(n.regionGtms),e.setTokenDataToCache(n.tokens.skypeToken,n.tokens.expiresIn,!1),e.currentUsername=e._tokenParser.retrieveMeName(n.tokens.skypeToken),e.state=n.tokens.skypeToken?u.SigninState.SignedIn:u.SigninState.SignedOut,e._lastAuthSource=c.AuthSource.AAD,e._userIdentityType=p.IdentityType.SKYPE,e.sendSignedInTelemetry(n.tokens.skypeToken,"aad",Date.now()),t(n.tokens.skypeToken)):o()},o):o()},o)},function(e){})}),this.getSkypeToken=this._skypeTokenBasedOnAad.bind(this),this.teamsTokenPromise)},t.prototype._skypeTokenBasedOnAad=function(){var e=this;return this.teamsTokenPromise.then(function(t){var n=Date.now()+6e4;return e.getTokenExpirationTime()<=n?(e.teamsTokenPromise=void 0,e._getSkypeTokenFromAad()):t})},t}(d.default);t.default=A},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(10),a=n(17),c=function(e){function t(){var t=e.call(this)||this;return t._isOnline=navigator.onLine,t.subscribeOnlineHandlers(),t}return i(t,e),Object.defineProperty(t.prototype,"isOnline",{get:function(){return this._isOnline},set:function(e){e!==this._isOnline&&(this._isOnline=e,this.publish("isOnline",e),e&&this._onlinePromise&&this._onlinePromise.status===a.PromiseStatus.Pending&&this._onlinePromise.resolve())},enumerable:!0,configurable:!0}),t.prototype.onceOnline=function(){return this.isOnline?Promise.resolve():(this._onlinePromise&&this._onlinePromise.status===a.PromiseStatus.Pending||(this._onlinePromise=new a.CancelablePromise),this._onlinePromise.promise)},t.prototype.subscribeOnlineHandlers=function(){window.addEventListener("online",this.onlineStatusHandler.bind(this)),window.addEventListener("offline",this.onlineStatusHandler.bind(this))},t.prototype.onlineStatusHandler=function(){this.isOnline=navigator.onLine},t}(s.default);t.get=function(){return r||(r=new c),r}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.multilineRegExp=function(e,t){return new RegExp(e.join(""),t)},e.escapeSpecialChars=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},e}();t.default=o},,,,function(e,t,n){(function(t){(function(){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};l.prototype.append=function(e,t){e=a(e),t=c(t);var n=this.map[e];n||(n=[],this.map[e]=n),n.push(t)},l.prototype.delete=function(e){delete this.map[a(e)]},l.prototype.get=function(e){var t=this.map[a(e)];return t?t[0]:null},l.prototype.getAll=function(e){return this.map[a(e)]||[]},l.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},l.prototype.set=function(e,t){this.map[a(e)]=[c(t)]},l.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(o){e.call(t,o,n,this)},this)},this)},l.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),u(e)},l.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},l.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),u(e)},t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var r=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},g.call(v.prototype),g.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var s=[301,302,303,307,308];y.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=l,e.Request=v,e.Response=y,e.fetch=function(e,n){return new Promise(function(o,i){var r=new v(e,n),s=new XMLHttpRequest;s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new l,e.split("\r\n").forEach(function(e){var n=e.split(":"),o=n.shift().trim();if(o){var i=n.join(":").trim();t.append(o,i)}}),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;o(new y(i,n))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.open(r.method,r.url,!0),"include"===r.credentials&&(s.withCredentials=!0),"responseType"in s&&t.blob&&(s.responseType="blob"),r.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===r._bodyInit?null:r._bodyInit)})},e.fetch.polyfill=!0}function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function l(e){this.map={},e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&o(e))this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n,o=d(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=p(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),o=0;o<t.length;o++)n[o]=String.fromCharCode(t[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function v(e,t){var n,o,i=(t=t||{}).body;if("string"==typeof e)this.url=e;else{if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=(n=t.method||this.method||"GET",o=n.toUpperCase(),r.indexOf(o)>-1?o:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),o=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(i))}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this),e.exports=t.fetch}).call(t)}).call(this,n(24))},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(9),r={version:"1.0.0.0",urls:["https://config.edge.skype.com"]};t.configLoader=function(e,t,n){return new Promise(function(n,c){var u=function(){var e=o.Configuration.ECS?o.Configuration.ECS.version:r.version;/\d\.\d\.\d/.test(e)||(e=r.version);for(var t=e.split(".",4),n=o.Configuration.getPlatformId();t.length<4;)t.unshift("0");var i=t.join(".");return n?n+"_"+i:i}(),l=a(e,u,t),d=0,p=function(){if(d<l.length){var t=l[d++];s(e,t).then(function(e){return e?n(e):p()}).catch(function(e){var n="Error: "+e+" URL: "+t;i.default.throwError(12001,n),p()})}else{var o="Unable to fetch config from ECS, name: "+e+", urls: "+l;i.default.throwError(12001,o),c(o)}};p()})};var s=function(e,t){return new Promise(function(n,o){var r=encodeURIComponent("jsonSwcEcsFetch"+e+Date.now()),s=document.querySelector("body"),a=document.createElement("script"),c=-1===t.indexOf("?")?"?":"&",u=""+t+c+"callback="+r;a.src=u;var l=function(){delete window[r],s.removeChild(a)};window[r]=function(e){clearTimeout(d),l(),n(e)};var d=setTimeout(function(){l();var e="[configLoader.fetchJson] ECS timed out after 10000 ms, url: "+u;i.default.throwError(12003,"[configLoader.fetchJson] ECS returned values:"+e),o("ECS timed out "+e)},1e4);s.appendChild(a)})},a=function(e,t,n){var o,i,s=[],a=(i=[],o=(o=n)||{},Object.keys(o).forEach(function(e){i.push(encodeURIComponent(e)+"="+encodeURIComponent(o[e]))}),i.join("&"));return r.urls.forEach(function(n){s.push(n+"/config/v1/"+e+"/"+t+(a?"?"+a:""))}),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hashCode=function(e){var t=0,n=e.length,o=0;if(n>0)for(;o<n;)t=(t<<5)-t+e.charCodeAt(o++)|0;return t}},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(7),a=n(18),c=n(47),u=n(48),l=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="",n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n.state={title:"",avatarUrl:"",isPerson:!1,isPstn:!1},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this.props.item;this.setState({isPerson:e.isPerson,isPstn:e.isPstn}),e.isPerson||(this._onTopicUpdate(e.topic),e.subscribe("topic",this._onTopicUpdate),e.isPstn||(e.avatar&&this._onAvatarUpdate(e.avatar),e.subscribe("avatar",this._onAvatarUpdate)))},t.prototype.componentWillUnmount=function(){var e=this.props.item;e.unsubscribe("avatar",this._onAvatarUpdate),e.unsubscribe("topic",this._onTopicUpdate)},t.prototype.render=function(){if(this.state.isPstn)return r.createElement(u.SwcPstnAvatar,{className:this.getComposedBlockClassName(),size:a.SwcAvatarSize.Medium,title:this.state.title,accessible:!1});if(this.state.isPerson){var e=this.props.item.id;return this.props.item.withPerson&&(e=this.props.item.withPerson.mri),r.createElement(c.SwcPersonIdAvatar,{className:this.getComposedBlockClassName(),personId:e,showPresence:!0,accessible:!1})}return r.createElement(a.SwcAvatar,{className:this.getComposedBlockClassName(),size:a.SwcAvatarSize.Medium,title:this.state.title,avatarUrl:this.state.avatarUrl,accessible:!1})},t}(s.SwcBaseComponent);t.SwcRecentAvatar=l},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(7),a=n(18),c=n(77),u=n(33),l=n(47),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="",t}return i(t,e),t.prototype.render=function(){return this.props.conversation.isOneOnOne?this.props.conversation.isTeamsOneOnOne?r.createElement(u.SwcPersonAvatar,{className:this.getComposedBlockClassName(),size:a.SwcAvatarSize.Medium,person:this.props.conversation.theOtherParticipant.person,showPresence:!0,customAvatar:this.props.customAvatar}):r.createElement(l.SwcPersonIdAvatar,{className:this.getComposedBlockClassName(),personId:this.props.conversation.id,showPresence:!0,customAvatar:this.props.customAvatar}):r.createElement(c.SwcGroupAvatar,{className:this.getComposedBlockClassName(),group:this.props.conversation,customAvatar:this.props.customAvatar,customTitle:this.props.customTitle})},t}(s.SwcBaseComponent);t.SwcConversationAvatar=d},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),a=n(7),c=n(18),u=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="",n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n.state={title:n.props.customTitle||"",avatarUrl:n.props.customAvatar||""},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this.props.group;this.props.customTitle?this._onTopicUpdate(this.props.customTitle):(this._onTopicUpdate(e.topic),e.subscribe("topic",this._onTopicUpdate)),this.props.customAvatar?this._onAvatarUpdate(this.props.customAvatar):(e.avatar&&this._onAvatarUpdate(e.avatar),e.subscribe("avatar",this._onAvatarUpdate))},t.prototype.componentWillUnmount=function(){var e=this.props.group;e.unsubscribe("avatar",this._onAvatarUpdate),e.unsubscribe("topic",this._onTopicUpdate)},t.prototype.render=function(){return s.createElement(c.SwcAvatar,r({className:this.getComposedBlockClassName(),size:c.SwcAvatarSize.Medium},this.state))},t}(a.SwcBaseComponent);t.SwcGroupAvatar=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addGetParamsToUrl=function(e,t){var n=[],o=function(e){if(void 0!==t[e]){var o=encodeURIComponent(e);if(Array.isArray(t[e]))t[e].forEach(function(e){var t=encodeURIComponent(e);n.push(o+"="+t)});else{var i=encodeURIComponent(t[e].toString());n.push(o+"="+i)}}};for(var i in t)o(i);return e+"?"+n.join("&")}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(22),i=function(){function e(){}return e.addStyle=function(e,t){if(!(t=t||o.default.getDocument()).head||function(e,t){for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].href===e)return!0;return!1}(e))return Promise.resolve();var n=t.createElement("link");return n.type="text/css",n.rel="stylesheet",n.href=e,new Promise(function(e,o){n.onload=function(){return e()},n.onerror=function(){return o()},t.head.appendChild(n)})},e}();t.StyleLoader=i},,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2);!function(e){e.Connecting="Skype_Call_Connecting.m4a",e.Dialing="Skype_Call_Dialing.m4a",e.Ended="Skype_Call_Ended.m4a",e.Reconnected="Skype_Call_Reconnected.m4a",e.Ringback="Skype_Call_Ringback.m4a",e.Ringing="Skype_Call_Ringing.m4a",e.Notification="Skype_Notification.m4a",e.Message_Received="Skype_Msg_Received.m4a"}(t.SupportedSounds||(t.SupportedSounds={}));var i=function(){function e(t){var n=[];for(var o in t)t.hasOwnProperty(o)&&n.push(t[o]);this.soundsArr=n.map(e.loadSound)}return e.loadSound=function(t){var n=new Audio(e.getSoundPath(t));return n.preload="auto",{fileName:t,audioObject:n}},e.getSoundPath=function(e){return o.Configuration.ECS.domain+"/assets/sounds/"+e},e.prototype.getSound=function(e){for(var t=0,n=this.soundsArr;t<n.length;t++){var o=n[t];if(o.fileName===e)return o.audioObject}return null},e.prototype.play=function(e,t){var n=this;return void 0===t&&(t=!0),new Promise(function(o){var i=n.getSound(e);null!==i&&(i.loop=t,i.onended=function(){return o()},i.play())})},e.prototype.playOnce=function(e){return this.play(e,!1)},e.prototype.stop=function(e){var t=this.getSound(e);null!==t&&(t.pause(),t.currentTime=0)},e.prototype.stopAll=function(){var e=this;this.soundsArr.forEach(function(t){return e.stop(t.fileName)})},e}();t.SoundPlayer=i},,,,,,,,function(e,t,n){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Outlook="OUTLOOK",e.Scom="SCOM",e.Office="OFFICE"}(o=t.NotificationSupportedHost||(t.NotificationSupportedHost={})),function(e){e.All="ALL",e.Notification="NOTIFICATION",e.Off="OFF"}(i=t.NotificationAllowedValue||(t.NotificationAllowedValue={})),function(e){e.swc="swc",e.api="api"}(t.NotificationSettingSource||(t.NotificationSettingSource={})),function(e){e.IncomingCall="swc.notification.incoming-call",e.NewMessage="swc.notification.new-message"}(t.NotificationSettingType||(t.NotificationSettingType={})),t.NOTIFICATION_DEFAULT=[{host:o.Outlook,value:i.All},{host:o.Scom,value:i.All},{host:o.Office,value:i.All}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Calling="calling",e.Messaging="chat",e.Recents="recents"}(t.ModuleType||(t.ModuleType={}))},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(167))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(20);t.reportServiceFault=function(e,t,n){t=t||{};var r=i.NA;t.headers&&"function"==typeof t.headers.get&&(r=t.headers.get("contextid")||t.headers.get("X-Skype-Caller")||t.headers.get("X-Skype-Request-Id")),o.swc.Telemetry.sendEvent.serviceFault(e,t.status,t.statusText||t.message,o.swc.services.isZombie,t.url,r,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.callback=e,this.timeout=t}return e.prototype.start=function(){this.reset(),this.retryTimeout=setTimeout(this.callback,this.timeout)},e.prototype.reset=function(){this.retryTimeout&&clearTimeout(this.retryTimeout)},e}();t.FixedTimeout=o,t.build=function(e,t){return new o(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.reportUserActivityStart=function(){o.swc.services.signInManager.onceSignedIn().then(function(){return o.swc.Telemetry.sendEvent.userActivityStart()})}},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=function(){function e(){}return e.testOrigin=function(t){return e.origin!==t},e.post=function(t,n){try{e.targets[t].target.postMessage(n,e.targets[t].targetDomain)}catch(e){}},e.cast=function(t,n,o,i){var r={name:t,origin:e.origin,payload:n};o?Array.isArray(o)?o.forEach(function(t){return e.post(t,r)}):e.post(o,r):Object.keys(e.targets).forEach(function(t){return i!==e.targets[t].origin&&e.post(t,r)})},e.exists=function(t){return!!e.registry[t]},e.copy=function(t){t&&t.registry&&Object.getOwnPropertyNames(t.registry).forEach(function(n){var o=Object.getOwnPropertyDescriptor(t.registry,n);o&&o.writable&&(e.registry[n]=o.value||e.registry[n])})},e.addTarget=function(t,n,o,i){e.targets[t]=e.targets[t]||{target:i,origin:n,targetDomain:o}},e.removeTarget=function(t){delete e.targets[t]},e.connect=function(t){e.origin=e.origin||t,e.connected||(window.addEventListener("message",e.receiver),e.connected=!0)},e.disconnect=function(){window.removeEventListener("message",e.receiver),e.connected=!1},e.registerEvent=function(t,n){if(t&&n){var o=e.registry;if(o[t]){if(-1!==o[t].indexOf(n))return}else o[t]=[];o[t].push(n)}},e.unregisterEvent=function(t,n){if(t&&n){var o=e.registry;if(o[t]&&o[t].length){var i=o[t].indexOf(n);-1!==i&&o[t].splice(i,1)}}},e.secure=function(){o.swc.secured&&e.castBuffer()},e.castBuffer=function(){for(;e.buffer.length;){var t=e.buffer.pop();e.cast(t.name,t.payload,null,t.origin)}},e.triggerLocalEvent=function(t,n){return e.triggerEvent(t,n,!0,!1)},e.triggerEvent=function(t,n,o,i,r,s){void 0===i&&(i=!0),e.connected&&i&&e.cast(t,n,r,s);var a=!1,c=e.registry;return c[t]&&c[t].forEach(function(e){try{e(n),a=!0}catch(e){}}),a},e.dispose=function(){for(var t in e.registry)e.registry.hasOwnProperty(t)&&delete e.registry[t];e.disconnect()},e.buffer=[],e.targets={},e.receiver=function(t){var n=t.data;n&&n.origin&&e.testOrigin(n.origin)&&n.name&&e.triggerEvent(n.name,n.payload,!0,!0,null,n.origin)},e.registry={},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.Theme="data-theme",e.Locale="data-locale",e.SWC_Locale="swc-locale",e.SWC_ForceFrame="swc-force-frame",e.ID="data-id",e.BOT_ID="data-bot-id",e.CONTACT_ID="data-contact-id",e.PHONE_NUMBER="data-phone-number",e.CONTACT_EMAIL="data-contact-email",e.JOIN_LINK="data-join-link",e.THREAD_ID="data-thread-id",e.TOKEN="data-token",e.Payload="data-payload",e.BingDLApi="data-bing-dl-api",e.Title="data-title",e.Avatar="data-avatar",e.Prefill="data-prefill",e.PrivacyUri="data-privacy-uri",e.TermsOfUseUri="data-tou-uri",e.EnableCalling="data-enable-calling",e.CallingOnly="data-calling-only",e.DisableSendingEmoticons="data-disable-sending-emoticons",e.TrafficProvider="data-provider",e.TrafficSource="data-source",e.DisableInOutAnimation="data-disable-inout-animation",e.CorrelationId="data-correlation-id",e.SkypeOnly="data-skype-only",e.Style="data-style",e.DisableInput="data-disable-input",e.EnableParticipantsControl="data-enable-participants-control",e.InputPlaceholder="data-input-placeholder",e.ForceAuthentication="data-force-authentication",e.TitleColor="data-title-color",e.TitleBackground="data-title-background",e.PlatformFeature="data-platform-feature",e}();t.Attributes=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(t){this.Locale="",this.Theme="",this.Payload="",this.BingDLApi=!1,this.Title="",this.Avatar="",this.PrivacyUri="",this.TermsOfUseUri="",this.Prefill="",this.EnableCalling=null,this.CallingOnly=null,this.DisableSendingEmoticons=!1,this.TrafficProvider="",this.TrafficSource="",this.DisableInOutAnimation=!1,this.SkypeOnly=!1,this.Style="",this.DisableInput=!1,this.EnableParticipantsControl=!0,this.InputPlaceholder="",this.ForceAuthentication=!1,this.PlatformFeature="",this.TitleColor="",this.TitleBackground="",this.Partner="",t instanceof e&&Object.assign(this,t)}return e.prototype.MergeWith=function(e){if(e){var t=e;for(var n in t)t.hasOwnProperty(n)&&0!==n.indexOf("_")&&void 0!==t[n]&&null!==t[n]&&""!==t[n]&&(this[n]=t[n])}},e.prototype.MergeWithJSON=function(e){if(e)for(var t in e)void 0!==e[t]&&null!==e[t]&&""!==e[t]&&(this[t]=e[t])},e}();t.Definition=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.NONE="none",e.UIONLY="uionly",e.FULL="full",e.HIDDEN="hidden",e}();t.PreloadType=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(){var e=this;this.getDataPart=function(e){var t=e.substring(e.indexOf(".")+1);return t.substring(0,t.indexOf("."))},this.retrieveMeName=function(t){return t&&e.getTokenData(t).skypeid||""},this.getTokenData=function(t){return JSON.parse(atob(e.getDataPart(t)))}}}();t.TokenParser=o},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.alias=function(t,n,o,i){var r=e.pathToArray(n),s=r.pop(),a=e.build(r,o);return a[s]=i?t:a[s]||t},e.build=function(t,n){var o=n||window;return e.pathToArray(t).forEach(function(e){return o=o[e]=o[e]||{}}),o},e.pathToArray=function(e){return e instanceof Array?e:e.split(".")},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTelemetryConfigFromEcs=function(e){var t={};return e&&(e.trouterTenantId&&(t.trouter={ingestionKey:e.trouterTenantId}),e.ariaTenantId&&(t.default={ingestionKey:e.ariaTenantId}),e.ariaServicesTenantId&&(t.services={ingestionKey:e.ariaServicesTenantId})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.inject=function(e,t,n){var o=document.createElement("iframe");return o.setAttribute("allow","microphone; camera;"),o.setAttribute("frameborder","0"),o.setAttribute("seamless","seamless"),o.setAttribute("border-radius","6px"),o.setAttribute("allowFullScreen","true"),o.setAttribute("scrolling","no"),n&&(o.className=n),o.src=encodeURI(e),t?t.appendChild(o):document.body.appendChild(o),o},e.injectFrameless=function(t,n){var o=document.createElement("div");return o.innerHTML=e.templates[n],o=o.firstElementChild,t.appendChild(o),o},e.getFrameIndex=function(e){return Array.prototype.indexOf.call(window.frames,e)},e.templates={calling:'<div role="none" id="main-calling" class="swc frameless" style="display: none;"></div>',chat:'<div role="none" id="main" class="swc frameless main-component" style="display: none;"></div>',recentList:'<div role="none" id="main-recentlist" class="swc frameless swc-recents"></div>'},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(142),i=n(143),r=n(6),s=n(31),a=n(315),c=n(55),u=n(9),l=function(){function e(){}return e.prototype.parseBaseDom=function(e,t){var n=t.getAttribute(o.Attributes.ID);n&&(e.ConversationId=s.default.getNormalizeId(n));var i=t.getAttribute(o.Attributes.BOT_ID);i&&(e.ConversationId=s.default.getNormalizeId(i)),(i=t.getAttribute(o.Attributes.CONTACT_EMAIL))&&(e.ConversationId=i),(i=t.getAttribute(o.Attributes.PHONE_NUMBER))&&(e.ConversationId=s.default.getNormalizeId(i)),(i=t.getAttribute(o.Attributes.CONTACT_ID))&&(e.ConversationId=s.default.getNormalizeId(i)),(i=t.getAttribute(o.Attributes.THREAD_ID))&&(e.ConversationId=s.default.getNormalizeId(i)),(i=t.getAttribute(o.Attributes.JOIN_LINK))&&(e.ConversationId=i),(i=t.getAttribute(o.Attributes.TOKEN))&&(e.ConversationId=i),this.parseDom(e,o.Attributes,t)},e.prototype.parseDom=function(e,t,n){a.objectProperties(e,function(o){if(o&&t[o]&&n.getAttribute(t[o])){var i=n.getAttribute(t[o]);if(!i)return;"true"===i.toLowerCase()||"false"===i.toLowerCase()?e[o]=c.toBoolean(i):e[o]=i}})},e.prototype.setBaseDOM=function(e,t){if(this.setDom(e,o.Attributes,t),e.ConversationId){t.removeAttribute(o.Attributes.PHONE_NUMBER),t.removeAttribute(o.Attributes.CONTACT_ID),t.removeAttribute(o.Attributes.BOT_ID),t.removeAttribute(o.Attributes.JOIN_LINK);var n=s.default.detectConversationType(e.ConversationId);n===r.ConversationType.AGENT?t.setAttribute(o.Attributes.BOT_ID,s.default.getNormalizeId(e.ConversationId)):n===r.ConversationType.PERSON?t.setAttribute(o.Attributes.CONTACT_ID,s.default.getNormalizeId(e.ConversationId)):n===r.ConversationType.GROUP?t.setAttribute(o.Attributes.THREAD_ID,e.ConversationId):n===r.ConversationType.JOIN?t.setAttribute(o.Attributes.JOIN_LINK,e.ConversationId):n===r.ConversationType.PHONE?t.setAttribute(o.Attributes.PHONE_NUMBER,e.ConversationId):u.default.throwError(10002,"Unsupported conversation id:",null,e.ConversationId)}},e.prototype.setDom=function(e,t,n,o){a.objectProperties(e,function(i){if(void 0!==e[i]&&null!==e[i]&&""!==e[i]){var r=e[i];if("boolean"==typeof r&&(r=r.toString()),!t[i])return;if(o&&e[i]===o[i])return;n.setAttribute(t[i],r)}})},e.prototype.parseBaseUrlParams=function(e,t){t[o.Attributes.BOT_ID]?e.ConversationId=s.default.getNormalizeId(t[o.Attributes.BOT_ID]):t[o.Attributes.PHONE_NUMBER]?e.ConversationId=s.default.getNormalizeId(t[o.Attributes.PHONE_NUMBER]):t[o.Attributes.CONTACT_ID]?e.ConversationId=s.default.getNormalizeId(t[o.Attributes.CONTACT_ID]):t[o.Attributes.THREAD_ID]?e.ConversationId=s.default.getNormalizeId(t[o.Attributes.THREAD_ID]):t[o.Attributes.JOIN_LINK]?e.ConversationId=t[o.Attributes.JOIN_LINK]:t[o.Attributes.TOKEN]&&(e.ConversationId=t[o.Attributes.TOKEN]),t[o.Attributes.SWC_Locale]&&(e.Locale=t[o.Attributes.SWC_Locale]),t[o.Attributes.SWC_ForceFrame]&&(e.ForceFrame=c.toBoolean(t[o.Attributes.SWC_ForceFrame])),this.parseUrlParams(e,o.Attributes,t)},e.prototype.parseUrlParams=function(e,t,n){a.objectProperties(e,function(o){if(n[t[o]]){var i=n[t[o]];"true"===i.toLowerCase()||"false"===i.toLowerCase()?e[o]=c.toBoolean(i):e[o]=i}})},e.prototype.getQueryStringParameters=function(){var e=!1,t={};return window.location.search.substring(1).split("&").forEach(function(n){if(n){e=!0;var o=n.split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])||""}}),e?t:null},e.prototype.getDefinitionFromUrl=function(){var e=this.getQueryStringParameters(),t=new i.Definition;return e?(this.parseBaseUrlParams(t,e),this.parseUrlParams(t,o.Attributes,e),t):t},e}();t.ConfigFactory=l},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var n=e.call(this,t)||this;return n.CanClose=!0,n.CanUploadFile=!0,n.CanCollapse=!1,n.ShowHeader=!0,n.EnableTranslator=!1,n.ColorMain="",n.ColorMessage="",n.CssUrl="",n.Partner="",n.Preload="",n.Frameless=!1,n.EntryAnim=!0,n.GuestOnly=!1,n.WelcomeMessage="",n.DisableLogout=!1,n.IsVirtual=!1,n.EnableCustomOnCloseHandler=!1,n.CallStartMode="control",n.SessionId="",n.GroupWith="",n.HideSystemMessages="",n.MessageContentLimit="",n.PreventOpenChat=!1,n.HideMessageActionsMenu=!1,n.DisplayDeviceGuide=!0,n.DisableAvatarClickAction=!1,n}return i(t,e),t}(n(143).Definition);t.ChatDefinition=r},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(4),a=n(0),c=n(28),u=s.ApiEvents.conversationProxy;!function(e){e.Bridged="bridged",e.Unbridged="unbridged"}(t.DeliveryMode||(t.DeliveryMode={})),function(e){e[e.CONFIRMED=0]="CONFIRMED",e[e.CANCELED=1]="CANCELED"}(r=t.DialogResult||(t.DialogResult={}));var l=function(e){function t(t){var n=e.call(this,t)||this;return n.isInputDisabled=!1,n.dialogs={},n.actions={},n}return i(t,e),t.prototype.init=function(){this.conversationId=this.data.conversationId},t.prototype.sendMessageToBot=function(e){var t=this.createCID(),n={botId:this.conversationId,content:e,botMessageId:t},o=new Promise(function(e,n){var o=function(i){t===i.botMessageId&&(a.swc.Eventing.unregisterEvent(s.ApiEvents.invoke.sendMessageToBotResponse,o),i.success?e():n())};a.swc.Eventing.registerEvent(s.ApiEvents.invoke.sendMessageToBotResponse,o)});return this.exec(s.ApiEvents.invoke.sendMessageToBot,n),o},t.prototype.openEmoticonPicker=function(){this.isInputDisabled||this.exec(u.toggleEmoticonPicker,{id:this.conversationId,open:!0})},t.prototype.closeEmoticonPicker=function(){this.exec(u.toggleEmoticonPicker,{id:this.conversationId,open:!1})},t.prototype.openFilePicker=function(){this.exec(u.openFilePicker,this.conversationId)},t.prototype.setInputPlaceholder=function(e){this.exec(u.setInputPlaceholder,{id:this.conversationId,text:e})},t.prototype.setInputText=function(e){this.exec(u.setInputText,{id:this.conversationId,text:e})},t.prototype.setMessageProperties=function(e){var t={deliveryMode:e?e.deliveryMode:"",tags:e?e.tags:""};this.exec(u.setMessageProperties,{id:this.conversationId,props:t})},t.prototype.connect=function(){this.exec(u.connected,{id:this.conversationId,connected:!0})},t.prototype.disconnect=function(){this.exec(u.connected,{id:this.conversationId,connected:!1})},t.prototype.setActionBar=function(e){for(var t=this,n=[],o=0,i=e;o<i.length;o++){var r=i[o],s=this.createCID();this.actions[s]=r.handler,n.push({CID:s,name:r.name,className:r.className,title:r,text:r.text})}this.exec(u.setActionBar,{id:this.conversationId,definition:n}),this.reg(u.resActionBar,function(e){t.actions[e]&&t.actions[e]()})},t.prototype.showConfirmationDialog=function(e){var t=this,n=this.createCID();this.dialogs[n]=e;this.reg(u.resShowConfirmationDialog,function(e){t.resolveDialog(e.CID,e.res)}),this.exec(u.showConfirmationDialog,{id:this.conversationId,dialog:{CID:n,title:e.title,description:e.description,confirmationButtonTitle:e.confirmationButtonTitle,cancelButtonTitle:e.cancelButtonTitle}})},t.prototype.disableInput=function(){this.isInputDisabled=!0,this.exec(u.disableInput,{id:this.conversationId,disable:!0})},t.prototype.enableInput=function(){this.isInputDisabled=!1,this.exec(u.disableInput,{id:this.conversationId,disable:!1})},t.prototype.expand=function(){this.exec(u.expand,{id:this.conversationId})},t.prototype.focusInput=function(){this.exec(u.focusInput,{id:this.conversationId})},t.prototype.onUnreadCount=function(e){var t=this;this.exec(u.regUnreadCount,{id:this.conversationId,refId:this.refId}),this.reg(u.unreadCount,function(n){n.refId===t.refId&&e(n.count)})},t.prototype.onAvatar=function(e){var t=this;this.reg(u.resAvatar,function(n){n.refId===t.refId&&e(n.avatarUrl)}),this.exec(u.regAvatar,{id:this.conversationId,refId:this.refId})},t.prototype.onTitle=function(e){var t=this;this.reg(u.resTitle,function(n){n.refId===t.refId&&e(n.title)}),this.exec(u.regTitle,{id:this.conversationId,refId:this.refId})},t.prototype.onPresenceStatus=function(e){var t=this;this.reg(u.resPresenceStatus,function(n){n.refId===t.refId&&e(n.presenceStatus)}),this.exec(u.regPresenceStatus,{id:this.conversationId,refId:this.refId})},t.prototype.onCollapse=function(e,t){var n=this;this.exec(u.regCollapse,{id:this.conversationId,refId:this.refId,preventDefault:t}),this.reg(u.resCollapse,function(t){t.refId===n.refId&&e(t.isCollapsed)})},t.prototype.onMessageReceived=function(e){var t=this;this.exec(u.regMessageReceived,{id:this.conversationId,refId:this.refId}),this.reg(u.messageReceived,function(n){n.refId===t.refId&&e(n.message)})},t.prototype.onIsTyping=function(e){var t=this;this.exec(u.regIsTyping,{id:this.conversationId,refId:this.refId}),this.reg(u.resIsTyping,function(n){n.refId===t.refId&&e(n.isTyping)})},t.prototype.onFileDownload=function(e){var t=this;this.exec(u.regDownload,{id:this.conversationId,refId:this.refId}),this.reg(u.resDownload,function(n){n.refId===t.refId&&e(n.url)})},t.prototype.onClose=function(e,t){var n=this;this.exec(u.regClose,{refId:this.refId,preventDefault:t}),this.reg(u.resClose,function(t){t.refId===n.refId&&e()})},t.prototype.resolveDialog=function(e,t){var n=this.dialogs[e];n&&(t===r.CONFIRMED?n.onConfirm():n.onCancel(),delete this.dialogs[e])},t}(c.Proxy);t.ConversationProxy=l},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=n(28),a=r.ApiEvents.presenceProxy;t.ME="ME";var c=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.subscriptions={},t.announceUserStatus=function(e){t.subscriptions[e.userId]&&t.subscriptions[e.userId].forEach(function(t){t(e.status)})},t}return i(n,e),n.prototype.init=function(){var e=this;this.reg(a.announceUserStatus,function(t){return e.announceUserStatus(t)})},n.prototype.setMyStatus=function(e){var t=this;return new Promise(function(n,o){var i=function(e){e.status?n():o("Failed to set status"),t.unreg(a.getUserStatusResponse,i)};t.reg(a.setStatusResponse,i),t.exec(a.setStatus,e)})},n.prototype.getMyStatus=function(){var e=this;return new Promise(function(t,n){e.reg(a.getStatusResponse,function(e){t(e)}),e.exec(a.getStatus)})},n.prototype.getStatusList=function(){var e=this;return new Promise(function(t,n){var o=function(n){t(n),e.unreg(a.getStatusListResponse,o)};e.reg(a.getStatusListResponse,o),e.exec(a.getStatusList)})},n.prototype.getUserStatus=function(e){var t=this;return new Promise(function(n,o){var i=function(o){e===o.userId&&(n(o.status),t.unreg(a.getUserStatusResponse,i))};t.reg(a.getUserStatusResponse,i),t.exec(a.getUserStatus,e)})},n.prototype.subscribeToUserStatus=function(e,t){this.subscriptions[e]||(this.subscriptions[e]=[]),this.subscriptions[e].push(t),this.exec(a.subscribeToUserStatus,e)},n.prototype.unsubscribeFromUserStatus=function(e,t){this.subscriptions[e]&&(this.subscriptions[e]=this.subscriptions[e].filter(function(e){return e!==t}),this.exec(a.unsubscribeFromUserStatus,e))},n.prototype.subscribeToMyStatus=function(e){this.subscriptions[t.ME]||(this.subscriptions[t.ME]=[]),this.subscriptions[t.ME].push(e),this.exec(a.subscribeToUserStatus,t.ME)},n}(s.Proxy);t.PresenceProxy=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Skype="skype",e.Aad="aad"}(t.TokenType||(t.TokenType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=this;this.execCallback=function(){if(n._callback){var e=n.reset.bind(n);return n._callback().then(e,e)}return n.reset(),Promise.resolve()},this.reset=function(){n._callback=null,n._toRelogin=!1},this.setContext(e,t)}return e.prototype.setContext=function(e,t){this._toRelogin=e,this._callback=t},Object.defineProperty(e.prototype,"canRelogin",{get:function(){return this._toRelogin},enumerable:!0,configurable:!0}),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.Cache=10]="Cache",e[e.SilentLogin=20]="SilentLogin",e[e.Popup=30]="Popup",e[e.Guest=40]="Guest",e[e.UserLogout=50]="UserLogout",e[e.External=60]="External",e[e.WX=70]="WX",e[e.AAD=80]="AAD"}(t.AuthSource||(t.AuthSource={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(23),r={retryCount:3,timeout:12e4,policy:""},s=function(){function e(){}return e.exchangeForSkypeToken=function(e){var t={method:"post",headers:{Authorization:e,"x-ms-client-type":"web","x-ms-user-type":"user"}};return i.default("teams-exchange",r,o.Configuration.TEAMS_AUTH_URL+"/authz",t)},e.fetchGuestTokenForTenant=function(e){var t={method:"post",body:JSON.stringify({tenantId:e})};return i.default("teams-anonymout",r,o.Configuration.TEAMS_AUTH_URL+"/authz/visitor",t)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(23),r={retryCount:3,timeout:12e4,policy:""};t.getGuestToken=function(e){var t={name:e};return new Promise(function(e,n){(function(e,t,n){var s={};s.method=e,s.body=JSON.stringify(n);var a=new Headers;return a.append("Content-Type","application/json"),a.append("X-Skype-Caller",o.Configuration.getUiVersion()),s.headers=a,i.default("scom-invite",r,o.Configuration.INVITE_HOST_URL+t,s)})("POST","users/guests/lwc",t).then(function(t){t.json().then(function(t){e(t)}).catch(function(e){n(e)})},function(e){n(e)})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.isRelogin=!1}return e.prototype.reset=function(){this.isRelogin=!1,this.signoutPromise=null},e}();t.default=o},function(e,t){!function(){"use strict";var e,t,n,o,i,r,s,a,c,u,l,d,p,f,h,g,v,m,y;void 0===window.SKYPE&&(window.SKYPE={}),window.SKYPE.login=window.SKYPE.login||{},window.SKYPE.login.Silent=(n={qa:"https://a.qa.lw.skype.net",live:"https://a.lw.skype.com"},o=null,i={},r=null,s=null,a="",c=!1,u=!1,l=null,d={env:"live",client_id:null,redirect_uri:null},p=function(e,t){if(null===l&&(l=window.location.host.match(/^(pre|dev|qa).*\.net$/)||document.cookie.indexOf("debug")>-1||window.location.search.indexOf("debug")>-1),l)try{if("object"==typeof t){var n=[];for(var o in t)"skypetoken"===o?n.push(o+": <HIDDEN>"):n.push(o+": "+JSON.stringify(t[o]));e+=" - "+n.join(", ")}else"string"==typeof t&&(e+=" - "+t);e="[silentlogin.js] - "+e}catch(e){}},f=function(e){if(p("Received message from "+e.origin),s&&e.origin===s){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){}p("Message data",t);var n=t.state||null;if(a===n){for(var o in window.clearTimeout(r),i={},t)t.hasOwnProperty(o)&&(i[o]=t[o]);g()}else p("State "+n+" doesn't match the last submitted state "+a)}},h=function(){o&&(e.removeChild(o),o=null)},g=function(){p("Calling callback function",i),u=!1,"function"==typeof t&&t(i)},v=function(){h(),(i={}).error="timeout",g()},m=function(){var e=(new Date).getTime(),t=n;a="silentloginsdk_"+e;var o={response_type:"postmessage",client_id:d.client_id,partner:"999",redirect_uri:d.redirect_uri,state:a,_accept:"1.0",_nc:e};return(s=t[d.env]||t.live)+"/login/silent?"+function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}(o)},{init:function(e){if("object"==typeof e)for(var t in(e=e||{}).hasOwnProperty("callback")&&y(e.callback),d)e.hasOwnProperty(t)&&(d[t]=e[t]);return c||(c=!0,window.addEventListener?window.addEventListener("message",f,!1):window.attachEvent("onmessage",f)),this},setCallback:y=function(e){return"function"==typeof e&&(t=e),this},load:function(){if(!u){if(function(){if(!d.client_id)throw"[silentlogin.js] client_id not initialized. Call init() first.";d.redirect_uri||(d.redirect_uri=window.location.protocol+"//"+window.location.host+window.location.pathname)}(),u=!0,!("postMessage"in window&&"object"==typeof JSON&&JSON.parse))return i={error:"unsupported_browser"},void g();var t;window.clearTimeout(r),r=window.setTimeout(v,2e4),t=m(),h(),void 0===e&&(e=document.body||document.head||document.getElementsByTagName("head")[0]),(o=document.createElement("iframe")).frameBorder=0,o.width="1px",o.height="1px",o.style.display="none",o.style.visibility="hidden",o.id="silentLoginFrame"+Math.floor(10*Math.random()+1),o.setAttribute("src",t),e.appendChild(o),p("Created iFrame: "+t)}},getSkypetoken:function(){return i.skypetoken||null},getFullResponse:function(){return i}})}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(175);t.TeamsUserPolicyService=o.TeamsUserPolicyService},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(176),r=n(178),s=function(){function e(e,t){this.aadTokenProvider=e,this.cache=t,this._storedSettings={},this._defaultSettingsService=new i.DefaultUserPolicyService,this._requestPromises={}}return e.prototype.getMessagingPolicy=function(){return this._getSettings("messagingPolicy")},e.prototype.getCallingPolicy=function(){return this._getSettings("callingPolicy")},e.prototype.getUserPolicies=function(){return this._getSettings("policySettings")},e.prototype.getUpgradePolicy=function(){var e=this;if(this._storedUpgradePolicy)return Promise.resolve(this._storedUpgradePolicy);var t=this.cache.get("teamsUpgradePolicy");return t?(this._storedUpgradePolicy=t,Promise.resolve(t)):this._fetchTeamsUpgradePolicy().then(function(t){return e._storedUpgradePolicy=t,e.cache.set("teamsUpgradePolicy",t),t})},e.prototype._getSettings=function(e){var t=this,n=this._getStoredSettings(e);return n?Promise.resolve(n):this._fetchSettings(e).then(function(n){return n?(t._storeSettings(e,n),n):t._getDefaultSettings(e)})},e.prototype._getStoredSettings=function(e){if(!this._storedSettings[e]){var t=this.cache.get(e);t&&(this._storedSettings[e]=t)}return this._storedSettings[e]},e.prototype._storeSettings=function(e,t){this.cache.set(e,t),this._storedSettings[e]=t},e.prototype._fetchSettings=function(e){var t,n=this;if(!this._requestPromises[e]){var i=o.Configuration.TEAMS_PROFILE_URL+"api/mt/amer/beta/users/useraggregatesettings",s=((t={})[e]=!0,t);this._requestPromises[e]=r.post("useraggregatesettings",i,JSON.stringify(s),this.aadTokenProvider).then(function(t){var o=t[e];return delete n._requestPromises[e],o.value}).catch(function(){delete n._requestPromises[e]})}return this._requestPromises[e]},e.prototype._fetchTeamsUpgradePolicy=function(){var e=o.Configuration.TEAMS_PROFILE_URL+"api/mt/amer/beta/me/settings/teamsupgradev2";return r.get("useraggregatesettings",e,this.aadTokenProvider).then(function(e){return e.value})},e.prototype._getDefaultSettings=function(e){return this._defaultSettingsService.getDefaultPolicy(e)},e}();t.TeamsUserPolicyService=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(177),i=function(){function e(){this._defaultPolicy={messagingPolicy:{allowOwnerEditMessage:!1,allowOwnerDeleteMessage:!1,allowUserEditMessage:!1,allowUserDeleteMessage:!1,allowUserChat:!1,allowGiphy:!1,allowUserTranslation:!1,giphyRatingType:o.GiphyRatingType.Strict,allowMemes:!1,allowStickers:!1,readReceiptsEnabledType:o.ReadReceiptsEnabledType.None},callingPolicy:{allowPrivateCalling:!1,allowGroupCalling:!1,allowCallForwarding:!1,allowCallForwardingToPhone:!1,allowCallForwardingToUser:!1,allowCallGroups:!1,allowDelegation:!1,allowVoicemail:"AlwaysDisabled"}}}return e.prototype.getDefaultPolicy=function(e){return this._defaultPolicy[e]},e}();t.DefaultUserPolicyService=i},function(e,t,n){"use strict";var o,i,r,s,a,c,u,l,d,p,f,h;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Strict=0]="Strict",e[e.Moderate=1]="Moderate",e[e.NoRestriction=2]="NoRestriction"}(t.GiphyRatingType||(t.GiphyRatingType={})),function(e){e.Everyone="Everyone",e.None="None",e.UserPreference="UserPreference"}(t.ReadReceiptsEnabledType||(t.ReadReceiptsEnabledType={})),function(e){e[e.Success=0]="Success",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidArguments=1]="InvalidArguments",e[e.AccessDenied=2]="AccessDenied",e[e.BadRequest=3]="BadRequest",e[e.Forbidden=4]="Forbidden",e[e.GatewayTimeout=5]="GatewayTimeout",e[e.NotFound=6]="NotFound",e[e.SharepointSiteNotExists=7]="SharepointSiteNotExists",e[e.UserNotFound=8]="UserNotFound",e[e.UserNotFoundInSkypeTeam=9]="UserNotFoundInSkypeTeam",e[e.GroupExceededMaxSupportedNestedGroups=10]="GroupExceededMaxSupportedNestedGroups",e[e.GroupExceededMaxSupportedTeamMembers=11]="GroupExceededMaxSupportedTeamMembers",e[e.TeamNotFound=12]="TeamNotFound",e[e.ThreadNotFound=13]="ThreadNotFound",e[e.TeamOwnerNotFound=14]="TeamOwnerNotFound",e[e.TeamGroupIdMissing=15]="TeamGroupIdMissing",e[e.ChannelsRosterFailed=16]="ChannelsRosterFailed",e[e.MaxChannelLimitExceeded=17]="MaxChannelLimitExceeded",e[e.FileDoesNotExist=18]="FileDoesNotExist",e[e.FileLocked=19]="FileLocked",e[e.OneNoteNotAvailable=20]="OneNoteNotAvailable",e[e.GetPersonalSiteUrlError=21]="GetPersonalSiteUrlError",e[e.NotesSectionCreationError=22]="NotesSectionCreationError",e[e.GroupNotesStartedButNotFinishedYet=23]="GroupNotesStartedButNotFinishedYet",e[e.MissingTeamSmtpAddress=24]="MissingTeamSmtpAddress",e[e.UpdateTeamMembershipInExchangeFailed=25]="UpdateTeamMembershipInExchangeFailed",e[e.UpdateTeamMembershipInSkypeFailed=26]="UpdateTeamMembershipInSkypeFailed",e[e.UpdateBotTeamMembershipInSkypeFailed=27]="UpdateBotTeamMembershipInSkypeFailed",e[e.UpdateTeamMembershipFailed=28]="UpdateTeamMembershipFailed",e[e.ChannelThreadNotExist=29]="ChannelThreadNotExist",e[e.ChannelNameAlreadyExist=30]="ChannelNameAlreadyExist",e[e.MaxChannelNameCharacterLimitExceeded=31]="MaxChannelNameCharacterLimitExceeded",e[e.MaxChannelDescriptionCharacterLimitExceeded=32]="MaxChannelDescriptionCharacterLimitExceeded",e[e.MaxTeamNameCharacterLimitExceeded=33]="MaxTeamNameCharacterLimitExceeded",e[e.MaxTeamDescriptionCharacterLimitExceeded=34]="MaxTeamDescriptionCharacterLimitExceeded",e[e.InvalidTeamName=35]="InvalidTeamName",e[e.UserIsNotOwnerToPerformMigration=36]="UserIsNotOwnerToPerformMigration",e[e.GroupHasMoreMemberThanSkypeTeamsSupports=37]="GroupHasMoreMemberThanSkypeTeamsSupports",e[e.InvalidChannelName=38]="InvalidChannelName",e[e.UpdateChannelNameFailed=39]="UpdateChannelNameFailed",e[e.UpdateChannelDescriptionFailed=40]="UpdateChannelDescriptionFailed",e[e.ChannelNameUpdateToTeamThreadFailed=41]="ChannelNameUpdateToTeamThreadFailed",e[e.CreateChannelThreadFailed=42]="CreateChannelThreadFailed",e[e.CreateChatThreadFailed=43]="CreateChatThreadFailed",e[e.NotAbleToGetChannelThreadAfterCreating=44]="NotAbleToGetChannelThreadAfterCreating",e[e.DeleteChannelThreadFailed=45]="DeleteChannelThreadFailed",e[e.UnableToFetchTeamThread=46]="UnableToFetchTeamThread",e[e.GetUnifiedGroupMembersInExchangeFailed=47]="GetUnifiedGroupMembersInExchangeFailed",e[e.NotImplemented=48]="NotImplemented",e[e.CreateTeamInExchangeNotAuthorized=49]="CreateTeamInExchangeNotAuthorized",e[e.CreateTeamInSkypeFailed=50]="CreateTeamInSkypeFailed",e[e.CreateTeamInExchangeFailed=51]="CreateTeamInExchangeFailed",e[e.UnableToGenerateUniqueAlias=52]="UnableToGenerateUniqueAlias",e[e.TeamCreationInProgress=53]="TeamCreationInProgress",e[e.UpdateTeamInSkypeFailed=54]="UpdateTeamInSkypeFailed",e[e.UpdateTeamInExchangeFailed=55]="UpdateTeamInExchangeFailed",e[e.DeleteTeamNotAuthorized=56]="DeleteTeamNotAuthorized",e[e.DeleteTeamFailedChannelNotFound=57]="DeleteTeamFailedChannelNotFound",e[e.DeleteTeamFailedSettingTopicsProperty=58]="DeleteTeamFailedSettingTopicsProperty",e[e.DeleteTeamFailedRemovingInitiator=59]="DeleteTeamFailedRemovingInitiator",e[e.DeletingTeamInExchangeFailed=60]="DeletingTeamInExchangeFailed",e[e.DeletingTeamInSkypeFailed=61]="DeletingTeamInSkypeFailed",e[e.DeletingTeamSettingStatusPropertyFailed=62]="DeletingTeamSettingStatusPropertyFailed",e[e.AadGetUserCallFailed=63]="AadGetUserCallFailed",e[e.AadUserSearchCallFailed=64]="AadUserSearchCallFailed",e[e.AadGroupsSearchCallFailed=65]="AadGroupsSearchCallFailed",e[e.AadGroupMembersCallFailed=66]="AadGroupMembersCallFailed",e[e.AadGetProfilePictureCallFailed=67]="AadGetProfilePictureCallFailed",e[e.ChatProfilePictureCallFailed=68]="ChatProfilePictureCallFailed",e[e.ExchangeGetProfilePictureCallFailed=69]="ExchangeGetProfilePictureCallFailed",e[e.ExchangeSetProfilePictureCallFailed=70]="ExchangeSetProfilePictureCallFailed",e[e.ExchangeFindPeopleCallFailed=71]="ExchangeFindPeopleCallFailed",e[e.ExchangeInvalidLicense=72]="ExchangeInvalidLicense",e[e.ErrorNonExistentMailbox=73]="ErrorNonExistentMailbox",e[e.ExchangeAccessDenied=74]="ExchangeAccessDenied",e[e.ExchangeOrganizationAccessBlocked=75]="ExchangeOrganizationAccessBlocked",e[e.OrgChartGetManagerAadCallFailed=76]="OrgChartGetManagerAadCallFailed",e[e.JsonResponseParsingFailed=77]="JsonResponseParsingFailed",e[e.GetMyPropertiesFailed=78]="GetMyPropertiesFailed",e[e.GetUserPropertiesFailed=79]="GetUserPropertiesFailed",e[e.SetMyPropertyFailed=80]="SetMyPropertyFailed",e[e.ReconcileExchangeTeamStatusInvalid=81]="ReconcileExchangeTeamStatusInvalid",e[e.ReconcileExchangeTeamFailed=82]="ReconcileExchangeTeamFailed",e[e.MaximumTeamMembersLimitReached=83]="MaximumTeamMembersLimitReached",e[e.MaximumTeamOwnersLimitReached=84]="MaximumTeamOwnersLimitReached",e[e.MemberIsNotAdminToPerformOperation=85]="MemberIsNotAdminToPerformOperation",e[e.OperationDeniedAsMemberIsLastMemberInTeam=86]="OperationDeniedAsMemberIsLastMemberInTeam",e[e.OperationDeniedAsMemberIsLastAdminInTeam=87]="OperationDeniedAsMemberIsLastAdminInTeam",e[e.MSGraphRequestThrottled=88]="MSGraphRequestThrottled",e[e.MSGraphGetGroupWithFilterFailed=89]="MSGraphGetGroupWithFilterFailed",e[e.MSGraphGetGroupMembersFailed=90]="MSGraphGetGroupMembersFailed",e[e.MSGraphGetGroupOwnersFailed=91]="MSGraphGetGroupOwnersFailed",e[e.MSGraphAddGroupMemberFailed=92]="MSGraphAddGroupMemberFailed",e[e.MSGraphAddGroupOwnerFailed=93]="MSGraphAddGroupOwnerFailed",e[e.GroupOwnersLimitExceeded=94]="GroupOwnersLimitExceeded",e[e.MSGraphRemoveGroupMemberFailed=95]="MSGraphRemoveGroupMemberFailed",e[e.MSGraphRemoveGroupOwnerFailed=96]="MSGraphRemoveGroupOwnerFailed",e[e.MSGraphGetGroupUsersFailed=97]="MSGraphGetGroupUsersFailed",e[e.ExchangeTeamNotProvisionedGroupIdMissing=98]="ExchangeTeamNotProvisionedGroupIdMissing",e[e.ThreadIsNotSpaceOrTopic=99]="ThreadIsNotSpaceOrTopic",e[e.ThreadUpgradeForTopicThreadFailed=100]="ThreadUpgradeForTopicThreadFailed",e[e.ThreadUpgradeForSpaceThreadFailed=101]="ThreadUpgradeForSpaceThreadFailed",e[e.ThreadUpgradeFailedCalledOnWrongObject=102]="ThreadUpgradeFailedCalledOnWrongObject",e[e.ConversationUpgradeForSpaceThreadFailed=103]="ConversationUpgradeForSpaceThreadFailed",e[e.ConversationUpgradeFailedCalledOnWrongObject=104]="ConversationUpgradeFailedCalledOnWrongObject",e[e.ConversationUpgradeFailedToSetUserSubscriberState=105]="ConversationUpgradeFailedToSetUserSubscriberState",e[e.InvalidUserId=106]="InvalidUserId",e[e.AadGroupCreationLimitExceeded=107]="AadGroupCreationLimitExceeded",e[e.MsGraphReplicationUnavailable=108]="MsGraphReplicationUnavailable",e[e.SkypeTeamCreationFailed=109]="SkypeTeamCreationFailed",e[e.MigratingToSkypeTeamFailed=110]="MigratingToSkypeTeamFailed",e[e.AadGroupDeletionFailed=111]="AadGroupDeletionFailed",e[e.AadGetUserGroupsFailed=112]="AadGetUserGroupsFailed",e[e.AadGetUserGroupsFailedMailboxTemporaryUnavailable=113]="AadGetUserGroupsFailedMailboxTemporaryUnavailable",e[e.AadGetGroupMembersFailed=114]="AadGetGroupMembersFailed",e[e.AadGetGroupOwnersFailed=115]="AadGetGroupOwnersFailed",e[e.AadSmtpAddressMissing=116]="AadSmtpAddressMissing",e[e.GetTeamMembersFailed=117]="GetTeamMembersFailed",e[e.BotNotFound=118]="BotNotFound",e[e.BotsNotSupportedInChannels=119]="BotsNotSupportedInChannels",e[e.UpdateBotRoleNotSupported=120]="UpdateBotRoleNotSupported",e[e.GetPeopleFailed=121]="GetPeopleFailed",e[e.GetSuggestedGroupsFromExchangeFailed=122]="GetSuggestedGroupsFromExchangeFailed",e[e.GetAllGroupsFailed=123]="GetAllGroupsFailed",e[e.FindingGroupsFailed=124]="FindingGroupsFailed",e[e.FeatureDisabled=125]="FeatureDisabled",e[e.SkypeTeamsStoreAreSkypeTeamsFailed=126]="SkypeTeamsStoreAreSkypeTeamsFailed",e[e.ExchangeMailboxTemporaryUnavailable=127]="ExchangeMailboxTemporaryUnavailable",e[e.GetTenantSettingsFailed=128]="GetTenantSettingsFailed",e[e.SetTenantSettingsFailed=129]="SetTenantSettingsFailed",e[e.InvalidEndDateInRecurrence=130]="InvalidEndDateInRecurrence",e[e.InvalidPatternPropertiesInRecurrence=131]="InvalidPatternPropertiesInRecurrence",e[e.MissingCorrectRecurrencePatternObject=132]="MissingCorrectRecurrencePatternObject",e[e.CalendarEventCreationFailedInExchange=133]="CalendarEventCreationFailedInExchange",e[e.CalendarEventDeletionFailedInExchange=134]="CalendarEventDeletionFailedInExchange",e[e.CalendarEventCancellationFailedInExchange=135]="CalendarEventCancellationFailedInExchange",e[e.CalendarEventUpdateFailedInExchange=136]="CalendarEventUpdateFailedInExchange",e[e.InvalidCancelEventRequest=137]="InvalidCancelEventRequest",e[e.CalendarEventRespondFailure=138]="CalendarEventRespondFailure",e[e.SharepointResponseFailure=139]="SharepointResponseFailure",e[e.DeepLinkTypeNotSupported=140]="DeepLinkTypeNotSupported",e[e.DocumentLibraryNotFound=141]="DocumentLibraryNotFound",e[e.DocumentLibrarySettingsNotFound=142]="DocumentLibrarySettingsNotFound",e[e.UserMailboxDoesNotExist=143]="UserMailboxDoesNotExist",e[e.TaskCanceled=144]="TaskCanceled",e[e.CalendarEventNotFound=145]="CalendarEventNotFound",e[e.GetTeamOutgoingWebhooksFailed=146]="GetTeamOutgoingWebhooksFailed",e[e.SetTeamOutgoingWebhooksFailed=147]="SetTeamOutgoingWebhooksFailed",e[e.RemoveTeamOutgoingWebhookFailed=148]="RemoveTeamOutgoingWebhookFailed",e[e.GetOutgoingWebhookConfigurationFailed=149]="GetOutgoingWebhookConfigurationFailed",e[e.SetOutgoingWebhookConfigurationFailed=150]="SetOutgoingWebhookConfigurationFailed",e[e.GetEmailAddressDetailsFailed=151]="GetEmailAddressDetailsFailed",e[e.GetChannelSettingsFailed=152]="GetChannelSettingsFailed",e[e.ProvisionEmailAddressFailed=153]="ProvisionEmailAddressFailed",e[e.EmailAddressAlreadyProvisioned=154]="EmailAddressAlreadyProvisioned",e[e.TeamCachedPropertiesNotFound=155]="TeamCachedPropertiesNotFound",e[e.GetTeamAppEntitlementsFailed=156]="GetTeamAppEntitlementsFailed",e[e.SetTeamAppEntitlementFailed=157]="SetTeamAppEntitlementFailed",e[e.RemoveTeamAppEntitlementFailed=158]="RemoveTeamAppEntitlementFailed",e[e.GetUserAppEntitlementsFailed=159]="GetUserAppEntitlementsFailed",e[e.SetUserAppEntitlementFailed=160]="SetUserAppEntitlementFailed",e[e.RemoveUserAppEntitlementFailed=161]="RemoveUserAppEntitlementFailed",e[e.GetTeamAppDefinitionsFailed=162]="GetTeamAppDefinitionsFailed",e[e.SetTeamAppDefinitionFailed=163]="SetTeamAppDefinitionFailed",e[e.RemoveTeamAppDefinitionFailed=164]="RemoveTeamAppDefinitionFailed",e[e.GetUserAppDefinitionsFailed=165]="GetUserAppDefinitionsFailed",e[e.SetUserAppDefinitionFailed=166]="SetUserAppDefinitionFailed",e[e.RemoveUserAppDefinitionFailed=167]="RemoveUserAppDefinitionFailed",e[e.GetAppDefinitionFailed=168]="GetAppDefinitionFailed",e[e.UserAlreadyExists=169]="UserAlreadyExists",e[e.UserAlreadyExistsInTeam=170]="UserAlreadyExistsInTeam"}(i||(i={})),function(e){e[e.RequiredOutsideScheduleMeeting=0]="RequiredOutsideScheduleMeeting",e[e.NotRequired=1]="NotRequired",e[e.AlwaysRequired=2]="AlwaysRequired"}(r||(r={})),function(e){e[e.Immediate=0]="Immediate",e[e.Simultaneous=1]="Simultaneous"}(s||(s={})),function(e){e[e.Voicemail=0]="Voicemail",e[e.SingleTarget=1]="SingleTarget",e[e.MyDelegates=2]="MyDelegates"}(a||(a={})),function(e){e[e.Regular=0]="Regular",e[e.CallQueue=1]="CallQueue",e[e.CallGroup=2]="CallGroup",e[e.Delegate=3]="Delegate"}(c||(c={})),function(e){e[e.Ring=0]="Ring",e[e.Bop=1]="Bop",e[e.Bounce=2]="Bounce",e[e.Bubbles=3]="Bubbles",e[e.DripDrop=4]="DripDrop",e[e.Eureka=5]="Eureka",e[e.Flutter=6]="Flutter",e[e.HighScore=7]="HighScore",e[e.NextLevel=8]="NextLevel",e[e.Plink=9]="Plink",e[e.RingRing=10]="RingRing",e[e.Ripple=11]="Ripple",e[e.Spacetime=12]="Spacetime",e[e.WishGranted=13]="WishGranted",e[e.Wobble=14]="Wobble"}(u||(u={})),function(e){e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.OnPrem=2]="OnPrem"}(l||(l={})),function(e){e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.OnPrem=2]="OnPrem"}(d||(d={})),function(e){e[e.Default=0]="Default",e[e.Immediately=1]="Immediately",e[e.Every10Mins=2]="Every10Mins",e[e.Hourly=3]="Hourly",e[e.EveryEightHours=4]="EveryEightHours",e[e.Daily=5]="Daily",e[e.Never=6]="Never"}(p||(p={})),function(e){e[e.All=0]="All",e[e.CallMentionChats=1]="CallMentionChats",e[e.Off=2]="Off"}(f||(f={})),function(e){e[e.Unknown=0]="Unknown",e[e.Teacher=1]="Teacher",e[e.Student=2]="Student"}(h||(h={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(60),r=n(23),s={retryCount:3,timeout:12e4,policy:""},a=function(e,t,n){return r.default("teamsmiddleware-"+e,s,t,n)};t.post=function(e,n,o,i){return t.getHeaders(i).then(function(t){return a(e,n,{method:"POST",cache:"no-cache",headers:t,body:o}).then(function(e){return e.json()})})},t.get=function(e,n,o){return t.getHeaders(o).then(function(t){return a(e,n,{method:"GET",cache:"no-cache",headers:t}).then(function(e){return e.json()})})},t.getHeaders=function(e){return e(i.AadAudience.SpacesApi).then(function(e){return e=0===e.toLowerCase().indexOf("bearer")?e:"Bearer "+e,new Headers({Authorization:e,"x-skype-client":o.Configuration.getClientVersion(),Accept:"application/json","Content-Type":"application/json"})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.username=e;try{this.storage=window.localStorage}catch(e){}}return e.prototype.isValid=function(e){return e.username===this.username&&e.expiresAt>Date.now()},e.prototype.get=function(e){try{var t=JSON.parse(this.storage.getItem(e));if(t&&this.isValid(t))return t.value;this.storage.removeItem(e)}catch(e){}},e.prototype.set=function(e,t,n){void 0===n&&(n=864e5);var o={username:this.username,expiresAt:Date.now()+n,value:t};try{this.storage.setItem(e,JSON.stringify(o))}catch(e){}},e}();t.LocalCacheStorage=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(){this.skypeLogo=n(181),this.iconSkype=n(182),this.iconLogoMicrosoft=n(183),this.iconDock=n(184),this.iconUndock=n(185),this.iconChats=n(186)}}();t.SVG=new o},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 80">\r\n    <path d="M90 57.3v-4.9c.6.5 1.2.9 2 1.3s1.6.7 2.5 1c.9.3 1.7.5 2.6.6.9.1 1.7.2 2.4.2 2.5 0 4.4-.5 5.7-1.4 1.3-.9 1.9-2.3 1.9-4.1 0-1-.2-1.8-.6-2.5-.4-.7-1-1.4-1.7-1.9-.7-.6-1.6-1.1-2.6-1.7-1-.5-2.1-1.1-3.2-1.7-1.2-.6-2.4-1.3-3.4-1.9-1.1-.6-2-1.3-2.8-2.1-.8-.8-1.4-1.6-1.9-2.6s-.7-2.1-.7-3.4c0-1.6.4-3 1.1-4.2.7-1.2 1.6-2.2 2.8-2.9 1.1-.8 2.4-1.3 3.9-1.7 1.5-.4 3-.6 4.5-.6 3.5 0 6 .4 7.6 1.3v4.7c-2.1-1.4-4.7-2.2-8-2.2-.9 0-1.8.1-2.7.3-.9.2-1.7.5-2.4.9s-1.3 1-1.7 1.7c-.4.7-.7 1.5-.7 2.5 0 .9.2 1.7.5 2.3.3.7.8 1.3 1.5 1.8s1.5 1.1 2.4 1.6c.9.5 2 1.1 3.2 1.7 1.3.6 2.5 1.3 3.6 2s2.1 1.5 3 2.3c.9.8 1.5 1.8 2 2.8.5 1 .7 2.2.7 3.5 0 1.7-.3 3.2-1 4.4-.7 1.2-1.6 2.2-2.7 2.9-1.2.8-2.5 1.3-4 1.6-1.5.3-3.1.5-4.8.5-.6 0-1.2 0-2.1-.1-.8-.1-1.7-.2-2.5-.4s-1.7-.4-2.4-.6c-1-.4-1.6-.7-2-1m45.7 1.4H130l-11-12.1h-.1v12.1h-4.1V21.3h4.1V45h.1l10.5-11.6h5.3l-11.7 12.2zm23.7-25.3l-11.5 29.3c-2.1 5.2-5 7.8-8.7 7.8-1 0-1.9-.1-2.6-.3v-3.6c.9.3 1.7.4 2.4.4 2 0 3.5-1.2 4.6-3.6l2-4.8-9.8-25.2h4.5l6.8 19.4c.1.2.3.9.5 1.9h.1c.1-.4.2-1 .5-1.9l7.1-19.5h4.1zm6.3 11.5v3.5c0 2.1.7 3.9 2 5.3 1.4 1.5 3.1 2.2 5.1 2.2 2.4 0 4.3-.9 5.7-2.8 1.4-1.9 2.1-4.5 2.1-7.8 0-2.8-.6-5-1.9-6.6-1.3-1.6-3-2.4-5.2-2.4-2.3 0-4.2.8-5.6 2.5-1.5 1.5-2.2 3.6-2.2 6.1m.1 10.1l-.1 15.3h-4V33.4h4v4.4h.1c2-3.4 4.9-5 8.7-5 3.2 0 5.8 1.1 7.6 3.4 1.8 2.3 2.7 5.3 2.7 9.1 0 4.2-1 7.6-3.1 10.1-2 2.5-4.8 3.8-8.4 3.8-3.2.1-5.8-1.3-7.5-4.2M205 43.7c0-2.3-.6-4.2-1.7-5.5-1.1-1.3-2.6-1.9-4.6-1.9-1.9 0-3.5.7-4.8 2-1.3 1.4-2.1 3.1-2.5 5.4H205zm4.1 3.4h-17.7c.1 2.8.8 5 2.3 6.5 1.4 1.5 3.4 2.3 5.9 2.3 2.8 0 5.4-.9 7.8-2.8v3.8c-2.2 1.6-5.1 2.4-8.8 2.4-3.5 0-6.3-1.1-8.4-3.4-2-2.3-3-5.5-3-9.7 0-3.9 1.1-7.1 3.3-9.6 2.2-2.5 5-3.7 8.3-3.7 3.3 0 5.8 1.1 7.6 3.2 1.8 2.1 2.7 5.1 2.7 8.9v2.1zM41.4 59.2c-10.1 0-14.7-5.1-14.7-8.9 0-1.9 1.5-3.3 3.5-3.3 4.3 0 3.2 6.5 11.3 6.5 4.1 0 6.5-2.5 6.5-4.8 0-1.4-.8-3-3.5-3.6l-9-2.3C28.3 41 27 36.9 27 33.2c0-7.7 7.1-10.5 13.8-10.5 6.2 0 13.6 3.4 13.6 8.1 0 2-1.7 3.1-3.6 3.1-3.7 0-3.1-5.2-10.5-5.2-3.7 0-5.6 1.7-5.6 4.1 0 2.4 2.9 3.2 5.4 3.8l6.6 1.5c7.3 1.6 9.2 5.9 9.2 10 0 6.2-4.9 11.1-14.5 11.1m27.9-13.4c.3-1.6.4-3.3.4-5C69.7 25 57 12.2 41.3 12.2c-1.7 0-3.3.1-4.9.4-2.5-1.4-5.3-2.2-8.4-2.2-9.3 0-16.9 7.6-16.9 17 0 3.1.8 5.9 2.2 8.4-.3 1.6-.4 3.3-.4 5 0 15.8 12.7 28.6 28.4 28.6 1.7 0 3.3-.1 4.9-.4 2.5 1.4 5.3 2.2 8.4 2.2 9.3 0 16.9-7.6 16.9-17 0-3-.8-5.9-2.2-8.4"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="icon logo" viewBox="0 0 200 200">\r\n    <path d="M1933 623 Q1933 519 1892.5 426.5 Q1852 334 1783 265 Q1714 196 1621.5 155.5 Q1529 115 1425 115 Q1360 115 1298 131 Q1236 147 1179 179 Q1100 165 1024 165 Q906 165 796.5 196 Q687 227 591.5 283 Q496 339 417.5 417.5 Q339 496 283 591.5 Q227 687 196 796.5 Q165 906 165 1024 Q165 1100 179 1179 Q147 1236 131 1298 Q115 1360 115 1425 Q115 1529 155.5 1621.5 Q196 1714 265 1783 Q334 1852 426.5 1892.5 Q519 1933 623 1933 Q688 1933 750 1917 Q812 1901 869 1869 Q948 1883 1024 1883 Q1142 1883 1251.5 1852 Q1361 1821 1456.5 1765 Q1552 1709 1630.5 1630.5 Q1709 1552 1765 1456.5 Q1821 1361 1852 1251.5 Q1883 1142 1883 1024 Q1883 948 1869 869 Q1901 812 1917 750 Q1933 688 1933 623 Z M1462 807 Q1462 885 1434.5 938.5 Q1407 992 1362 1027 Q1317 1062 1259.5 1083 Q1202 1104 1141.5 1118 Q1081 1132 1023.5 1142.5 Q966 1153 921 1167.5 Q876 1182 848.5 1204.5 Q821 1227 821 1264 Q821 1298 837.5 1321.5 Q854 1345 879.5 1359.5 Q905 1374 935.5 1380.5 Q966 1387 994 1387 Q1044 1387 1080 1375.5 Q1116 1364 1143 1347 Q1170 1330 1190.5 1309.5 Q1211 1289 1229.5 1272 Q1248 1255 1266.5 1243.5 Q1285 1232 1309 1232 Q1329 1232 1349 1238.5 Q1369 1245 1384.5 1257 Q1400 1269 1409.5 1286.5 Q1419 1304 1419 1326 Q1419 1368 1398 1402 Q1377 1436 1342.5 1463 Q1308 1490 1264.5 1510 Q1221 1530 1175.5 1543 Q1130 1556 1086.5 1562.5 Q1043 1569 1010 1569 Q936 1569 861 1552 Q786 1535 725.5 1497 Q665 1459 627 1398.5 Q589 1338 589 1251 Q589 1175 616 1124 Q643 1073 687.5 1039 Q732 1005 789 985 Q846 965 905 950.5 Q964 936 1021 924.5 Q1078 913 1122.5 896.5 Q1167 880 1194 855 Q1221 830 1221 790 Q1221 754 1202 728 Q1183 702 1154.5 685.5 Q1126 669 1092 661 Q1058 653 1028 653 Q972 653 933 667 Q894 681 866 702 Q838 723 817.5 747 Q797 771 778 792 Q759 813 738 827 Q717 841 688 841 Q667 841 649 833.5 Q631 826 617 812.5 Q603 799 595 781 Q587 763 587 742 Q587 692 609 653 Q631 614 666.5 585 Q702 556 748.5 536 Q795 516 844 503.5 Q893 491 941 485.5 Q989 480 1028 480 Q1106 480 1183.5 497 Q1261 514 1323 552.5 Q1385 591 1423.5 653.5 Q1462 716 1462 807 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">\r\n    <path d="M2048 1087 L1087 1087 L1087 2048 L2048 2048 L2048 1087 Z M961 1087 L0 1087 L0 2048 L961 2048 L961 1087 Z M2048 0 L1087 0 L1087 961 L2048 961 L2048 0 Z M961 0 L0 0 L0 961 L961 961 L961 0 Z " transform="scale(0.1, -0.1) translate(0, -2000)"/>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="dock" viewBox="0 0 34 34">\r\n    <g fill="white" fill-rule="nonzero">\r\n        <path d="M24.8 9.2c-.1-.1-.3-.3-.5-.4-.2-.1-.4-.1-.7-.1H2c-.2 0-.5 0-.7.1-.1.1-.3.2-.5.4s-.3.3-.4.5c-.1.2-.1.4-.1.7V32c0 .5.2.9.5 1.2.3.3.7.5 1.2.5h21.6c.2 0 .5 0 .7-.1.2-.1.4-.2.5-.4.1-.2.3-.3.4-.5.1-.2.1-.4.1-.7V10.3c0-.2 0-.5-.1-.7-.1-.2-.2-.3-.4-.4zM22 13.7v16.7H3.7V12H22v1.7zM26.9.3h1.7V2h-1.7zM17 .3h1.7V2H17zM20.3.3H22V2h-1.7zM23.6.3h1.7V2h-1.7zM13.7 3.7h1.7v1.7h-1.7zM15.3 2V.3h-.2c-.4 0-.7.1-1 .4-.3.3-.4.6-.4 1V2h1.6zM32 2V.3h-1.7V2H32v1.7h1.7V2M32 5.3h1.7V7H32zM32 8.7h1.7v1.7H32zM32 12h1.7v1.6H32zM32 15.3h1.7V17H32zM28.7 18.7h1.7v1.7h-1.7zM32 18.7v1.7h.2c.4 0 .7-.1 1-.4.3-.3.4-.6.4-1v-.2H32v-.1z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="undock" viewBox="0 0 24 24">\r\n    <g fill="none" fill-rule="evenodd">\r\n        <path stroke="white" stroke-linecap="square" stroke-width="1" d="M5 5h14M5 19h14M19 5v14M5 5v14"/>\r\n        <path fill="white" stroke="white" stroke-linecap="square" stroke-width="1" d="M12 11h7v7h-7z"/>\r\n    </g>\r\n</svg>\r\n'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 91 83">\r\n\t<path fill-rule="evenodd" d="M17 52v13l11-11v8L11 79V58H0V1h80v23h-6V6H6v46h11zm17-23h57v40H80v15L64 69H34V29zm51 34V35H40v28h27l7 8v-8h11z"/>\r\n</svg>\r\n'},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=["bubble","tab"];t.isCollapsableButton=function(e){var t=!1;return o.forEach(function(n){e.classList.contains(n)&&(t=!0)}),t}},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(266),s=n(164),a=n(55),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.setDOMFrom=function(e,t){this.setBaseDOM(e,t),this.setDom(e,r.default,t,new s.ChatDefinition)},t.prototype.getDefinitionFromDOM=function(e){var t=new s.ChatDefinition;return this.parseBaseDom(t,e),this.parseDom(t,r.default,e),t},t.prototype.getStringValue=function(e,t,n){var o=e.getAttribute(t);return null===o?n:o},t.prototype.getValue=function(e,t,n){var o=e.getAttribute(t);return null===o?n:a.toBoolean(o)},t}(n(163).ConfigFactory);t.ChatConfigFactory=c},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.CanCollapse="data-can-collapse",t.CanClose="data-can-close",t.CanUploadFile="data-can-upload-file",t.FileExtensions="data-file-extensions",t.FileSize="data-file-size",t.FileTypes="data-file-typings",t.ShowHeader="data-show-header",t.ColorMain="data-color",t.CssUrl="data-css-url",t.Partner="data-partner",t.ColorMessage="data-color-message",t.Preload="data-preload",t.EntryAnim="data-entry-animation",t.IntroAnim="data-disable-animation",t.Frameless="data-frameless",t.GuestOnly="data-guest-only",t.EnableTranslator="data-enable-translator",t.WelcomeMessage="welcome-message",t.DisableLogout="data-disable-logout",t.EnableCustomOnCloseHandler="data-custom-onclose-handler",t.CallStartMode="data-call-start-mode",t.DisplayDeviceGuide="data-display-device-guide",t.GroupWith="data-group-with",t.HideSystemMessages="data-hide-system-messages",t.ParallelView="data-parallel-view",t.MessageContentLimit="data-message-content-limit",t.ChatMinWidth="data-chat-minwidth",t.HideMessageActionsMenu="data-hide-message-actions",t.DisableAvatarClickAction="data-disable-avatar-action",t}(n(142).Attributes);t.default=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(141),r=n(4),s=n(160),a=n(30),c=n(73),u=n(161),l=n(310),d=n(0),p=n(83),f=n(15),h=n(311),g=n(317),v=n(331),m=[Promise.resolve()];if(!d.swc.Telemetry){var y=new Promise(function(e){d.swc.scriptLoader.addScript("telemetry-bundle",!0,function(){var t=u.createTelemetryConfigFromEcs(d.swc.EcsConfig);d.swc.Telemetry.init(d.swc.EcsConfig.environment,t),e()})});m.push(y)}d.swc.EcsHeaderConfig||m.push(c.configLoader("SkypeWebControl",d.swc.EcsOptions).then(function(e){d.swc.EcsConfig=o({},e.SWC,d.swc.EcsConfig),d.swc.EcsHeaderConfig=e.Headers})),s.default.alias(d.swc.ChatContent,"swc.Chat"),s.default.alias(d.swc.RecentsControl,"swc.Recents"),d.swc.SDK=d.swc.SDK||{},d.swc.Eventing=d.swc.Eventing||i.default,d.swc.API={registerEvent:function(e,t){d.swc.Eventing.registerEvent(e,t)},unregisterEvent:function(e,t){d.swc.Eventing.unregisterEvent(e,t)},triggerEvent:function(e,t){d.swc.Eventing.triggerEvent(e,t)}},Promise.all(m).then(function(){d.swc.SDK.viewports=new l.HostViewportManager,d.swc.SDK.Buttons=d.swc.SDK.Buttons||new h.ButtonBootstrapper,d.swc.SDK.Recents=d.swc.SDK.Recents||new v.RecentsBootstrapper,d.swc.SDK.Chat=d.swc.SDK.Chat||new g.ChatBootstrapper,d.swc.isManualBoot||(d.swc.init().then(function(){return d.swc.initCallback&&d.swc.initCallback()}),d.swc.API.registerEvent(r.ServicesEvents.Ready,function(){d.swc.SDK.Buttons.init(),d.swc.SDK.Recents.init()}))}),d.swc.EcsConfig&&"bing"===d.swc.EcsConfig.partner||p.StyleLoader.addStyle(f.UrlHelper.getAbsoluteUrl(a.PackageName.STYLE_SDK,"css")),d.swc.destroy=function(){d.swc.Eventing&&d.swc.Eventing.dispose(),d.swc.SDK.Buttons&&d.swc.SDK.Buttons.dispose(),d.swc.SDK.Chat&&d.swc.SDK.Chat.dispose(),delete d.swc.SDK.Buttons,delete d.swc.SDK.Chat,delete d.swc.SDK.Recents,delete d.swc.SDK,delete d.swc.ChatContent,delete d.swc.RecentsControl,delete d.swc.Eventing,delete d.swc.SDKRunner}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=n(0),r=n(162),s=i.swc.EcsConfig.domain+"/v/"+i.swc.EcsConfig.version+"/viewport.html",a=function(){function e(e){var t=this;this.viewports=[],this.containers={},this.groupContainers={},this.diffObj=function(e,n){var o=Object.keys(e),i=Object.keys(n),r=[],s=t.diff(o,i,function(e){return r.push(e)}),a=t.diff(i,o);return r.forEach(function(t){e[t]!==n[t]&&a.push(t)}),{remove:s,add:a}},this.diff=function(e,t,n){return e.filter(function(e){return-1===t.indexOf(e)||(n&&n(e),!1)})},this.options=e||{},i.swc.Eventing.registerEvent(o.ViewportEvents.Add,function(e){return t.add(e.id,e.state,e.options)}),i.swc.Eventing.registerEvent(o.ViewportEvents.Update,function(e){return t.update(t.byId(e.id),e.state)})}return e.prototype.getContainer=function(e,t){return(e||t)&&(this.containers[e]||this.groupContainers[t])},e.prototype.byGroup=function(e,t){var n="string"==typeof e?[e]:e;return(t||this.viewports).filter(function(e){return 1!==n.indexOf(e.options.group)})},e.prototype.byType=function(e,t){var n="string"==typeof e?[e]:e;return(t||this.viewports).filter(function(e){return-1!==n.indexOf(e.options.type)})},e.prototype.byName=function(e,t){return(t||this.viewports).filter(function(t){return t.options.name===e})[0]},e.prototype.byId=function(e){return this.viewports.filter(function(t){return t.id===e})[0]},e.prototype.setContainer=function(e,t){if(e&&t){if(this.containers[e]===t)return;this.containers[e]=t}},e.prototype.setGroupContainer=function(e,t){if(e&&t){if(this.groupContainers[e]===t)return;this.groupContainers[e]=t}},e.prototype.add=function(e,t,n){var a=this;this.byId(e)&&Promise.resolve();var c=this.getContainer(n.name,n.group)||this.options.parent||document.body;return new Promise(function(u,l){i.swc.Eventing.registerEvent(o.ViewportEvents.Ready,function(e){e&&u(a.byId(e))});var d=r.default.inject(s+"#"+e,c);d.onload=function(){return d.contentWindow.postMessage(e,i.swc.EcsConfig.domain)},a.viewports.push(a.update({id:e,frame:d,state:{},options:n||{}},t));var p=a.byId(e);"conversation"===p.options.type&&p.state.classes.indexOf("lwc-chat-frame")>-1&&i.swc.SDK.Chat.setChatHostElement(p.frame)})},e.prototype.update=function(e,t){var n=e.frame,o=n.classList;if(e.state.classes?t.classes&&(o.remove.apply(o,this.diff(t.classes,e.state.classes)),o.add.apply(o,this.diff(t.classes,e.state.classes))):o.add.apply(o,t.classes),e.state.attrs){if(t.attrs){var i=this.diffObj(t.attrs,e.state.attrs);i.remove.forEach(function(e){n.removeAttribute(e)}),i.add.forEach(function(e){n.setAttribute(e,t.attrs[e])})}}else for(var r=0,s=Object.keys(t.attrs);r<s.length;r++){var a=s[r];n.setAttribute(a,t.attrs[a])}return e.state=t,e},e}();t.HostViewportManager=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=n(312),r=n(264),s=n(164),a=n(144),c=n(6),u=n(0),l=n(16),d=n(31),p="visible",f="hidden",h=function(){function e(){var e=this;this._buttons=[],this._initialized=!1,this._updateUnreadMessageCounter=function(t){for(var n=0;n<e._buttons.length;n++){var o=e._buttons[n]?e._buttons[n].element:"";if(o&&e._buttons[n].id===t.convId){var i=o.querySelector(".unreadMessageIndicator");if(i){var r=i.querySelector(".heading");if(!r)continue;if(t.count<1){i.style.visibility=f,r.innerText="";continue}r.innerText=e._getCountMaxNumber(t.count),i.style.visibility!==f&&""!==i.style.visibility||(i.style.visibility=p)}}}}}return e.prototype.refresh=function(e){this.dispose(),this._skypeButtonPlaceholders=document.querySelectorAll(".skype-button"),this._scanButtons(),this._showSkypeButtons()},e.prototype.init=function(){this._skypeButtonPlaceholders=document.querySelectorAll(".skype-button"),this._skypeButtonPlaceholders.length&&(this._pageSessionId=l.guid.generate(),this._scanButtons(),this._showSkypeButtons(),u.swc.Eventing.registerEvent(o.ApiEvents.UpdateUnreadMessageCounter,this._updateUnreadMessageCounter))},e.prototype._scanButtons=function(){for(var e=function(e){var n=t._skypeButtonPlaceholders[e];t.createSkypeButton(n,function(e,t){e._isHidden=!1;var o=e.ConversationId,i=d.default.detectConversationType(o);switch(r.isCollapsableButton(n)&&(n.firstElementChild.classList.remove("close-button"),n.firstElementChild.classList.add("open-button")),e.Preload){case a.PreloadType.UIONLY:t.showChat();break;case a.PreloadType.NONE:case a.PreloadType.FULL:default:t.startChat(e)}var s=i===c.ConversationType.AGENT?o:null;u.swc.Telemetry.sendEvent.buttonClick(s)})},t=this,n=0;n<this._skypeButtonPlaceholders.length;n++)e(n)},e.prototype.dispose=function(){this._buttons.forEach(function(e){return e.element.removeEventListener("click",e.callback)})},e.prototype._showSkypeButtons=function(){for(var e=0;e<this._skypeButtonPlaceholders.length;e++){this._skypeButtonPlaceholders[e].style.visibility=null}},e.prototype._getCountMaxNumber=function(e){return e<51?e.toString():"50+"},e.prototype.createSkypeButton=function(e,t){var n=(new i.ButtonConfigFactory).getDefinitionFromDOM(e),o=u.swc.SDK.Chat,r=o.getChatAttrs();r||(r=new s.ChatDefinition),r.MergeWith(n),n&&r&&n.MergeWith(r),r.Preload===a.PreloadType.UIONLY&&o.startChat(r),r.Preload===a.PreloadType.FULL&&(r._isHidden=!0,o.startChat(r));var c=function(){return t(r,o)};if(e.children.length>0||e.innerText&&e.innerText.length>0)e.addEventListener("click",c),this._buttons.push({element:e,callback:c,id:n.ConversationId});else{var l=document.createElement("a"),p=n.Text||"Contact us";l.className="lwc-chat-button",l.innerHTML=this.getTemplate(),l.querySelector(".lwc-button-text").innerText=p,l.addEventListener("click",c),n.Color&&(l.style.backgroundColor=n.Color),e.appendChild(l),this._buttons.push({element:l,callback:c,id:n.ConversationId})}this._initialized||this._showSkypeButtons(),this._initialized=!0;var f="agent"===d.default.detectConversationType(n.ConversationId)?n.ConversationId:null;u.swc.Telemetry.sendEvent.buttonRender(f,this._pageSessionId)},e.prototype.getTemplate=function(){return'\n            <span class="unreadMessageIndicator"><h3 class="heading"></h3></span>\n            <span class="lwc-button-icon">'+n(316)+'</span>\n            <span id="chatIconText" class="lwc-button-text"></span>\n        '},e}();t.ButtonBootstrapper=h},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(313),s=n(314),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.setDOMFrom=function(e,t){this.setBaseDOM(e,t),this.setDom(e,r.default,t,new s.ButtonDefinition)},t.prototype.getDefinitionFromDOM=function(e){var t=new s.ButtonDefinition;return this.parseBaseDom(t,e),this.parseDom(t,r.default,e),t},t}(n(163).ConfigFactory);t.ButtonConfigFactory=a},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.CallingOnly="data-calling-only",t.Text="data-text",t.Color="data-color",t}(n(142).Attributes);t.default=r},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Text="",t.Color="",t}return i(t,e),t}(n(143).Definition);t.ButtonDefinition=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.objectProperties=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t&&t(n)}},function(e,t){e.exports='<svg style="width:inherit" viewBox="0 0 38 35">\r\n    <path fill="#FFF" fill-rule="evenodd" d="M36.9 10.05c-1-4.27-4.45-7.6-8.8-8.4-2.95-.5-6-.78-9.1-.78-3.1 0-6.15.27-9.1.8-4.35.8-7.8 4.1-8.8 8.38-.4 1.5-.6 3.07-.6 4.7 0 1.62.2 3.2.6 4.7 1 4.26 4.45 7.58 8.8 8.37 2.95.53 6 .45 9.1.45v5.2c0 .77.62 1.4 1.4 1.4.3 0 .6-.12.82-.3l11.06-8.46c2.3-1.53 3.97-3.9 4.62-6.66.4-1.5.6-3.07.6-4.7 0-1.62-.2-3.2-.6-4.7zm-14.2 9.1H10.68c-.77 0-1.4-.63-1.4-1.4 0-.77.63-1.4 1.4-1.4H22.7c.76 0 1.4.63 1.4 1.4 0 .77-.63 1.4-1.4 1.4zm4.62-6.03H10.68c-.77 0-1.4-.62-1.4-1.38 0-.77.63-1.4 1.4-1.4h16.64c.77 0 1.4.63 1.4 1.4 0 .76-.63 1.38-1.4 1.38z"/>\r\n</svg>\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(141),i=n(4),r=n(5),s=n(2),a=n(265),c=n(264),u=n(17),l=n(266),d=n(164),p=n(36),f=n(12),h=n(30),g=n(144),v=n(318),m=n(165),y=n(319),_=n(320),S=n(321),w=n(166),C=n(28),E=n(322),b=n(323),T=n(6),P=n(116),O=n(60),A=n(174),I=n(119),k=n(0),M=n(324),N=n(78),x=n(37),D=n(327),R=n(328),U=n(162),F=n(16),L=n(31),j=n(49),B=n(179),G=n(27),H=n(329),K=n(145),W=n(15),z=n(105),V="swc:core:ready",Q="swc:ready",Y=3e4,q="services",J=function(){function e(){var e=this;this._currentConversationId={},this._fixedReferences={},this._hostElements={},this._chatConfigFactory=new a.ChatConfigFactory,this._startDate=Date.now(),this._isHidden=!0,this._isCollapsed=!1,this._botMessageId=0,this._conversationPromises={},this.frames={},this._firstChildOpenedTime=0,this._existingModels={},this._callingCreated=!1,this._messagingCreated=!1,this.isInitialized=!1,this.init=function(t,n){if(e._initPromise)return e._initPromise.promise;n&&(e._options=n,k.swc.SDK.locale=n.locale,e._globalLocale=G.LocaleInfo.instance.getLocale(),n.tokenType&&"aad"===n.tokenType&&(k.swc.SDK.authType=n.tokenType,k.swc.Telemetry&&k.swc.Telemetry.Context.SDK.setAuthType(k.swc.SDK.authType))),k.swc.module={create:e.createModule},k.swc.create=e.createModule,k.swc.setTheme=e.setTheme;var a=window.location.hostname.replace("www.","");e._frameless=e._isModule||!!a&&s.Configuration.ECS.frameless.indexOf(a)>-1&&!e._chatConfigFactory.getDefinitionFromUrl().ForceFrame,s.Configuration.ECS.notificationToastsSupport.indexOf(a)>-1&&(e._notifications=M.Notifications.instance),e._frameless||k.swc.Eventing.connect("core"),r.default.get.sessionId=F.guid.generate(),k.swc.Telemetry.Context.SDK.setSessionId(r.default.get.sessionId);Date.now();var c=n&&n.tokenProvider,l=e.doChatPolicyCheck(c).then(function(){return new Promise(function(r,a){if(k.swc.Eventing.registerEvent(i.ServicesEvents.Loaded,function(){var o=e._frameless?n||{}:D.clone(n||{});!e._frameless&&o&&(o.tokenProvider&&(o.tokenProvider=e._createAadTokenExchange(o.tokenProvider)),o.enterpriseAuth&&(o.enterpriseAuth={skypetokenProvider:e._createSkypeTokenExchange(o.enterpriseAuth.skypetokenProvider),regionGtmsProvider:e._createRegionGtmsExchange(o.enterpriseAuth.regionGtmsProvider)})),k.swc.Eventing.triggerEvent(i.ServicesEvents.Init,o),function(o){e._frameless&&(k.swc.subscribeToUserStatus=function(e,t){return k.swc.getPresence().then(function(n){return n.subscribeToUserStatus(e,t)})},k.swc.getUserStatus=function(e){return k.swc.getPresence().then(function(t){return t.getUserStatus(e)})},k.swc.subscribeToMyStatus=function(e){return k.swc.getPresence().then(function(t){return t.subscribeToMyStatus(e)})},k.swc.unsubscribeFromUserStatus=function(e,t){return k.swc.getPresence().then(function(n){return n.unsubscribeFromUserStatus(e,t)})},k.swc.getMyStatus=function(){return k.swc.getPresence().then(function(e){return e.getMyStatus()})},k.swc.setMyStatus=function(e){return k.swc.getPresence().then(function(t){return t.setMyStatus(e)})}),e._isModule=t;var r=e.buttonControlsExists();if(e.setupChatAttrs(),(!n||!n.preventAutorun)&&!r&&!t&&e._chatAttributes){var a=document.querySelector(s.Configuration.CHAT_MARKER_CLASS),c=a&&a.getAttribute("data-can-close");e._chatAttributes.CanClose=c&&"true"===c.toLowerCase(),e.initChat()}k.swc.Eventing.registerEvent(i.ApiEvents.recentsShown,e._onRecentsShow),k.swc.Eventing.registerEvent(i.ApiEvents.recentsHidden,e._onRecentsHide),k.swc.Eventing.registerEvent(i.ApiEvents.UnreadConversationsUpdate,e._onUnreadConversationChange),k.swc.Eventing.registerEvent(i.ApiEvents.StartChat,function(t){return e.startChat(t)}),window.addEventListener("focus",e._onFocus),window.addEventListener("blur",e._onBlur),e.isInitialized=!0,e.bridge(),e._fireGlobalEvent(Q),o()}(r)}),e._frameless)k.swc.scriptLoader.addScript(h.PackageName.SERVICES,!0);else{var c=x.getBranchParentFolder(k.swc.EcsConfig.version),u={ver:k.swc.EcsConfig.version,platform:k.swc.SDK.platformId,env:k.swc.EcsConfig.environment},l=k.swc.EcsConfig.domain+"/"+c+"/"+k.swc.EcsConfig.version+"/services.html";l=N.addGetParamsToUrl(l,u),l+="#"+encodeURI(location.host),e.frames[q]=U.default.inject(l);var d=e.frames[q].contentWindow;o.default.addTarget(q,q,s.Configuration.ECS.domain,d)}})});return e._initPromise=new u.CancelablePromise(l),e._initPromise.promise},this._onFocus=function(){return e._postMessage({origin:s.Configuration.ORIGIN,action:p.ActionNames.StartActivation})},this._onBlur=function(){return e._postMessage({origin:s.Configuration.ORIGIN,action:p.ActionNames.StopActivation})},this._onUnreadConversationChange=function(t){e._unreadCounterShown=!!t&&t>0},this._onRecentsShow=function(){e.sessionStartTelemetry(!0),e.inappActivityStartTelemetry(),k.swc.Telemetry.sendEvent.recentsVisibility(!0,e._unreadCounterShown),I.reportUserActivityStart()},this._onRecentsHide=function(){k.swc.Telemetry.sendEvent.recentsVisibility(!1,e._unreadCounterShown)},this.messageMasking=function(){return C.ProxyFactory.instance.async(y.MessageMaskingProxy,"messageMasking")},this.commands=function(){return C.ProxyFactory.instance.async(v.CommandsProxy,"commands")},this.threadNotifications=function(){return C.ProxyFactory.instance.async(b.ThreadNotificationsProxy,"threadNotifications")},this.messaging=function(){return C.ProxyFactory.instance.async(_.MessagingProxy,"messaging")},this.recents=function(){return C.ProxyFactory.instance.async(E.RecentsProxy,"recents")},this.presence=function(){return C.ProxyFactory.instance.async(w.PresenceProxy,"presence")},this.notificationSettings=function(){return C.ProxyFactory.instance.async(S.NotificationSettingsProxy,"notificationSettings")},this.setTheme=function(t){e._theme=t,k.swc.Eventing.triggerEvent(i.ApiEvents.bridge.theme.return,e._theme,!0)},this._dragStart=function(t,n){e.offsetX=t.x-e._hostElements[n].offsetLeft,e.offsetY=t.y-e._hostElements[n].offsetTop,e._draggedElement=e._hostElements[n]},this._drag=function(t){var n=e._draggedElement;n&&(n.style.left=t.x-e.offsetX+"px",n.style.top=t.y-e.offsetY+"px")},this.startChat=function(t,n,o){if(n=e._frameless&&n?n:null,t&&!t.MergeWith){var r=new d.ChatDefinition;r.MergeWith(t),t=r}t&&(e._chatAttributes=t);var a,c=L.default.detectConversationType(t.ConversationId),u=t.CallingOnly?z.ModuleType.Calling:z.ModuleType.Messaging,l=!!t.ConversationId&&t.ConversationId===e._currentConversationId[u]&&c!==T.ConversationType.PHONE,f=e._currentPrefill&&t.Prefill===e._currentPrefill,h=function(){e._postMessage({origin:s.Configuration.ORIGIN,action:p.ActionNames.ExpandChatWindow,isModule:e._isModule,element:n})},g=t.ConversationId||t.GroupWith;if(e._conversationPromises[g])a=e._conversationPromises[g];else{var v=F.guid.generate();a=C.ProxyFactory.instance.async(m.ConversationProxy,v,Y),t.RefId=v,g&&(e._conversationPromises[g]=a)}if(l&&!f)return e._currentPrefill=t.Prefill,e._postChatUpdate(t,n),e._isHidden&&e._show(u,n),e._isCollapsed&&(h(),k.swc.Eventing.triggerEvent(i.ApiEvents.onControlShow,{currentConversationId:e._currentConversationId[u]},!0)),a;var y=e._currentConversationId[u]&&!l;return e.moduleExists(u)&&!y&&e._currentConversationId[u]?(e._isHidden?e._show(u,n):e._hide(u),a):(e._isCollapsed&&h(),e._openConversation(t,y,n,o),a||void 0)},this.refreshDOM=function(t,n,o){if(Object.keys(e._fixedReferences).length)if(n){var i=e._fixedReferences[n];!i||!o&&j.isInDom(i)||t.appendChild(i)}else for(var r in e._fixedReferences)!o&&j.isInDom(e._fixedReferences[r])||t.appendChild(e._fixedReferences[r])},this.hideChat=function(){return e._hide(z.ModuleType.Messaging)},this.showChat=function(){e._postMessage({origin:s.Configuration.ORIGIN,action:p.ActionNames.LoadChatData,isModule:e._isModule}),e._show(z.ModuleType.Messaging)},this._dock=function(t,n){e._originalPosition=e._hostElements[n].getBoundingClientRect();var o={left:document.body.offsetWidth-t.width-20,top:20,width:t.width,height:t.height};j.setRectStyle(e._hostElements[n],o)},this._undock=function(t){return j.setRectStyle(e._hostElements[t],e._originalPosition)},this.createModule=function(t,n,o){var s=new d.ChatDefinition(e._chatConfigFactory.getDefinitionFromUrl());e._globalLocale&&(n.Locale=e._globalLocale),s.MergeWithJSON(n),e._chatAttributes=s;var a,c=e._fillPostMessageData(s,o);switch(n&&n.ConversationId&&(e._currentConversationId[t]=n.ConversationId),t){case z.ModuleType.Calling:e.createChatControl(c,o,t),r.default.get.selectedDevices=n&&n.SelectedDevices,a=new Promise(function(t,n){var o=function(e){e?t(k.swc.Calling):n()},r=k.swc.Calling;r&&r.initialized?o(!0):k.swc.Eventing.registerEvent(i.ApiEvents.CallingReady,function(t){!e._frameless&&e._chatAttributes.CallingOnly&&t&&(k.swc.CallingControl.threadId=t.threadId),o(!!t)})});break;case z.ModuleType.Recents:var u=k.swc.SDK.Recents;u.init(n,o),a=new Promise(function(e,t){var n=function(){e(k.swc.RecentsContent)};u&&u.initialized?n():k.swc.Eventing.registerEvent(i.ApiEvents.RecentsReady,n)});break;case z.ModuleType.Messaging:default:e.createChatControl(c,o,t),a=new Promise(function(e,t){var n=k.swc.ChatContent;n&&n.isInitialized?e(n):k.swc.Eventing.registerEvent(i.MessagingEvents.Ready,function(){return e(k.swc.ChatContent)})})}return a},this._fillPostMessageData=function(t,n){var o=n||document.querySelector(".skype-chat"),i=e._options&&e._options.tokenType?e._options.tokenType:P.TokenType.Skype,a={id:t.ConversationId,messagingBackend:i===P.TokenType.Aad?f.MessagingBackend.TEAMS:null,ecs:null,chatConfig:t};return o&&(a.token=o.getAttribute(l.default.TOKEN)),e._options&&e._options.fileSharing&&(a.fileSharing=e._options.fileSharing),e._options&&e._options.userSettings&&(a.userSettings=e._options.userSettings),a.chatConfig.EnableCalling=k.swc.EcsConfig.enableCalling&&null!==a.chatConfig.EnableCalling?a.chatConfig.EnableCalling:k.swc.EcsConfig.enableCalling,a.chatConfig.SessionId=r.default.get.sessionId,a.chatConfig.Protocol=e.getProtocol(),a.ecs=s.Configuration.ECS,a},this._openConversation=function(t,n,o,i){e._currentPrefill=t.Prefill;var r=e._fillPostMessageData(t,i);r.switchConversation=n;var s=r.chatConfig.CallingOnly?z.ModuleType.Calling:z.ModuleType.Messaging;e._currentConversationId[s]=t.ConversationId,e.moduleExists(s)?e._postLoadConverstionEvent(r,o):e._initAndPostConversationEvent(r,o,i)},this._hide=function(t,n){if(Object.keys(e._hostElements).length){var o=e._hostElements[t];e._chatAttributes.DisableInOutAnimation?o.style.display="none":(o.classList.remove("open-chat"),o.classList.add("close-chat")),e._showSkypeButton(),k.swc.Eventing.triggerEvent(i.ApiEvents.onControlHide,{currentConversationId:n||e._currentConversationId[t]},!0),e._isHidden=!0}},this._collapse=function(t){e._hostElements[t]&&(e._hostElements[t].classList.add("collapsed"),e._isCollapsed=!0)},this._expand=function(t){e._hostElements[t]&&(e._hostElements[t].classList.remove("collapsed"),e._isCollapsed=!1)},this._show=function(t,n){var o=e._hostElements[t];o&&!e._chatAttributes._isHidden&&(e._moveToForeground(t),e._chatAttributes.DisableInOutAnimation?o.style.display="flex":(o.classList.remove("close-chat"),o.classList.add("open-chat"),o.style.display=""),e._postMessage({origin:s.Configuration.ORIGIN,action:p.ActionNames.OpenChatWindow,isModule:e._isModule,data:{chatConfig:e._chatAttributes},element:n}),k.swc.Eventing.triggerEvent(i.ApiEvents.onControlShow,{currentConversationId:e._currentConversationId[t]},!0),e._isHidden=!1,e.updateExistingModels())},this._initAndPostConversationEvent=function(t,n,o){var i=o||document.querySelector(s.Configuration.CHAT_MARKER_CLASS);i||((i=document.createElement("div")).setAttribute("class","skype-chat"),document.body.appendChild(i)),e._setAttributesFromDom(i),e.createChatControl(t,i,null,n)},this._postChatUpdate=function(t,n){var o={id:t.ConversationId,chatConfig:t,ecs:s.Configuration.ECS};e._postMessage({origin:s.Configuration.ORIGIN,action:p.ActionNames.UpdateConversation,sdkmode:null,id:o.id,data:o,host:k.swc.SDK.host,isModule:e._isModule,element:n})},this._postLoadConverstionEvent=function(t,n){var o=e._chatAttributes.Preload!==g.PreloadType.HIDDEN?p.ActionNames.ShowChatWindow:p.ActionNames.HideChatWindow,i={origin:s.Configuration.ORIGIN,action:o,id:t.id,data:t,host:k.swc.SDK.host,isModule:e._isModule,element:n};if(e._options&&e._options.tokenType&&(i.tokenType=e._options.tokenType),o===p.ActionNames.ShowChatWindow){e._options&&(e._options.tokenString?i.tokenString=e._options.tokenString:e._frameless&&e._options.tokenProvider&&(i.tokenProvider=e._options.tokenProvider),i.tokenType=e._options.tokenType,i.correlationId=e._options.correlationId);var r=W.UrlHelper.getHost();-1===r.indexOf("outlook.live.com")&&-1===r.indexOf("outlook-sdf.live.com")&&e.sessionStartTelemetry(),e.updateExistingModels()}e._postMessage(i)},this.mapPublic(),this.attachWinListeners(),this._fireGlobalEvent(V)}return e.prototype.doChatPolicyCheck=function(e){return"aad"===k.swc.SDK.authType&&e?e(O.AadAudience.SpacesApi).then(function(t){var n=(new K.TokenParser).getTokenData(t),o=new B.LocalCacheStorage(n.oid),i=new A.TeamsUserPolicyService(e,o);return Promise.all([i.getMessagingPolicy(),i.getUserPolicies(),i.getUpgradePolicy()]).then(function(e){var t=e[0],n=e[1],o=e[2],i=t.allowUserChat,r=o.mode.toLowerCase(),s="sfbonly"===r,a="teamsonly"===r||"islands"===r,c=n.teamsInteropPolicy,u=c&&c.chatDefaultClient;if(i&&!s&&(a||c&&("teams"===u||"default"===u)))return Promise.resolve();return Promise.reject({code:40301,message:"Chat disabled by user policy"})})}):Promise.resolve()},e.prototype.mapPublic=function(){k.swc.init=this.init,k.swc.getMessaging=this.messaging,k.swc.getRecents=this.recents,k.swc.getMessageMasking=this.messageMasking,k.swc.getInputCommands=this.commands,k.swc.getThreadNotifications=this.threadNotifications,k.swc.getPresence=this.presence,k.swc.getNotificationSettings=this.notificationSettings},e.prototype.attachWinListeners=function(){var e=this;window.addEventListener("swc:init:invoke",function(t){e.init()}),window.addEventListener("swc:createModule:invoke",function(t){var n=t.detail;e.createModule(n.name,n.options,document.querySelector(n.placeholderQuery)).then(function(){e._fireGlobalEvent("swc:module:ready",{name:n.name})})}),window.addEventListener("swc:startChat:invoke",function(t){var n=t.detail;n.ConversationId&&e.startChat(n)})},e.prototype._createAadTokenExchange=function(e){return H.createBridgeHost("swc:auth:aadtokenprovider",e)},e.prototype._createSkypeTokenExchange=function(e){return H.createBridgeHost("swc:auth:skypetokenprovider",e)},e.prototype._createRegionGtmsExchange=function(e){return H.createBridgeHost("swc:auth:regiongtmsprovider",e)},e.prototype._fireGlobalEvent=function(e,t){var n=new CustomEvent(e,{detail:t||{}});window.dispatchEvent(n)},e.prototype.resolveMessage=function(e){if(Object.keys(this._hostElements).length){var t=e.origin===s.Configuration.ORIGIN_CALLING?z.ModuleType.Calling:z.ModuleType.Messaging,n=e.data?e.data.id:0;switch(e.action){case p.ActionNames.HideChatWindow:this._hide(t,n);break;case p.ActionNames.ShowChatWindow:this._show(t);break;case p.ActionNames.CollapseChatWindow:this._collapse(t);break;case p.ActionNames.ExpandChatWindow:this._expand(t);break;case p.ActionNames.DockIframe:this._dock(e,t);break;case p.ActionNames.UndockIframe:this._undock(t);break;case p.ActionNames.IframeDragStart:this._dragStart(e,t);break;case p.ActionNames.IframeDragStop:break;case p.ActionNames.IframeDragging:this._drag(e)}}},e.prototype.setupChatAttrs=function(){var e=document.querySelector(s.Configuration.CHAT_MARKER_CLASS);if(e){var t=this._chatConfigFactory.getDefinitionFromDOM(e),n=this._chatConfigFactory.getDefinitionFromUrl();n.MergeWith(t),this._chatConfigFactory.setDOMFrom(n,e),this._chatAttributes=new d.ChatDefinition(n),this._chatAttributes.SessionId=r.default.get.sessionId,this._chatAttributes.Protocol=this.getProtocol()}},e.prototype.initChat=function(){document.querySelector(s.Configuration.CHAT_MARKER_CLASS)&&this._chatAttributes.Preload!==g.PreloadType.NONE&&this._openConversation(this._chatAttributes)},e.prototype.moduleExists=function(e){return!(e!==z.ModuleType.Calling||!this._callingCreated)||!(e!==z.ModuleType.Messaging||!this._messagingCreated)},e.prototype.buttonControlsExists=function(){return!!document.querySelector(s.Configuration.BUTTON_MARKER_CLASS)},e.prototype.getChatAttrs=function(){var e=document.querySelector(s.Configuration.CHAT_MARKER_CLASS);return e?this._chatConfigFactory.getDefinitionFromDOM(e):new d.ChatDefinition},e.prototype.dispose=function(){if(window.removeEventListener("focus",this._onFocus),window.removeEventListener("blur",this._onBlur),k.swc.ChatContent&&k.swc.ChatContent.dispose(),Object.keys(this._hostElements).length)for(var e in this._hostElements){var t=this._hostElements[e].parentElement;t&&t.removeChild(this._hostElements[e])}this._initPromise&&(this._initPromise.status===u.PromiseStatus.Pending&&this._initPromise.cancel(),this._initPromise=null)},e.prototype._getChatDefinition=function(e){var t=this._chatConfigFactory.getDefinitionFromDOM(e),n=this._chatConfigFactory.getDefinitionFromUrl();return t.MergeWith(n),t},e.prototype._setupFrameless=function(e,t,n){var o,r=this,s=!!this._chatAttributes.IsVirtual;e&&!s||(o=document.createElement("div"),s=!0);var a=this._chatAttributes.CallingOnly?z.ModuleType.Calling:z.ModuleType.Messaging;this._hostElements[a]=U.default.injectFrameless(o||e,a),this._fixedReferences[a]=this._hostElements[a],k.swc.Eventing.triggerEvent("createModule",{module:a,options:t});var c=n||this._hostElements[a];t.placeholder=e;var u=a===z.ModuleType.Messaging?i.MessagingEvents.Ready:"calling:wrapper:ready";k.swc.Eventing.registerEvent(u,function(){return r._postLoadConverstionEvent(t,c)})},e.prototype._setupFrame=function(e,t,n){var o=this;t=D.clone(t),n===z.ModuleType.Messaging&&k.swc.Eventing.registerEvent(i.MessagingEvents.Ready,function(){return o._postLoadConverstionEvent(t)}),k.swc.SDK.viewports.setGroupContainer("messaging",e),k.swc.Eventing.triggerEvent("createModule",{module:n,options:t});var r=this._chatAttributes.CallingOnly?z.ModuleType.Calling:z.ModuleType.Messaging;this._fixedReferences[r]=e},e.prototype.setChatHostElement=function(e){this._hostElements[z.ModuleType.Messaging]=e},e.prototype._setAttributesFromDom=function(e){var t=this._getChatDefinition(e);this._chatAttributes||(this._chatConfigFactory.setDOMFrom(t,e),this._chatAttributes=t)},e.prototype.createChatControl=function(e,t,n,o){var r=this;if(n=n||(this._chatAttributes.CallingOnly?z.ModuleType.Calling:z.ModuleType.Messaging),!this.moduleExists(n)&&(this._frameless?(this._setupFrameless(t,e,o),this._hostElements[n].classList.add("lwc-chat-frame",n)):this._setupFrame(t,e,n),this._chatAttributes.CallingOnly?this._callingCreated=!0:this._messagingCreated=!0,this._chatAttributes.Preload===g.PreloadType.FULL&&this.startChat(),!this._frameless)){var s=k.swc,a=void 0,c=void 0;switch(n){case z.ModuleType.Messaging:a={sendMessageToBot:function(e,t){var n=r._botMessageId++,o={botId:t,content:e,botMessageId:n},s=new Promise(function(e,t){var o=function(r){n===r.botMessageId&&(k.swc.Eventing.unregisterEvent(i.ApiEvents.invoke.sendMessageToBotResponse,o),r.success?e():t())};k.swc.Eventing.registerEvent(i.ApiEvents.invoke.sendMessageToBotResponse,o)});return k.swc.Eventing.triggerEvent(i.ApiEvents.invoke.sendMessageToBot,o),s},signOut:function(){k.swc.Eventing.triggerEvent(i.ApiEvents.invoke.signOut)},setAad:function(e){k.swc.Eventing.triggerEvent(i.ApiEvents.invoke.setAad,{aad:e},!0)},getTokenExpirationTime:function(e){k.swc.Eventing.triggerEvent(i.ApiEvents.invoke.getTokenExpirationTime)}},c="ChatContent";break;case z.ModuleType.Calling:a={startCall:function(e,t,n,o){k.swc.Eventing.triggerEvent(i.ApiEvents.invoke.startCall,{id:e,withVideo:t,callParams:n,isGroup:o})},stopCall:function(){return k.swc.Eventing.triggerEvent(i.ApiEvents.invoke.stopCall)}},c="Calling"}if(c&&(R.default.execute(s,c,a,this),"ChatContent"===c))try{R.default.execute(s,"Chat",a,this)}catch(e){}}},e.prototype._showSkypeButton=function(){for(var e=document.querySelectorAll(".skype-button"),t=0;t<e.length;t++){var n=e[t];if(!c.isCollapsableButton(n))return;n.firstElementChild.classList.remove("open-button"),n.firstElementChild.classList.add("close-button")}},e.prototype._moveToForeground=function(e){for(var t in this._hostElements)this._hostElements[t].style.zIndex=t===e?"2147483647":"0"},e.prototype._postMessage=function(e){k.swc.Eventing.triggerEvent(i.ApiEvents.compatEvent,e)},e.prototype.bridge=function(){var e=this;k.swc.Eventing.registerEvent(i.ApiEvents.bridge.theme.request,function(){return k.swc.Eventing.triggerEvent(i.ApiEvents.bridge.theme.return,e._theme)})},e.prototype.sessionStartTelemetry=function(e){var t=this;if(!k.swc.Telemetry.sessionStartWasSent){var n,o=e?"recents":L.default.detectConversationType(this._chatAttributes.ConversationId);k.swc.Telemetry.sessionStartWasSent=!0,o===T.ConversationType.AGENT&&(n=this._chatAttributes.ConversationId),k.swc.Telemetry.sendEvent.sessionStart(e?"n/a":t._chatAttributes.Theme,Date.now()-this._startDate,e?"resents":t._chatAttributes.CallingOnly?"calling":"chat",n,o)}},e.prototype.inappActivityStartTelemetry=function(){k.swc.Eventing.triggerEvent(i.ApiEvents.InappActivityStarted,"Opened",!0)},e.prototype.updateExistingModels=function(){var e=this._chatAttributes.CallingOnly?"calling-":"chat-";e+=this._chatAttributes.ConversationId,this._existingModels[e]||(this._existingModels[e]=!0)},e.prototype.getProtocol=function(){try{return window.location.protocol.toLowerCase()}catch(e){return"n/a"}},e}();t.ChatBootstrapper=J},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=function(e){function t(t){var n=e.call(this,t)||this;return n.commands={},n}return i(t,e),t.prototype.init=function(){var e=this;this.reg(r.ApiEvents.cmd.exec,function(t){return e.execute(t)})},t.prototype.register=function(e,t){var n=this.commands[e]=this.commands[e]||[];-1===n.indexOf(t)&&n.push(t),this.exec(r.ApiEvents.cmd.reg,e)},t.prototype.unregister=function(e,t){this.exec(r.ApiEvents.cmd.unreg);var n=this.commands[e];if(t){var o=n.indexOf(t);-1!==o&&n.splice(o,1)}t&&n.length||delete this.commands[e]},t.prototype.execute=function(e){var t=this.commands[e.command];if(t)for(var n=0,o=t;n<o.length;n++){var i=o[n];try{i(e)}catch(e){}}},t}(n(28).Proxy);t.CommandsProxy=s},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.init=function(){},t.prototype.registerMask=function(e){this.exec(r.ApiEvents.invoke.registerMask,e)},t.prototype.unregisterMask=function(e){this.exec(r.ApiEvents.invoke.unregisterMask,e)},t}(n(28).Proxy);t.MessageMaskingProxy=s},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=n(28),a=r.ApiEvents.messagingProxy,c=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.init=function(){},t.prototype.disconnect=function(){var e=this;return this.disconnectPromise||(this.disconnectPromise=this.disconnectPromise||new Promise(function(t,n){e.reg(a.disconnected,function(e){e?t():n()})}),this.exec(a.disconnect)),this.disconnectPromise},t}(s.Proxy);t.MessagingProxy=c},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=n(28),a=r.ApiEvents.notificationsSettingsProxy,c=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.init=function(){},t.prototype.setOption=function(e){var t=this,n=this.createCID();return new Promise(function(o,i){t.reg(a.setOptionResponse,function(e){e&&e.pairId===n&&o(e)}),t.exec(a.setOption,{o:e,id:n})})},t.prototype.readOption=function(e){var t=this,n=this.createCID();return new Promise(function(o,i){t.reg(a.readOptionResponse,function(e){e.pairId===n&&o(e)}),t.exec(a.readOption,{name:e,id:n})})},t}(s.Proxy);t.NotificationSettingsProxy=c},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=n(0),a=n(28),c=r.ApiEvents.recentsProxy,u=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.init=function(){},t.prototype.setOptions=function(e){var t=this,n=new Promise(function(e,n){var o=function(t){s.swc.Eventing.unregisterEvent(c.options.resolve,o),null!==t?e(t):n()};t.reg(c.options.resolve,o)});return this.exec(c.options.request,e),n},t}(a.Proxy);t.RecentsProxy=u},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=function(e){function t(t){var n=e.call(this,t)||this;return n.registrations={},n}return i(t,e),t.prototype.init=function(){var e=this;this.reg(r.ApiEvents.threadNotificationsProxy.notify,function(t){return e.notify(t.botId,t.conversationId,t.message)})},t.prototype.register=function(e,t,n){var o=this.registrations[e];if(o||(o=this.registrations[e]={callbacks:[],conversations:{}}),n){var i=o.conversations;i[n]&&-1===i[n].indexOf(t)?i[n].push(t):i[n]=[t]}else-1===o.callbacks.indexOf(t)&&o.callbacks.push(t);this.exec(r.ApiEvents.threadNotificationsProxy.reg,{botId:e,conversationId:n})},t.prototype.unregister=function(e,t,n){var o=this.registrations[e];if(o){this.exec(r.ApiEvents.threadNotificationsProxy.unreg,{botId:e,conversationId:n});var i=function(e){if(t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}};n?t?i(o.conversations[n]):delete o.conversations[n]:t?i(o.callbacks):delete this.registrations[e]}},t.prototype.notify=function(e,t,n){var o=this.registrations[e],i=function(e){for(var o=0,i=e;o<i.length;o++){var r=i[o];try{r(n,t)}catch(e){}}};o&&(i(o.callbacks),t&&o.conversations[t]&&i(o.conversations[t]))},t}(n(28).Proxy);t.ThreadNotificationsProxy=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(1),r=n(325),s=function(){function e(){var e=i.createElement(r.NotificationList),t=document.createDocumentFragment();o.render(e,t),document.body.appendChild(t)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}();t.Notifications=s},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),s=n(1),a=n(4),c=n(2),u=n(104),l=n(0),d=n(96),p=n(326),f=[d.SupportedSounds.Notification,d.SupportedSounds.Ringing],h=function(e){function t(){var t=e.call(this)||this;return t._notifications=[],t._audioPlayer=new d.SoundPlayer(f),t._notifyBasedOnUserSettings=c.Configuration.ECS.notifyBasedOnUserSettings,t._add=function(e){var n=t._getSupportedSettingType(e.type),o=function(n){t._notifications.push(e),l.swc.Telemetry.sendEvent.notificationShown(e.type),t._refreshState(),n&&t._playSound(e)};n&&t._notifyBasedOnUserSettings?l.swc.services.notificationSettingsStore.get(n).then(t._notifyIfEnabled.bind(null,o)):o(!1)},t._remove=function(e){for(var n=0;n<t._notifications.length;n++){var o=t._notifications[n];if(o.id===e){t._notifications.splice(n,1),t._stopSound(o);break}}t._refreshState()},l.swc.Eventing.registerEvent(a.ApiEvents.ReceivedNotification,t._add),l.swc.Eventing.registerEvent(a.ApiEvents.HideNotification,function(e){return t._remove(e)}),t}return i(t,e),t.prototype.render=function(){var e=this,t=this._notifications.length?{}:{display:"none"};return s.createElement("div",{className:"swc-notifications",style:t},this._notifications.map(function(t){return s.createElement(p.NotificationComponent,{key:t.id,notification:t,onClose:e._remove})}))},t.prototype._notifyIfEnabled=function(e,t){var n=!1,o=!1;switch(t.value){case u.NotificationAllowedValue.All:n=!0,o=!0;break;case u.NotificationAllowedValue.Notification:n=!0;break;case u.NotificationAllowedValue.Off:n=!1}n&&e(o)},t.prototype._getSupportedSettingType=function(e){var t=null;switch(e){case"UnreadMessage":t=u.NotificationSettingType.NewMessage;break;case"Calling":t=u.NotificationSettingType.IncomingCall}return t},t.prototype._playSound=function(e){e.sound&&(e.loopSound?this._audioPlayer.play(e.sound):this._audioPlayer.playOnce(e.sound))},t.prototype._stopSound=function(e){e.sound&&this._audioPlayer.stop(e.sound)},t.prototype._refreshState=function(){this.setState({notificationIds:this._notifications.map(function(e){return e.id})})},t}(r.Component);t.NotificationList=h},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),s=n(1),a=n(0),c=n(26),u=n(8),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._textAccept=a.swc.services.i18n.fetch("accept"),t._textIgnore=a.swc.services.i18n.fetch("ignore"),t._textClose=a.swc.services.i18n.fetch("calling_participants_close"),t.handleAction=function(e,n){for(var o,i=0,r=t.props.notification.actions;i<r.length;i++){var s=r[i];if(s.type===e){o=s;break}}o.action&&o.action(),n&&n.stopPropagation(),t.close()},t}return i(t,e),t.prototype.componentDidMount=function(){var e=this;this.timer=setTimeout(function(){e.handleAction("Ignore")},3e4)},t.prototype.componentWillUnmount=function(){this.timer&&clearTimeout(this.timer)},t.prototype.render=function(){var e=this.props.notification,n=t._getClassName(e.type),o="Calling"===e.type;return s.createElement("div",{className:"notification "+n,onClick:r.linkEvent("Accept",this.handleAction)},s.createElement(c.SwcAvatar,{size:c.SwcAvatarSize.Medium,title:e.title,avatarUrl:e.avatarUrl}),s.createElement("div",{className:"content"},s.createElement("h2",null,e.title),s.createElement("p",null,e.description)),o&&s.createElement("div",{className:"actions"},s.createElement("button",{className:"action accept",title:this._textAccept,onClick:r.linkEvent("Accept",this.handleAction)},s.createElement(u.SwcIcon,{size:u.SwcIconSize.Medium,type:u.SwcIconType.CallStart})),s.createElement("button",{className:"action decline",title:this._textIgnore,onClick:r.linkEvent("Ignore",this.handleAction)},s.createElement(u.SwcIcon,{size:u.SwcIconSize.Medium,type:u.SwcIconType.CallEnd}))),s.createElement("button",{className:"close",title:this._textClose,onClick:r.linkEvent("Ignore",this.handleAction)},s.createElement(u.SwcIcon,{size:u.SwcIconSize.Medium,type:u.SwcIconType.Cancel})))},t._getClassName=function(e){var t="";switch(e){case"Calling":t="calling";break;case"Reminder":t="reminder";break;case"Summary":t="summary";break;case"UnreadMessage":t="message"}return t},t.prototype.close=function(){this.props.onClose(this.props.notification.id)},t}(r.Component);t.NotificationComponent=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clone=function e(t){var n=t&&"object"==typeof t&&Object.keys(t);if(Array.isArray(t))return t.slice();if(n&&n.length){var o={};return n.forEach(function(n){return o[n]=e(t[n])}),o}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=function(){function e(e){this.fn=e}return e.prototype.fulfill=function(e){this.fn(e)},e}(),r=function(){function e(e,t,n){this.ns=e,this.name=t,this.method=n,this.defer=this.defer.bind(this)}return e.prototype.defer=function(){var e,t,n=new Promise(function(n,o){e=new i(n),t=new i(o)});return s.calls[this.ns][this.name].push({method:this.method,args:arguments,resolve:e,reject:t}),n},e}(),s=function(){function e(){}return e.execute=function(t,n,o,i){if(t&&t[n]&&t[n].deferred){var r=e.calls[t][n];t[n]=o;var s=Object.keys(o);r.forEach(function(e){if(s.indexOf(e.method)>-1){var o=t[n][e.method].apply(i,e.args);o instanceof Promise?o.then(function(t){return e.resolve.fulfill(t)},function(t){return e.reject.fulfill(t)}):e.resolve.fulfill()}}),delete e.calls[t][n]}},e.deferApi=function(t,n,o){t&&!t[n]&&(t[n]={deferred:!0},o.forEach(function(e){t[n][e]=new r(t,n,e).defer}),e.calls[t]=e.calls[t]||{},e.calls[t][n]=[])},e.calls={},e}();t.default=o.swc.deferrer=o.swc.deferrer||s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(330);t.createBridgeHost=function(e,t){return o.swc.Eventing.registerEvent(e+":request",function(n){var i=function(t){var i={requestId:n.requestId,value:t};o.swc.Eventing.triggerEvent(e+":response",i)},r=t.apply(null,n.args);r.then?r.then(i):i(r)}),i.createCommandString(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCommandString=function(e){return"command_createBridgeClient##"+e}},function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n(332);var i=n(4),r=n(2),s=n(36),a=n(0),c=n(265),u=n(333),l=n(336),d=n(162),p=n(49),f=n(105),h="recentList",g=function(){function e(){var e=this;this._hostElements={},this._fixedReferences={},this.initialized=!1,this._loadingScreen=new l.SkypeLoadingScreen,this._postLoadConversationEvent=function(t){var n=s.ActionNames.OpenRecentsWindow,c={origin:r.Configuration.ORIGIN,action:n,data:t,host:a.swc.SDK.host,tokenProvider:t.tokenProvider,tokenType:t.tokenType};a.swc.Eventing.triggerEvent(i.ApiEvents.compatEvent,o({},c,t.recentsConfig)),e.initialized=!0},this.refreshDOM=function(t,n,o){var i=a.swc.SDK.viewports.byName(h),r=i?i.frame:e._fixedReferences[h];r&&(!o&&p.isInDom(r)||t.appendChild(r))}}return e.prototype.init=function(e,t){var n=this,o=new u.RecentsConfigFactory,s=window.location.hostname.replace("www.","");if(this._frameless=!(new c.ChatConfigFactory).getDefinitionFromUrl().ForceFrame&&!!s&&r.Configuration.ECS.frameless.indexOf(s)>-1,this._skypeRecents=t||document.querySelector(r.Configuration.RECENTS_MARKER_CLASS),this._skypeRecents&&!this._skypeRecents.querySelector("#main-recentlist")){var l=o.getDefinitionFromUrl();Object.assign(l,e);var d=o.getDefinitionFromDOM(this._skypeRecents);d.MergeWith(l),this.setup(this._skypeRecents,{recentsConfig:d}),a.swc.Eventing.registerEvent(i.ApiEvents.recentsUIReady,function(){return n._loadingScreen.destroy()}),this._loadingScreen.init(this._skypeRecents)}},e.prototype.setup=function(e,t){var n=this;this._frameless?(this._hostElements[h]=d.default.injectFrameless(e,h),this._fixedReferences[h]=this._hostElements[h]):(this._hostElements[h]=e,a.swc.SDK.viewports.setContainer("recentList",e)),a.swc.Eventing.registerEvent(i.ApiEvents.RecentsReady,function(){return n._postLoadConversationEvent(t)}),a.swc.Eventing.triggerEvent("createModule",{module:f.ModuleType.Recents,options:t})},e}();t.RecentsBootstrapper=g},function(e,t){"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError;e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e})},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(334),s=n(335),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.setDOMFrom=function(e,t){this.setBaseDOM(e,t),this.setDom(e,r.default,t,new s.RecentsDefinition)},t.prototype.getDefinitionFromDOM=function(e){var t=new s.RecentsDefinition;return this.parseBaseDom(t,e),this.parseDom(t,r.default,e),t},t}(n(163).ConfigFactory);t.RecentsConfigFactory=a},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.HideUnreadCounter="data-hide-unread-counter",t.ShowTypingIndicator="data-show-typing-indicator",t.HideAvatar="data-hide-avatar",t.VisibleItemsNumber="data-visible-items-number",t.HideStatus="data-hide-status",t.PreventOpenChat="data-prevent-open-chat",t}(n(142).Attributes);t.default=r},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.HideUnreadCounter=!1,t.ShowTypingIndicator=!1,t.HideAvatar=!1,t.VisibleItemsNumber=-1,t.HideStatus=!1,t.PreventOpenChat=!1,t}return i(t,e),t}(n(143).Definition);t.RecentsDefinition=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=n(5),r=n(180),s=n(0),a=function(){function e(){}return e.prototype.destroy=function(){if(this.container){this.container.style.display="none",s.swc.Eventing.triggerEvent(o.ApiEvents.RecentDataLoaded,null,!0);var e=this.container.parentElement;e&&e.removeChild(this.container),this.container=null}},e.prototype.init=function(e){this.render(e)},e.prototype.render=function(e){if(e){var t=i.default.get.isTeams()?r.SVG.iconChats:r.SVG.iconSkype;t+='<div style="height: 20px; width: 100%; position: absolute; bottom: 20px; display: flex; justify-content: center; align-items: center; font-family: Segoe UI Semibold, Segoe UI; color: #FFF; letter-spacing: -.1; line-height: 17px; font-size: 16px;">'+r.SVG.iconLogoMicrosoft+"&nbsp;Microsoft</div>",this.container=document.createElement("div"),this.container.innerHTML=t,this.container.className="skypeLoadingScreen",this.container.setAttribute("style","position: absolute;top: 0; width: 100%;height: 100%; background: linear-gradient(to bottom, #00bcf2 0%,#0078d4 66%);");var n=this.container.querySelectorAll("svg"),o=n[0],s=n[1];o.setAttribute("style","width: 90px; height: 90px; fill: #FFF; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%)"),s.setAttribute("style","width: 17px; height: 17px; fill: #FFF; shape-rendering: crispEdges"),e.appendChild(this.container)}},e}();t.SkypeLoadingScreen=a}]);